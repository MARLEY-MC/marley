<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MARLEY (Model of Argon Reaction Low Energy Yields): marley::Reaction Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/SVG"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="marley_diagram.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MARLEY (Model of Argon Reaction Low Energy Yields)
   &#160;<span id="projectnumber">v1.2.0</span>
   </div>
   <div id="projectbrief">A Monte Carlo event generator for tens-of-MeV neutrino interactions</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>marley</b></li><li class="navelem"><a class="el" href="classmarley_1_1_reaction.html">Reaction</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classmarley_1_1_reaction-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">marley::Reaction Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>Abstract base class that represents a two-two scattering reaction.  
 <a href="classmarley_1_1_reaction.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_reaction_8hh_source.html">Reaction.hh</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for marley::Reaction:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classmarley_1_1_reaction.png" usemap="#marley::Reaction_map" alt=""/>
  <map id="marley::Reaction_map" name="marley::Reaction_map">
<area href="classmarley_1_1_electron_reaction.html" alt="marley::ElectronReaction" shape="rect" coords="0,56,152,80"/>
<area href="classmarley_1_1_nuclear_reaction.html" title="A neutrino-nucleus reaction." alt="marley::NuclearReaction" shape="rect" coords="162,56,314,80"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a6a9981b171ef4c1f5f6a652e6a6e3d94"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">ProcessType</a> { <a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94aded8794ce1a3d4e374a5f43a50a88efe">NeutrinoCC</a> = 0
, <a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94a4cec48f7731945e5a319518aa470e5e3">AntiNeutrinoCC</a> = 1
, <a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94a93614be018f3848c2850745e8b71c4af">NC</a> = 2
, <a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94a646f6d0c38bb6e87b389701977beb7b8">NuElectronElastic</a> = 3
 }</td></tr>
<tr class="memdesc:a6a9981b171ef4c1f5f6a652e6a6e3d94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumerated type describing the kind of scattering process represented by a <a class="el" href="classmarley_1_1_reaction.html" title="Abstract base class that represents a two-two scattering reaction.">Reaction</a>.  <a href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">More...</a><br /></td></tr>
<tr class="separator:a6a9981b171ef4c1f5f6a652e6a6e3d94"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4d4a94d2fe17ba7d5cae2eaa75007dbe"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmarley_1_1_target_atom.html">marley::TargetAtom</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a4d4a94d2fe17ba7d5cae2eaa75007dbe">atomic_target</a> () const =0</td></tr>
<tr class="memdesc:a4d4a94d2fe17ba7d5cae2eaa75007dbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the target atom involved in this reaction.  <a href="classmarley_1_1_reaction.html#a4d4a94d2fe17ba7d5cae2eaa75007dbe">More...</a><br /></td></tr>
<tr class="separator:a4d4a94d2fe17ba7d5cae2eaa75007dbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad15a7744bba9ec5f6f86da7bf73e6c10"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmarley_1_1_event.html">marley::Event</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#ad15a7744bba9ec5f6f86da7bf73e6c10">create_event</a> (int <a class="el" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>, double KEa, <a class="el" href="classmarley_1_1_generator.html">marley::Generator</a> &amp;gen) const =0</td></tr>
<tr class="memdesc:ad15a7744bba9ec5f6f86da7bf73e6c10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create an event object for this reaction.  <a href="classmarley_1_1_reaction.html#ad15a7744bba9ec5f6f86da7bf73e6c10">More...</a><br /></td></tr>
<tr class="separator:ad15a7744bba9ec5f6f86da7bf73e6c10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29f4b0dd86ea823a77158a5d51ca91a9"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a29f4b0dd86ea823a77158a5d51ca91a9">diff_xs</a> (int <a class="el" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>, double KEa, double cos_theta_c_cm) const =0</td></tr>
<tr class="memdesc:a29f4b0dd86ea823a77158a5d51ca91a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Differential cross section \(d\sigma/d\cos\theta_{c}^{\mathrm{CM}}\) (MeV<sup> -2</sup>)  <a href="classmarley_1_1_reaction.html#a29f4b0dd86ea823a77158a5d51ca91a9">More...</a><br /></td></tr>
<tr class="separator:a29f4b0dd86ea823a77158a5d51ca91a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1795795d1041070fe366ddda55863e1"><td class="memItemLeft" align="right" valign="top"><a id="aa1795795d1041070fe366ddda55863e1"></a>
const std::string &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#aa1795795d1041070fe366ddda55863e1">get_description</a> () const</td></tr>
<tr class="memdesc:aa1795795d1041070fe366ddda55863e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a string that contains the formula for this reaction. <br /></td></tr>
<tr class="separator:aa1795795d1041070fe366ddda55863e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1aec5433c9da5813edc46e0cf545c05"><td class="memItemLeft" align="right" valign="top"><a id="ad1aec5433c9da5813edc46e0cf545c05"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a> () const</td></tr>
<tr class="memdesc:ad1aec5433c9da5813edc46e0cf545c05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the projectile PDG code. <br /></td></tr>
<tr class="separator:ad1aec5433c9da5813edc46e0cf545c05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af17d5a00782f0401f101f1a8c99b499a"><td class="memItemLeft" align="right" valign="top"><a id="af17d5a00782f0401f101f1a8c99b499a"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#af17d5a00782f0401f101f1a8c99b499a">pdg_b</a> () const</td></tr>
<tr class="memdesc:af17d5a00782f0401f101f1a8c99b499a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the target PDG code. <br /></td></tr>
<tr class="separator:af17d5a00782f0401f101f1a8c99b499a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa431e6bf7ad1acf758fc0d779727a88"><td class="memItemLeft" align="right" valign="top"><a id="aaa431e6bf7ad1acf758fc0d779727a88"></a>
<a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">ProcessType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#aaa431e6bf7ad1acf758fc0d779727a88">process_type</a> () const</td></tr>
<tr class="memdesc:aaa431e6bf7ad1acf758fc0d779727a88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the process type for this reaction. <br /></td></tr>
<tr class="separator:aaa431e6bf7ad1acf758fc0d779727a88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad102b7e99e870adb2bbedaeea8f4b243"><td class="memItemLeft" align="right" valign="top"><a id="ad102b7e99e870adb2bbedaeea8f4b243"></a>
virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#ad102b7e99e870adb2bbedaeea8f4b243">threshold_kinetic_energy</a> () const =0</td></tr>
<tr class="memdesc:ad102b7e99e870adb2bbedaeea8f4b243"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the minimum lab-frame kinetic energy (MeV) of the projectile that allows this reaction to proceed via a transition to the residue's ground state. <br /></td></tr>
<tr class="separator:ad102b7e99e870adb2bbedaeea8f4b243"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cfd54925a6043deff06da8603c22207"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a0cfd54925a6043deff06da8603c22207">total_xs</a> (int <a class="el" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>, double KEa) const =0</td></tr>
<tr class="memdesc:a0cfd54925a6043deff06da8603c22207"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the reaction's total cross section (MeV<sup> -2</sup>)  <a href="classmarley_1_1_reaction.html#a0cfd54925a6043deff06da8603c22207">More...</a><br /></td></tr>
<tr class="separator:a0cfd54925a6043deff06da8603c22207"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a3bb982f699e86e68288c6a460387a6f0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a3bb982f699e86e68288c6a460387a6f0">get_ejectile_pdg</a> (int <a class="el" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>, <a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">ProcessType</a> proc_type)</td></tr>
<tr class="separator:a3bb982f699e86e68288c6a460387a6f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e570c8943d34d22f11cd5f676b6f317"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; std::unique_ptr&lt; <a class="el" href="classmarley_1_1_reaction.html">Reaction</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a6e570c8943d34d22f11cd5f676b6f317">load_from_file</a> (const std::string &amp;filename, <a class="el" href="classmarley_1_1_structure_database.html">marley::StructureDatabase</a> &amp;db)</td></tr>
<tr class="separator:a6e570c8943d34d22f11cd5f676b6f317"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b9cb9e0c0f3712e9cab0516940cec21"><td class="memItemLeft" align="right" valign="top"><a id="a5b9cb9e0c0f3712e9cab0516940cec21"></a>
static std::string&#160;</td><td class="memItemRight" valign="bottom"><b>proc_type_to_string</b> (const <a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">ProcessType</a> &amp;pt)</td></tr>
<tr class="separator:a5b9cb9e0c0f3712e9cab0516940cec21"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a1feb2f728da409bcaf63e623d45736bc"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmarley_1_1_event.html">marley::Event</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a1feb2f728da409bcaf63e623d45736bc">make_event_object</a> (double KEa, double pc_cm, double cos_theta_c_cm, double phi_c_cm, double Ec_cm, double Ed_cm, double E_level, int twoJ, const <a class="el" href="classmarley_1_1_parity.html">marley::Parity</a> &amp;P) const</td></tr>
<tr class="memdesc:a1feb2f728da409bcaf63e623d45736bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function that makes an event object.  <a href="classmarley_1_1_reaction.html#a1feb2f728da409bcaf63e623d45736bc">More...</a><br /></td></tr>
<tr class="separator:a1feb2f728da409bcaf63e623d45736bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50bce6655c58a4562ba371706f496995"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a50bce6655c58a4562ba371706f496995">two_two_scatter</a> (double KEa, double &amp;s, double &amp;Ec_cm, double &amp;pc_cm, double &amp;Ed_cm) const</td></tr>
<tr class="memdesc:a50bce6655c58a4562ba371706f496995"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function that handles CM frame kinematics for the reaction.  <a href="classmarley_1_1_reaction.html#a50bce6655c58a4562ba371706f496995">More...</a><br /></td></tr>
<tr class="separator:a50bce6655c58a4562ba371706f496995"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:a87bdda83e5218efd9dbf9312e66ce8fe"><td class="memItemLeft" align="right" valign="top">static const std::vector&lt; int &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a87bdda83e5218efd9dbf9312e66ce8fe">get_projectiles</a> (<a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">ProcessType</a> proc_type)</td></tr>
<tr class="separator:a87bdda83e5218efd9dbf9312e66ce8fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a97c71055252e92db26c160c6c1fd9c2c"><td class="memItemLeft" align="right" valign="top"><a id="a97c71055252e92db26c160c6c1fd9c2c"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a97c71055252e92db26c160c6c1fd9c2c">description_</a></td></tr>
<tr class="memdesc:a97c71055252e92db26c160c6c1fd9c2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">String that contains a formula describing the reaction. <br /></td></tr>
<tr class="separator:a97c71055252e92db26c160c6c1fd9c2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea3c67ae0b64f048b0e728900200f96c"><td class="memItemLeft" align="right" valign="top"><a id="aea3c67ae0b64f048b0e728900200f96c"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#aea3c67ae0b64f048b0e728900200f96c">ma_</a></td></tr>
<tr class="memdesc:aea3c67ae0b64f048b0e728900200f96c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Projectile mass (MeV) <br /></td></tr>
<tr class="separator:aea3c67ae0b64f048b0e728900200f96c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3c38e0a9e08525685a2ee8de212d17a"><td class="memItemLeft" align="right" valign="top"><a id="af3c38e0a9e08525685a2ee8de212d17a"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#af3c38e0a9e08525685a2ee8de212d17a">mb_</a></td></tr>
<tr class="memdesc:af3c38e0a9e08525685a2ee8de212d17a"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classmarley_1_1_target.html" title="Description of a macroscopic target for scattering reactions.">Target</a> mass (MeV) <br /></td></tr>
<tr class="separator:af3c38e0a9e08525685a2ee8de212d17a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a383a684d06e3ca1e791394b95a758fe4"><td class="memItemLeft" align="right" valign="top"><a id="a383a684d06e3ca1e791394b95a758fe4"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a></td></tr>
<tr class="memdesc:a383a684d06e3ca1e791394b95a758fe4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ejectile mass (MeV) <br /></td></tr>
<tr class="separator:a383a684d06e3ca1e791394b95a758fe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a253c917efbb94aefe65806d9343a81"><td class="memItemLeft" align="right" valign="top"><a id="a2a253c917efbb94aefe65806d9343a81"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a2a253c917efbb94aefe65806d9343a81">md_</a></td></tr>
<tr class="memdesc:a2a253c917efbb94aefe65806d9343a81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Residue mass (MeV) <br /></td></tr>
<tr class="separator:a2a253c917efbb94aefe65806d9343a81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a217a810b93dd6da809a91080973d19f0"><td class="memItemLeft" align="right" valign="top"><a id="a217a810b93dd6da809a91080973d19f0"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a217a810b93dd6da809a91080973d19f0">pdg_a_</a></td></tr>
<tr class="memdesc:a217a810b93dd6da809a91080973d19f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">PDG code for the projectile. <br /></td></tr>
<tr class="separator:a217a810b93dd6da809a91080973d19f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad51f858109e8e7735716448ad0911dd4"><td class="memItemLeft" align="right" valign="top"><a id="ad51f858109e8e7735716448ad0911dd4"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#ad51f858109e8e7735716448ad0911dd4">pdg_b_</a></td></tr>
<tr class="memdesc:ad51f858109e8e7735716448ad0911dd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">PDG code for the target. <br /></td></tr>
<tr class="separator:ad51f858109e8e7735716448ad0911dd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4c4e6a8c68c0927059b85d27643a3ed"><td class="memItemLeft" align="right" valign="top"><a id="aa4c4e6a8c68c0927059b85d27643a3ed"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#aa4c4e6a8c68c0927059b85d27643a3ed">pdg_c_</a></td></tr>
<tr class="memdesc:aa4c4e6a8c68c0927059b85d27643a3ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">PDG code for the ejectile. <br /></td></tr>
<tr class="separator:aa4c4e6a8c68c0927059b85d27643a3ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab47c4d8a6efbb9082f4c67c2f359b19f"><td class="memItemLeft" align="right" valign="top"><a id="ab47c4d8a6efbb9082f4c67c2f359b19f"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#ab47c4d8a6efbb9082f4c67c2f359b19f">pdg_d_</a></td></tr>
<tr class="memdesc:ab47c4d8a6efbb9082f4c67c2f359b19f"><td class="mdescLeft">&#160;</td><td class="mdescRight">PDG code for the residue. <br /></td></tr>
<tr class="separator:ab47c4d8a6efbb9082f4c67c2f359b19f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a8dc9e8b628960659b50fedc27c374a"><td class="memItemLeft" align="right" valign="top"><a id="a2a8dc9e8b628960659b50fedc27c374a"></a>
<a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">ProcessType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a2a8dc9e8b628960659b50fedc27c374a">process_type_</a></td></tr>
<tr class="memdesc:a2a8dc9e8b628960659b50fedc27c374a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type of scattering process (CC, NC) represented by this reaction. <br /></td></tr>
<tr class="separator:a2a8dc9e8b628960659b50fedc27c374a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Abstract base class that represents a two-two scattering reaction. </p>
<p>This class models a reaction of the form a + b &rarr; c + d. The projectile (particle a) is taken to have lab-frame kinetic energy KEa and to be traveling toward the target along the positive z direction. The target (particle b) is taken to be at rest in the lab frame. </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000039">Todo:</a></b></dt><dd>Add check that projectile kinetic energy KEa &gt;= 0. for all relevant member functions of <a class="el" href="classmarley_1_1_reaction.html" title="Abstract base class that represents a two-two scattering reaction.">Reaction</a> and <a class="el" href="classmarley_1_1_nuclear_reaction.html" title="A neutrino-nucleus reaction.">NuclearReaction</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="_reaction_8hh_source.html#l00038">38</a> of file <a class="el" href="_reaction_8hh_source.html">Reaction.hh</a>.</p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a6a9981b171ef4c1f5f6a652e6a6e3d94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a9981b171ef4c1f5f6a652e6a6e3d94">&#9670;&nbsp;</a></span>ProcessType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">marley::Reaction::ProcessType</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enumerated type describing the kind of scattering process represented by a <a class="el" href="classmarley_1_1_reaction.html" title="Abstract base class that represents a two-two scattering reaction.">Reaction</a>. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a6a9981b171ef4c1f5f6a652e6a6e3d94aded8794ce1a3d4e374a5f43a50a88efe"></a>NeutrinoCC&#160;</td><td class="fielddoc"><p>Nuclear matrix elements contain \( t_{-} \). </p>
</td></tr>
<tr><td class="fieldname"><a id="a6a9981b171ef4c1f5f6a652e6a6e3d94a4cec48f7731945e5a319518aa470e5e3"></a>AntiNeutrinoCC&#160;</td><td class="fielddoc"><p>Nuclear matrix elements contain \( t_{+} \). </p>
</td></tr>
<tr><td class="fieldname"><a id="a6a9981b171ef4c1f5f6a652e6a6e3d94a93614be018f3848c2850745e8b71c4af"></a>NC&#160;</td><td class="fielddoc"><p>Nuclear matrix elements contain \( t_{3} \). </p>
</td></tr>
<tr><td class="fieldname"><a id="a6a9981b171ef4c1f5f6a652e6a6e3d94a646f6d0c38bb6e87b389701977beb7b8"></a>NuElectronElastic&#160;</td><td class="fielddoc"><p>Neutrino-electron elastic scattering. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="_reaction_8hh_source.html#l00046">46</a> of file <a class="el" href="_reaction_8hh_source.html">Reaction.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                       {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <a class="code" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94aded8794ce1a3d4e374a5f43a50a88efe">NeutrinoCC</a> = 0,     </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94a4cec48f7731945e5a319518aa470e5e3">AntiNeutrinoCC</a> = 1, </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <a class="code" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94a93614be018f3848c2850745e8b71c4af">NC</a> = 2,             </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <a class="code" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94a646f6d0c38bb6e87b389701977beb7b8">NuElectronElastic</a> = 3 </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      };</div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_a6a9981b171ef4c1f5f6a652e6a6e3d94a4cec48f7731945e5a319518aa470e5e3"><div class="ttname"><a href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94a4cec48f7731945e5a319518aa470e5e3">marley::Reaction::AntiNeutrinoCC</a></div><div class="ttdeci">@ AntiNeutrinoCC</div><div class="ttdoc">Nuclear matrix elements contain .</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00048">Reaction.hh:48</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_a6a9981b171ef4c1f5f6a652e6a6e3d94a646f6d0c38bb6e87b389701977beb7b8"><div class="ttname"><a href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94a646f6d0c38bb6e87b389701977beb7b8">marley::Reaction::NuElectronElastic</a></div><div class="ttdeci">@ NuElectronElastic</div><div class="ttdoc">Neutrino-electron elastic scattering.</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00051">Reaction.hh:50</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_a6a9981b171ef4c1f5f6a652e6a6e3d94a93614be018f3848c2850745e8b71c4af"><div class="ttname"><a href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94a93614be018f3848c2850745e8b71c4af">marley::Reaction::NC</a></div><div class="ttdeci">@ NC</div><div class="ttdoc">Nuclear matrix elements contain .</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00049">Reaction.hh:49</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_a6a9981b171ef4c1f5f6a652e6a6e3d94aded8794ce1a3d4e374a5f43a50a88efe"><div class="ttname"><a href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94aded8794ce1a3d4e374a5f43a50a88efe">marley::Reaction::NeutrinoCC</a></div><div class="ttdeci">@ NeutrinoCC</div><div class="ttdoc">Nuclear matrix elements contain .</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00047">Reaction.hh:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a4d4a94d2fe17ba7d5cae2eaa75007dbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d4a94d2fe17ba7d5cae2eaa75007dbe">&#9670;&nbsp;</a></span>atomic_target()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classmarley_1_1_target_atom.html">marley::TargetAtom</a> marley::Reaction::atomic_target </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the target atom involved in this reaction. </p>
<p>For nuclear reactions, this is identical to the pdg_b_ member variable. For electron reactions, it is distinct (since particle b is the initial struck electron). </p>

<p>Implemented in <a class="el" href="classmarley_1_1_nuclear_reaction.html#ab330fbfd0e09e564953d6741d7ebc3ed">marley::NuclearReaction</a>, and <a class="el" href="classmarley_1_1_electron_reaction.html#aa97674063acba6be0b4d593212b1a2c3">marley::ElectronReaction</a>.</p>

</div>
</div>
<a id="ad15a7744bba9ec5f6f86da7bf73e6c10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad15a7744bba9ec5f6f86da7bf73e6c10">&#9670;&nbsp;</a></span>create_event()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classmarley_1_1_event.html">marley::Event</a> marley::Reaction::create_event </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pdg_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>KEa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmarley_1_1_generator.html">marley::Generator</a> &amp;&#160;</td>
          <td class="paramname"><em>gen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create an event object for this reaction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdg_a</td><td>PDG code for the incident projectile </td></tr>
    <tr><td class="paramname">KEa</td><td>Lab-frame kinetic energy of the projectile </td></tr>
    <tr><td class="paramname">gen</td><td>Reference to the <a class="el" href="classmarley_1_1_generator.html" title="The MARLEY Event generator.">Generator</a> to use for random sampling </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Functions that override <a class="el" href="classmarley_1_1_reaction.html#ad15a7744bba9ec5f6f86da7bf73e6c10" title="Create an event object for this reaction.">create_event()</a> should throw an <a class="el" href="classmarley_1_1_error.html" title="Base class for all exceptions thrown by MARLEY functions.">Error</a> if pdg_a != pdg_a_. </dd></dl>

<p>Implemented in <a class="el" href="classmarley_1_1_nuclear_reaction.html#a8ab5c74e0daf4bb7cb47428e2273002a">marley::NuclearReaction</a>, and <a class="el" href="classmarley_1_1_electron_reaction.html#a4676a6a98feaf7d728b2f0d5d97aa232">marley::ElectronReaction</a>.</p>

<p class="reference">Referenced by <a class="el" href="_generator_8cc_source.html#l00067">marley::Generator::create_event()</a>.</p>

</div>
</div>
<a id="a29f4b0dd86ea823a77158a5d51ca91a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29f4b0dd86ea823a77158a5d51ca91a9">&#9670;&nbsp;</a></span>diff_xs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double marley::Reaction::diff_xs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pdg_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>KEa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cos_theta_c_cm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Differential cross section \(d\sigma/d\cos\theta_{c}^{\mathrm{CM}}\) (MeV<sup> -2</sup>) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdg_a</td><td>PDG code for the projectile </td></tr>
    <tr><td class="paramname">KEa</td><td>Lab-frame kinetic energy (MeV) of the projectile </td></tr>
    <tr><td class="paramname">cos_theta_c_cm</td><td>CM frame scattering cosine of the ejectile </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Functions that override <a class="el" href="classmarley_1_1_reaction.html#a29f4b0dd86ea823a77158a5d51ca91a9" title="Differential cross section  (MeV -2)">diff_xs()</a> should always return zero if pdg_a != pdg_a_. </dd></dl>

<p>Implemented in <a class="el" href="classmarley_1_1_nuclear_reaction.html#a0ae90ef14de8e0f71928d1ec696d9dee">marley::NuclearReaction</a>, and <a class="el" href="classmarley_1_1_electron_reaction.html#a9f5494fc26a2381766c98b5996459802">marley::ElectronReaction</a>.</p>

</div>
</div>
<a id="a3bb982f699e86e68288c6a460387a6f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bb982f699e86e68288c6a460387a6f0">&#9670;&nbsp;</a></span>get_ejectile_pdg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int marley::Reaction::get_ejectile_pdg </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pdg_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">ProcessType</a>&#160;</td>
          <td class="paramname"><em>proc_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Function that returns the ejectile PDG code given the projectile PDG code and the ProcessType </p>

<p class="definition">Definition at line <a class="el" href="_reaction_8cc_source.html#l00258">258</a> of file <a class="el" href="_reaction_8cc_source.html">Reaction.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                                                                  {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordtype">int</span> pdg_c = 0;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="comment">// First, check that the projectile PDG code is valid for the</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="comment">// given process type</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; vec = proc_type_to_nu_pdg.at( proc_type );</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordflow">if</span> ( std::find(vec.cbegin(), vec.cend(), <a class="code" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>) != vec.end() ) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">if</span> ( proc_type == ProcType::NeutrinoCC ) pdg_c = <a class="code" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a> - 1;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( proc_type == ProcType::AntiNeutrinoCC ) pdg_c = <a class="code" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a> + 1;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( proc_type == ProcType::NC ) pdg_c = <a class="code" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( proc_type == ProcType::NuElectronElastic ) pdg_c = <a class="code" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">throw</span> <a class="code" href="classmarley_1_1_error.html">marley::Error</a>(<span class="stringliteral">&quot;Unrecognized ProcessType encountered in&quot;</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="stringliteral">&quot; marley::Reaction::get_ejectile_pdg()&quot;</span>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">throw</span> <a class="code" href="classmarley_1_1_error.html">marley::Error</a>(<span class="stringliteral">&quot;A projectile with PDG code &quot;</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    + std::to_string(<a class="code" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>) + <span class="stringliteral">&quot; cannot participate in reactions of type &quot;</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    + proc_type_to_string_map.at(proc_type));</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordflow">return</span> pdg_c;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div>
<div class="ttc" id="aclassmarley_1_1_error_html"><div class="ttname"><a href="classmarley_1_1_error.html">marley::Error</a></div><div class="ttdoc">Base class for all exceptions thrown by MARLEY functions.</div><div class="ttdef"><b>Definition:</b> <a href="_error_8hh_source.html#l00032">Error.hh:32</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_ad1aec5433c9da5813edc46e0cf545c05"><div class="ttname"><a href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">marley::Reaction::pdg_a</a></div><div class="ttdeci">int pdg_a() const</div><div class="ttdoc">Get the projectile PDG code.</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00090">Reaction.hh:90</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a87bdda83e5218efd9dbf9312e66ce8fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87bdda83e5218efd9dbf9312e66ce8fe">&#9670;&nbsp;</a></span>get_projectiles()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; int &gt; &amp; marley::Reaction::get_projectiles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">ProcessType</a>&#160;</td>
          <td class="paramname"><em>proc_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns a vector of PDG codes for projectiles that participate in a particular ProcessType </p>

<p class="definition">Definition at line <a class="el" href="_reaction_8cc_source.html#l00283">283</a> of file <a class="el" href="_reaction_8cc_source.html">Reaction.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                                                 {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordflow">return</span> proc_type_to_nu_pdg.at( pt );</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6e570c8943d34d22f11cd5f676b6f317"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e570c8943d34d22f11cd5f676b6f317">&#9670;&nbsp;</a></span>load_from_file()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::unique_ptr&lt; <a class="el" href="classmarley_1_1_reaction.html">marley::Reaction</a> &gt; &gt; marley::Reaction::load_from_file </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmarley_1_1_structure_database.html">marley::StructureDatabase</a> &amp;&#160;</td>
          <td class="paramname"><em>db</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Factory method called by <a class="el" href="classmarley_1_1_j_s_o_n_config.html">JSONConfig</a> to build <a class="el" href="classmarley_1_1_reaction.html" title="Abstract base class that represents a two-two scattering reaction.">Reaction</a> objects given a file with matrix element data </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000024">Todo:</a></b></dt><dd>Add error handling for parsing problems </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000025">Todo:</a></b></dt><dd>This can be done more cleanly via iss = std::istringstream( line ); However, GCC 4 does not include the move constructor for string streams. This was fixed for GCC 5. Change this line after MARLEY drops support for GCC &lt; 5. See <a href="https://stackoverflow.com/a/27152585">https://stackoverflow.com/a/27152585</a> and <a href="https://stackoverflow.com/q/7623650">https://stackoverflow.com/q/7623650</a> for more details. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000026">Todo:</a></b></dt><dd>Consider implementing a sorting procedure rather than strictly enforcing that energies must be given in ascending order. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_reaction_8cc_source.html#l00288">288</a> of file <a class="el" href="_reaction_8cc_source.html">Reaction.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;{</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="comment">// Create an empty vector to start</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  std::vector&lt; std::unique_ptr&lt;marley::Reaction&gt; &gt; loaded_reactions;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  std::regex rx_comment(<span class="stringliteral">&quot;#.*&quot;</span>); <span class="comment">// Matches comment lines</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">// Open the reaction data file for parsing</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  std::ifstream file_in( filename );</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="comment">// If the file doesn&#39;t exist or some other error</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="comment">// occurred, complain and give up.</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keywordflow">if</span> ( !file_in.good() ) {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classmarley_1_1_error.html">marley::Error</a>(<span class="stringliteral">&quot;Could not read from the file &quot;</span> + filename);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">// String to store the current line of the reaction data file during parsing</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  std::string line;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  line = marley_utils::get_next_line( file_in, rx_comment, <span class="keyword">false</span> );</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="comment">// Read in the ProcessType code and the target PDG code</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  std::istringstream iss( line );</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordtype">int</span> integer_proc_type;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  iss &gt;&gt; integer_proc_type;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keyword">auto</span> proc_type = <span class="keyword">static_cast&lt;</span><a class="code" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">ProcType</a><span class="keyword">&gt;</span>( integer_proc_type );</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">// For neutrino-electron elastic scattering, we won&#39;t have a table of</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="comment">// matrix elements. Instead, a table of atomic target PDG codes appears.</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">// Make Reaction objects for each atomic target for each of the possible</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="comment">// projectiles (every neutrino species) and return the result.</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordflow">if</span> ( proc_type == ProcessType::NuElectronElastic ) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="comment">// Loop over target atoms</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="keywordtype">int</span> target_pdg;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="keywordflow">while</span> ( iss &gt;&gt; target_pdg ) {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="comment">// Loop over neutrino species</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; <a class="code" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a> : <a class="code" href="classmarley_1_1_reaction.html#a87bdda83e5218efd9dbf9312e66ce8fe">get_projectiles</a>(proc_type) ) {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;          loaded_reactions.emplace_back(</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            std::make_unique&lt;marley::ElectronReaction&gt;(<a class="code" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>, target_pdg) );</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      line = marley_utils::get_next_line( file_in, rx_comment, <span class="keyword">false</span> );</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      iss.str( line );</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      iss.clear();</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    } <span class="keywordflow">while</span> ( !line.empty() );</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">return</span> loaded_reactions;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="comment">// For nuclear reaction modes, there is a single target nucleus PDG code</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="comment">// per file. After parsing it, we proceed to read in the matrix elements.</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classmarley_1_1_reaction.html#af17d5a00782f0401f101f1a8c99b499a">pdg_b</a>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  iss &gt;&gt; <a class="code" href="classmarley_1_1_reaction.html#af17d5a00782f0401f101f1a8c99b499a">pdg_b</a>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="comment">// Read in all of the level energy (MeV), squared matrix element (B(F) or</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="comment">// B(GT) strength), and matrix element type identifier (0 represents B(F), 1</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="comment">// represents B(GT)) triplets. Create a vector of MatrixElement objects based</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">// on this information. Use a shared pointer so that the vector can be</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="comment">// re-used by multiple Reaction objects, one for each neutrino species for</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="comment">// which the matrix elements are relevant. This avoids unnecessary</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="comment">// duplication of storage for the matrix elements.</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keyword">auto</span> matrix_elements = std::make_shared&lt;std::vector&lt;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <a class="code" href="classmarley_1_1_matrix_element.html">marley::MatrixElement</a>&gt; &gt;();</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">// Set the old energy entry to the lowest representable double</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="comment">// value. This guarantees that we always read in the first energy</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="comment">// value given in the reaction data file</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordtype">double</span> old_energy = std::numeric_limits&lt;double&gt;::lowest();</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordflow">while</span> (line = marley_utils::get_next_line(file_in, rx_comment, <span class="keyword">false</span>),</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    file_in.good())</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    iss.str(line);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    iss.clear();</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">// The order of the entries is important because later uses of the vector of</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">// matrix elements assume that they are sorted in order of ascending final</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">// level energy.</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordtype">double</span> energy, strength;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordtype">int</span> integer_me_type;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    iss &gt;&gt; energy &gt;&gt; strength &gt;&gt; integer_me_type;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">if</span> (old_energy &gt;= energy) <span class="keywordflow">throw</span> <a class="code" href="classmarley_1_1_error.html">marley::Error</a>(std::string(<span class="stringliteral">&quot;Invalid&quot;</span>)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      + <span class="stringliteral">&quot; reaction dataset. Level energies must be unique and must be&quot;</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      + <span class="stringliteral">&quot; given in ascending order.&quot;</span>);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">// @todo Right now, 0 corresponds to a Fermi transition, and 1 corresponds</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">// to a Gamow-Teller transition. As you add new matrix element types,</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">// consider changing the convention and its implementation.</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">// All of the level pointers owned by the matrix elements will initially be</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="comment">// set to nullptr. This may be changed later if discrete level data can be</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">// found for the residual nucleus.</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    matrix_elements-&gt;emplace_back(energy, strength,</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="keyword">static_cast&lt;</span><a class="code" href="classmarley_1_1_matrix_element.html#a68fecd6d0f0cc5bbcd45b565f149e231">ME_Type</a><span class="keyword">&gt;</span>(integer_me_type), <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    old_energy = energy;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="comment">// We now have all the information that we need. Build Reaction objects</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="comment">// for all neutrino species that can participate in the process described</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="comment">// by the matrix elements in the table. Use the ProcessType code to</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">// figure this out</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="comment">// First, figure out the PDG code for the final nucleus and its ionization</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="comment">// state (net atomic charge after the 2-&gt;2 scatter)</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordtype">int</span> Zi = marley_utils::get_particle_Z( <a class="code" href="classmarley_1_1_reaction.html#af17d5a00782f0401f101f1a8c99b499a">pdg_b</a> );</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordtype">int</span> A = marley_utils::get_particle_A( <a class="code" href="classmarley_1_1_reaction.html#af17d5a00782f0401f101f1a8c99b499a">pdg_b</a> );</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordtype">int</span> pdg_d, q_d;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="comment">// NC scattering leaves the target nucleus the same</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordflow">if</span> ( proc_type == ProcessType::NC ) {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    pdg_d = <a class="code" href="classmarley_1_1_reaction.html#af17d5a00782f0401f101f1a8c99b499a">pdg_b</a>;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    q_d = 0;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="comment">// Neutrino CC scattering raises Z by one</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( proc_type == ProcessType::NeutrinoCC ) {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">// Check that the neutron number of the target is positive</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordtype">int</span> Ni = A - Zi;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">if</span> ( Ni &lt;= 0 ) <span class="keywordflow">throw</span> <a class="code" href="classmarley_1_1_error.html">marley::Error</a>(<span class="stringliteral">&quot;A NeutrinoCC process requires&quot;</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="stringliteral">&quot; a target nucleus with N &gt; 0&quot;</span>);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordtype">int</span> Zf = Zi + 1;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    pdg_d = marley_utils::get_nucleus_pid(Zf, A);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">// Recoil ion has charge +1</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    q_d = 1;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="comment">// Antineutrino CC scattering lowers Z by one</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( proc_type == ProcessType::AntiNeutrinoCC ) {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">// Check that the neutron number of the target is positive</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">if</span> ( Zi &lt;= 0 ) <span class="keywordflow">throw</span> <a class="code" href="classmarley_1_1_error.html">marley::Error</a>(<span class="stringliteral">&quot;An AntiNeutrinoCC process requires&quot;</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <span class="stringliteral">&quot; a target nucleus with Z &gt; 0&quot;</span>);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordtype">int</span> Zf = Zi - 1;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    pdg_d = marley_utils::get_nucleus_pid(Zf, A);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">// Recoil ion has charge -1</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    q_d = -1;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">throw</span> <a class="code" href="classmarley_1_1_error.html">marley::Error</a>(<span class="stringliteral">&quot;Unrecognized ProcessType encountered in&quot;</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="stringliteral">&quot; marley::NuclearReaction::load_from_file()&quot;</span>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="comment">// Now that we know the PDG code for the final nucleus, look up discrete</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="comment">// level data for it. Set the level pointers for matrix elements representing</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="comment">// transitions to discrete nuclear levels</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  set_level_ptrs( *matrix_elements, <a class="code" href="classmarley_1_1_reaction.html#af17d5a00782f0401f101f1a8c99b499a">pdg_b</a>, pdg_d, db );</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="comment">// Now loop over the projectile PDG codes that can participate in the</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="comment">// scattering process of interest. For each one, decide what the ejectile</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="comment">// PDG code should be, then produce a corresponding Reaction object</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; <a class="code" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a> : <a class="code" href="classmarley_1_1_reaction.html#a87bdda83e5218efd9dbf9312e66ce8fe">get_projectiles</a>(proc_type) ) {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordtype">int</span> pdg_c = <a class="code" href="classmarley_1_1_reaction.html#a3bb982f699e86e68288c6a460387a6f0">get_ejectile_pdg</a>(<a class="code" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>, proc_type);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    loaded_reactions.emplace_back( std::make_unique&lt;marley::NuclearReaction&gt;(</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      proc_type, <a class="code" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>, <a class="code" href="classmarley_1_1_reaction.html#af17d5a00782f0401f101f1a8c99b499a">pdg_b</a>, pdg_c, pdg_d, q_d, matrix_elements) );</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="keywordflow">return</span> loaded_reactions;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;}</div>
<div class="ttc" id="aclassmarley_1_1_matrix_element_html"><div class="ttname"><a href="classmarley_1_1_matrix_element.html">marley::MatrixElement</a></div><div class="ttdoc">A reduced nuclear matrix element that represents a transition caused by a neutrino-nucleus reaction.</div><div class="ttdef"><b>Definition:</b> <a href="_matrix_element_8hh_source.html#l00025">MatrixElement.hh:25</a></div></div>
<div class="ttc" id="aclassmarley_1_1_matrix_element_html_a68fecd6d0f0cc5bbcd45b565f149e231"><div class="ttname"><a href="classmarley_1_1_matrix_element.html#a68fecd6d0f0cc5bbcd45b565f149e231">marley::MatrixElement::TransitionType</a></div><div class="ttdeci">TransitionType</div><div class="ttdoc">Enumerated type that represents the possible kinds of nuclear transitions recognized by MARLEY.</div><div class="ttdef"><b>Definition:</b> <a href="_matrix_element_8hh_source.html#l00031">MatrixElement.hh:31</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_a3bb982f699e86e68288c6a460387a6f0"><div class="ttname"><a href="classmarley_1_1_reaction.html#a3bb982f699e86e68288c6a460387a6f0">marley::Reaction::get_ejectile_pdg</a></div><div class="ttdeci">static int get_ejectile_pdg(int pdg_a, ProcessType proc_type)</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8cc_source.html#l00258">Reaction.cc:258</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_a6a9981b171ef4c1f5f6a652e6a6e3d94"><div class="ttname"><a href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">marley::Reaction::ProcessType</a></div><div class="ttdeci">ProcessType</div><div class="ttdoc">Enumerated type describing the kind of scattering process represented by a Reaction.</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00046">Reaction.hh:46</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_a87bdda83e5218efd9dbf9312e66ce8fe"><div class="ttname"><a href="classmarley_1_1_reaction.html#a87bdda83e5218efd9dbf9312e66ce8fe">marley::Reaction::get_projectiles</a></div><div class="ttdeci">static const std::vector&lt; int &gt; &amp; get_projectiles(ProcessType proc_type)</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8cc_source.html#l00283">Reaction.cc:283</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_af17d5a00782f0401f101f1a8c99b499a"><div class="ttname"><a href="classmarley_1_1_reaction.html#af17d5a00782f0401f101f1a8c99b499a">marley::Reaction::pdg_b</a></div><div class="ttdeci">int pdg_b() const</div><div class="ttdoc">Get the target PDG code.</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00093">Reaction.hh:93</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1feb2f728da409bcaf63e623d45736bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1feb2f728da409bcaf63e623d45736bc">&#9670;&nbsp;</a></span>make_event_object()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmarley_1_1_event.html">marley::Event</a> marley::Reaction::make_event_object </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>KEa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pc_cm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cos_theta_c_cm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi_c_cm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ec_cm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ed_cm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>E_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>twoJ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classmarley_1_1_parity.html">marley::Parity</a> &amp;&#160;</td>
          <td class="paramname"><em>P</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function that makes an event object. </p>
<p>This function should be called by <a class="el" href="classmarley_1_1_reaction.html#ad15a7744bba9ec5f6f86da7bf73e6c10" title="Create an event object for this reaction.">marley::Reaction::create_event()</a> after CM frame scattering angles have been sampled for the ejectile. For reactions where the residue may be left in an excited state, the excitation energy should be recorded by supplying it as the final argument. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">KEa</td><td>Lab-frame kinetic energy (MeV) of the projectile </td></tr>
    <tr><td class="paramname">pc_cm</td><td>Ejectile 3-momentum magnitude (MeV) in the CM frame </td></tr>
    <tr><td class="paramname">cos_theta_c_cm</td><td>Cosine of ejectile's CM frame polar angle </td></tr>
    <tr><td class="paramname">phi_c_cm</td><td>Ejectile's CM frame azimuthal angle (radians) </td></tr>
    <tr><td class="paramname">Ec_cm</td><td>Ejectile total energy (MeV) in the CM frame </td></tr>
    <tr><td class="paramname">Ed_cm</td><td>Residue total energy (MeV) in the CM frame </td></tr>
    <tr><td class="paramname">E_level</td><td>Residue excitation energy (MeV) </td></tr>
    <tr><td class="paramname">twoJ</td><td>Two times the residue spin </td></tr>
    <tr><td class="paramname">P</td><td>Intrinsic parity of the residue </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classmarley_1_1_nuclear_reaction.html#a4ef889614cd67fb298aea85ef631335e">marley::NuclearReaction</a>.</p>

<p class="definition">Definition at line <a class="el" href="_reaction_8cc_source.html#l00218">218</a> of file <a class="el" href="_reaction_8cc_source.html">Reaction.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;{</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordtype">double</span> sin_theta_c_cm = real_sqrt(1.</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    - std::pow(cos_theta_c_cm, 2));</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">// Determine the Cartesian components of the ejectile&#39;s CM frame momentum</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordtype">double</span> pc_cm_x = sin_theta_c_cm * std::cos(phi_c_cm) * pc_cm;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordtype">double</span> pc_cm_y = sin_theta_c_cm * std::sin(phi_c_cm) * pc_cm;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordtype">double</span> pc_cm_z = cos_theta_c_cm * pc_cm;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="comment">// Get the lab-frame total energy of the projectile</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordtype">double</span> Ea = KEa + <a class="code" href="classmarley_1_1_reaction.html#aea3c67ae0b64f048b0e728900200f96c">ma_</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">// Determine the magnitude of the lab-frame 3-momentum of the projectile</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordtype">double</span> pa = real_sqrt(KEa*(KEa + 2*<a class="code" href="classmarley_1_1_reaction.html#aea3c67ae0b64f048b0e728900200f96c">ma_</a>));</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">// Create particle objects representing the projectile and target in the lab</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">// frame</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="comment">// @todo Allow for projectile directions other than along the z-axis</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <a class="code" href="classmarley_1_1_particle.html">marley::Particle</a> projectile(<a class="code" href="classmarley_1_1_reaction.html#a217a810b93dd6da809a91080973d19f0">pdg_a_</a>, Ea, 0, 0, pa, <a class="code" href="classmarley_1_1_reaction.html#aea3c67ae0b64f048b0e728900200f96c">ma_</a>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <a class="code" href="classmarley_1_1_particle.html">marley::Particle</a> target(<a class="code" href="classmarley_1_1_reaction.html#ad51f858109e8e7735716448ad0911dd4">pdg_b_</a>, <a class="code" href="classmarley_1_1_reaction.html#af3c38e0a9e08525685a2ee8de212d17a">mb_</a>, 0, 0, 0, <a class="code" href="classmarley_1_1_reaction.html#af3c38e0a9e08525685a2ee8de212d17a">mb_</a>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="comment">// Create particle objects representing the ejectile and residue in the CM</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="comment">// frame.</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <a class="code" href="classmarley_1_1_particle.html">marley::Particle</a> ejectile(<a class="code" href="classmarley_1_1_reaction.html#aa4c4e6a8c68c0927059b85d27643a3ed">pdg_c_</a>, Ec_cm, pc_cm_x, pc_cm_y, pc_cm_z, <a class="code" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a>);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <a class="code" href="classmarley_1_1_particle.html">marley::Particle</a> residue(<a class="code" href="classmarley_1_1_reaction.html#ab47c4d8a6efbb9082f4c67c2f359b19f">pdg_d_</a>, Ed_cm, -pc_cm_x, -pc_cm_y, -pc_cm_z, <a class="code" href="classmarley_1_1_reaction.html#a2a253c917efbb94aefe65806d9343a81">md_</a>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="comment">// Boost the ejectile and residue into the lab frame.</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordtype">double</span> beta_z = pa / (Ea + <a class="code" href="classmarley_1_1_reaction.html#af3c38e0a9e08525685a2ee8de212d17a">mb_</a>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  marley_kinematics::lorentz_boost(0, 0, -beta_z, ejectile);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  marley_kinematics::lorentz_boost(0, 0, -beta_z, residue);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="comment">// Create the event object and load it with the appropriate information</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <a class="code" href="classmarley_1_1_event.html">marley::Event</a> event(projectile, target, ejectile, residue, E_level, twoJ, P);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">return</span> event;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;}</div>
<div class="ttc" id="aclassmarley_1_1_event_html"><div class="ttname"><a href="classmarley_1_1_event.html">marley::Event</a></div><div class="ttdoc">Container for ingoing and outgoing momentum 4-vectors from a reaction.</div><div class="ttdef"><b>Definition:</b> <a href="_event_8hh_source.html#l00066">Event.hh:66</a></div></div>
<div class="ttc" id="aclassmarley_1_1_particle_html"><div class="ttname"><a href="classmarley_1_1_particle.html">marley::Particle</a></div><div class="ttdoc">Momentum four-vector for a simulated particle.</div><div class="ttdef"><b>Definition:</b> <a href="_particle_8hh_source.html#l00032">Particle.hh:32</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_a217a810b93dd6da809a91080973d19f0"><div class="ttname"><a href="classmarley_1_1_reaction.html#a217a810b93dd6da809a91080973d19f0">marley::Reaction::pdg_a_</a></div><div class="ttdeci">int pdg_a_</div><div class="ttdoc">PDG code for the projectile.</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00118">Reaction.hh:118</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_a2a253c917efbb94aefe65806d9343a81"><div class="ttname"><a href="classmarley_1_1_reaction.html#a2a253c917efbb94aefe65806d9343a81">marley::Reaction::md_</a></div><div class="ttdeci">double md_</div><div class="ttdoc">Residue mass (MeV)</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00130">Reaction.hh:130</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_a383a684d06e3ca1e791394b95a758fe4"><div class="ttname"><a href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">marley::Reaction::mc_</a></div><div class="ttdeci">double mc_</div><div class="ttdoc">Ejectile mass (MeV)</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00125">Reaction.hh:125</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_aa4c4e6a8c68c0927059b85d27643a3ed"><div class="ttname"><a href="classmarley_1_1_reaction.html#aa4c4e6a8c68c0927059b85d27643a3ed">marley::Reaction::pdg_c_</a></div><div class="ttdeci">int pdg_c_</div><div class="ttdoc">PDG code for the ejectile.</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00120">Reaction.hh:120</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_ab47c4d8a6efbb9082f4c67c2f359b19f"><div class="ttname"><a href="classmarley_1_1_reaction.html#ab47c4d8a6efbb9082f4c67c2f359b19f">marley::Reaction::pdg_d_</a></div><div class="ttdeci">int pdg_d_</div><div class="ttdoc">PDG code for the residue.</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00121">Reaction.hh:121</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_ad51f858109e8e7735716448ad0911dd4"><div class="ttname"><a href="classmarley_1_1_reaction.html#ad51f858109e8e7735716448ad0911dd4">marley::Reaction::pdg_b_</a></div><div class="ttdeci">int pdg_b_</div><div class="ttdoc">PDG code for the target.</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00119">Reaction.hh:119</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_aea3c67ae0b64f048b0e728900200f96c"><div class="ttname"><a href="classmarley_1_1_reaction.html#aea3c67ae0b64f048b0e728900200f96c">marley::Reaction::ma_</a></div><div class="ttdeci">double ma_</div><div class="ttdoc">Projectile mass (MeV)</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00123">Reaction.hh:123</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_af3c38e0a9e08525685a2ee8de212d17a"><div class="ttname"><a href="classmarley_1_1_reaction.html#af3c38e0a9e08525685a2ee8de212d17a">marley::Reaction::mb_</a></div><div class="ttdeci">double mb_</div><div class="ttdoc">Target mass (MeV)</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00124">Reaction.hh:124</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="_nuclear_reaction_8cc_source.html#l00576">marley::NuclearReaction::make_event_object()</a>.</p>

</div>
</div>
<a id="a0cfd54925a6043deff06da8603c22207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cfd54925a6043deff06da8603c22207">&#9670;&nbsp;</a></span>total_xs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double marley::Reaction::total_xs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pdg_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>KEa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the reaction's total cross section (MeV<sup> -2</sup>) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdg_a</td><td>Projectile's PDG code </td></tr>
    <tr><td class="paramname">KEa</td><td>Lab-frame kinetic energy of the incident projectile </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reaction total cross section (MeV<sup> -2</sup>) </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Functions that override <a class="el" href="classmarley_1_1_reaction.html#a0cfd54925a6043deff06da8603c22207" title="Compute the reaction&#39;s total cross section (MeV -2)">total_xs()</a> should always return zero if pdg_a != pdg_a_. </dd></dl>

<p>Implemented in <a class="el" href="classmarley_1_1_nuclear_reaction.html#a90b183f962b9e3517c2e1fcf984ace45">marley::NuclearReaction</a>, and <a class="el" href="classmarley_1_1_electron_reaction.html#afaf8b4e57ef037cbefb35f1e3e9ca1ae">marley::ElectronReaction</a>.</p>

</div>
</div>
<a id="a50bce6655c58a4562ba371706f496995"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50bce6655c58a4562ba371706f496995">&#9670;&nbsp;</a></span>two_two_scatter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void marley::Reaction::two_two_scatter </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>KEa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>Ec_cm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>pc_cm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>Ed_cm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function that handles CM frame kinematics for the reaction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">KEa</td><td>Lab-frame kinetic energy (MeV) of the projectile </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">s</td><td><a href="https://en.wikipedia.org/wiki/Mandelstam_variables">Mandelstam s</a> (MeV<sup>2</sup>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Ec_cm</td><td>Ejectile total energy (MeV) in the CM frame </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pc_cm</td><td>Ejectile 3-momentum magnitude (MeV) in the CM frame </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Ed_cm</td><td>Residue total energy (MeV) in the CM frame </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_reaction_8cc_source.html#l00197">197</a> of file <a class="el" href="_reaction_8cc_source.html">Reaction.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;{</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="comment">// Get the lab-frame total energy of the projectile</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordtype">double</span> Ea = KEa + <a class="code" href="classmarley_1_1_reaction.html#aea3c67ae0b64f048b0e728900200f96c">ma_</a>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="comment">// Compute Mandelstam s (the square of the total CM frame energy)</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  s = <a class="code" href="classmarley_1_1_reaction.html#aea3c67ae0b64f048b0e728900200f96c">ma_</a>*<a class="code" href="classmarley_1_1_reaction.html#aea3c67ae0b64f048b0e728900200f96c">ma_</a> + <a class="code" href="classmarley_1_1_reaction.html#af3c38e0a9e08525685a2ee8de212d17a">mb_</a>*<a class="code" href="classmarley_1_1_reaction.html#af3c38e0a9e08525685a2ee8de212d17a">mb_</a> + 2.*<a class="code" href="classmarley_1_1_reaction.html#af3c38e0a9e08525685a2ee8de212d17a">mb_</a>*Ea;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordtype">double</span> sqrt_s = std::sqrt(s);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="comment">// Determine the CM frame energy and momentum of the ejectile</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  Ec_cm = (s + <a class="code" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a>*<a class="code" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a> - <a class="code" href="classmarley_1_1_reaction.html#a2a253c917efbb94aefe65806d9343a81">md_</a>*<a class="code" href="classmarley_1_1_reaction.html#a2a253c917efbb94aefe65806d9343a81">md_</a>) / (2 * sqrt_s);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  pc_cm = real_sqrt(std::pow(Ec_cm, 2) - <a class="code" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a>*<a class="code" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a>);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">// Determine the residue&#39;s CM frame energy. Roundoff errors may cause Ed_cm to</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">// dip below md, which is unphysical. Prevent this from occurring by allowing</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">// md to be the minimum value of Ed_cm. Also note that, in the CM frame, the</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">// residue and ejectile have equal and opposite momenta.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  Ed_cm = std::max(sqrt_s - Ec_cm, <a class="code" href="classmarley_1_1_reaction.html#a2a253c917efbb94aefe65806d9343a81">md_</a>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_reaction_8hh_source.html#l00123">ma_</a>, <a class="el" href="_reaction_8hh_source.html#l00124">mb_</a>, <a class="el" href="_reaction_8hh_source.html#l00125">mc_</a>, and <a class="el" href="_reaction_8hh_source.html#l00130">md_</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/Users/gardiner/fooey/include/marley/<a class="el" href="_reaction_8hh_source.html">Reaction.hh</a></li>
<li>/Users/gardiner/fooey/src/<a class="el" href="_reaction_8cc_source.html">Reaction.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
