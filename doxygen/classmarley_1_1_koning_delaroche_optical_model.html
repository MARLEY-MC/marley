<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MARLEY (Model of Argon Reaction Low Energy Yields): marley::KoningDelarocheOpticalModel Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/SVG"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="marley_diagram.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MARLEY (Model of Argon Reaction Low Energy Yields)
   &#160;<span id="projectnumber">c85c379</span>
   </div>
   <div id="projectbrief">A Monte Carlo event generator for tens-of-MeV neutrino interactions</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>marley</b></li><li class="navelem"><a class="el" href="classmarley_1_1_koning_delaroche_optical_model.html">KoningDelarocheOpticalModel</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classmarley_1_1_koning_delaroche_optical_model-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">marley::KoningDelarocheOpticalModel Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Nuclear optical model for fragment emission calculations.  
 <a href="classmarley_1_1_koning_delaroche_optical_model.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_koning_delaroche_optical_model_8hh_source.html">KoningDelarocheOpticalModel.hh</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for marley::KoningDelarocheOpticalModel:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classmarley_1_1_koning_delaroche_optical_model.png" usemap="#marley::KoningDelarocheOpticalModel_map" alt=""/>
  <map id="marley::KoningDelarocheOpticalModel_map" name="marley::KoningDelarocheOpticalModel_map">
<area href="classmarley_1_1_optical_model.html" title="Abstract base class for nuclear optical model implementations." alt="marley::OpticalModel" shape="rect" coords="0,0,229,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a510b0b0931a940232437b1af282a85fa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_koning_delaroche_optical_model.html#a510b0b0931a940232437b1af282a85fa">KoningDelarocheOpticalModel</a> (int <a class="el" href="classmarley_1_1_optical_model.html#a87433fad652d0fdf34685d63297dc258">Z</a>, int <a class="el" href="classmarley_1_1_optical_model.html#a5122fadbd2acdfb4d2cfa580b11b1f17">A</a>, double step_size=DEFAULT_NUMEROV_STEP_SIZE_)</td></tr>
<tr class="separator:a510b0b0931a940232437b1af282a85fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b84020af1019c684faec528afb74ed9"><td class="memItemLeft" align="right" valign="top">virtual std::complex&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_koning_delaroche_optical_model.html#a0b84020af1019c684faec528afb74ed9">optical_model_potential</a> (double r, double fragment_KE_lab, int fragment_pdg, int two_j, int l, int two_s, int target_charge=0) override</td></tr>
<tr class="memdesc:a0b84020af1019c684faec528afb74ed9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the optical model potential (including the Coulomb potential)  <a href="classmarley_1_1_koning_delaroche_optical_model.html#a0b84020af1019c684faec528afb74ed9">More...</a><br /></td></tr>
<tr class="separator:a0b84020af1019c684faec528afb74ed9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d049f21fa3e506a3e8ca61aff17c842"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_koning_delaroche_optical_model.html#a7d049f21fa3e506a3e8ca61aff17c842">total_cross_section</a> (double fragment_KE_lab, int fragment_pdg, int two_s, size_t l_max, int target_charge=0) override</td></tr>
<tr class="memdesc:a7d049f21fa3e506a3e8ca61aff17c842"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the energy-averaged total cross section (MeV<sup> -2</sup>) for a nuclear fragment projectile.  <a href="classmarley_1_1_koning_delaroche_optical_model.html#a7d049f21fa3e506a3e8ca61aff17c842">More...</a><br /></td></tr>
<tr class="separator:a7d049f21fa3e506a3e8ca61aff17c842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a263710ffb683a0dc00af29eba8ef340c"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_koning_delaroche_optical_model.html#a263710ffb683a0dc00af29eba8ef340c">transmission_coefficient</a> (double total_KE_CM, int fragment_pdg, int two_j, int l, int two_s, int target_charge=0) override</td></tr>
<tr class="memdesc:a263710ffb683a0dc00af29eba8ef340c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the transmission coefficient for a nuclear fragment.  <a href="classmarley_1_1_koning_delaroche_optical_model.html#a263710ffb683a0dc00af29eba8ef340c">More...</a><br /></td></tr>
<tr class="separator:a263710ffb683a0dc00af29eba8ef340c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classmarley_1_1_optical_model"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classmarley_1_1_optical_model')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classmarley_1_1_optical_model.html">marley::OpticalModel</a></td></tr>
<tr class="memitem:a18334d402037e864069f6763a3821aa2 inherit pub_methods_classmarley_1_1_optical_model"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_optical_model.html#a18334d402037e864069f6763a3821aa2">OpticalModel</a> (int <a class="el" href="classmarley_1_1_optical_model.html#a87433fad652d0fdf34685d63297dc258">Z</a>, int <a class="el" href="classmarley_1_1_optical_model.html#a5122fadbd2acdfb4d2cfa580b11b1f17">A</a>)</td></tr>
<tr class="separator:a18334d402037e864069f6763a3821aa2 inherit pub_methods_classmarley_1_1_optical_model"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5122fadbd2acdfb4d2cfa580b11b1f17 inherit pub_methods_classmarley_1_1_optical_model"><td class="memItemLeft" align="right" valign="top"><a id="a5122fadbd2acdfb4d2cfa580b11b1f17"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_optical_model.html#a5122fadbd2acdfb4d2cfa580b11b1f17">A</a> () const</td></tr>
<tr class="memdesc:a5122fadbd2acdfb4d2cfa580b11b1f17 inherit pub_methods_classmarley_1_1_optical_model"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the mass number. <br /></td></tr>
<tr class="separator:a5122fadbd2acdfb4d2cfa580b11b1f17 inherit pub_methods_classmarley_1_1_optical_model"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87433fad652d0fdf34685d63297dc258 inherit pub_methods_classmarley_1_1_optical_model"><td class="memItemLeft" align="right" valign="top"><a id="a87433fad652d0fdf34685d63297dc258"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_optical_model.html#a87433fad652d0fdf34685d63297dc258">Z</a> () const</td></tr>
<tr class="memdesc:a87433fad652d0fdf34685d63297dc258 inherit pub_methods_classmarley_1_1_optical_model"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the atomic number. <br /></td></tr>
<tr class="separator:a87433fad652d0fdf34685d63297dc258 inherit pub_methods_classmarley_1_1_optical_model"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classmarley_1_1_optical_model"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classmarley_1_1_optical_model')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classmarley_1_1_optical_model.html">marley::OpticalModel</a></td></tr>
<tr class="memitem:ab639073668ade79b0e69b7738af4b2c3 inherit pro_attribs_classmarley_1_1_optical_model"><td class="memItemLeft" align="right" valign="top"><a id="ab639073668ade79b0e69b7738af4b2c3"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>A_</b></td></tr>
<tr class="separator:ab639073668ade79b0e69b7738af4b2c3 inherit pro_attribs_classmarley_1_1_optical_model"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84985c84d743ef011fea7de13c718be4 inherit pro_attribs_classmarley_1_1_optical_model"><td class="memItemLeft" align="right" valign="top"><a id="a84985c84d743ef011fea7de13c718be4"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>Z_</b></td></tr>
<tr class="separator:a84985c84d743ef011fea7de13c718be4 inherit pro_attribs_classmarley_1_1_optical_model"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Nuclear optical model for fragment emission calculations. </p>
<p>This class implements the global optical model potential of A. J. Koning and J. P. Delaroche, <a href="http://dx.doi.org/10.1016/S0375-9474(02)01321-0">Nucl. Phys. A 713 (2003) 231-310</a>. <a href="https://en.wikipedia.org/wiki/Numerov%27s_method">Numerov's method</a> is used to integrate the Schr&ouml;dinger equation during transmission coefficient and cross section calculations. </p>

<p class="definition">Definition at line <a class="el" href="_koning_delaroche_optical_model_8hh_source.html#l00037">37</a> of file <a class="el" href="_koning_delaroche_optical_model_8hh_source.html">KoningDelarocheOpticalModel.hh</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a510b0b0931a940232437b1af282a85fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a510b0b0931a940232437b1af282a85fa">&#9670;&nbsp;</a></span>KoningDelarocheOpticalModel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">marley::KoningDelarocheOpticalModel::KoningDelarocheOpticalModel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>step_size</em> = <code>DEFAULT_NUMEROV_STEP_SIZE_</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Z</td><td>Atomic number of the desired nuclide </td></tr>
    <tr><td class="paramname">A</td><td>Mass number of the desired nuclide </td></tr>
    <tr><td class="paramname">step_size</td><td>Step size (fm) to use for numerical integration of the Schr&ouml;dinger equation </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_koning_delaroche_optical_model_8cc_source.html#l00194">194</a> of file <a class="el" href="_koning_delaroche_optical_model_8cc_source.html">KoningDelarocheOpticalModel.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                           : <a class="code" href="classmarley_1_1_optical_model.html">marley::OpticalModel</a>(<a class="code" href="classmarley_1_1_optical_model.html#a87433fad652d0fdf34685d63297dc258">Z</a>, <a class="code" href="classmarley_1_1_optical_model.html#a5122fadbd2acdfb4d2cfa580b11b1f17">A</a>), step_size_(step_size)</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;{</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; mt = <a class="code" href="classmarley_1_1_mass_table.html#a2e43b8ba549e31fc8c6b811656f69b94">marley::MassTable::Instance</a>();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  target_mass_ = mt.get_atomic_mass(<a class="code" href="classmarley_1_1_optical_model.html#a87433fad652d0fdf34685d63297dc258">Z</a>, <a class="code" href="classmarley_1_1_optical_model.html#a5122fadbd2acdfb4d2cfa580b11b1f17">A</a>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keywordtype">int</span> N = A_ - Z_; <span class="comment">// Neutron number</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordtype">double</span> A_to_the_one_third = std::pow(A_, 1.0/3.0);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">// Initialize the spherical optical model parameters (see TALYS 1.6 manual)</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">// Neutrons</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  v1n = 59.30 - 21.0*(N - Z_)/A_ - 0.024*A_; <span class="comment">// MeV</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  v2n = 0.007228 - 1.48e-6*A_; <span class="comment">// MeV^(-1)</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  v3n = 1.994e-5 - 2.0e-8*A_; <span class="comment">// MeV^(-2)</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  v4n = 7e-9; <span class="comment">// MeV^(-3)</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  w1n = 12.195 + 0.0167*A_; <span class="comment">// MeV</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  w2n = 73.55 + 0.0795*A_; <span class="comment">// MeV</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  d1n = 16.0 - 16.0*(N - Z_)/A_; <span class="comment">// MeV</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  d2n = 0.0180 + 0.003802/(1 + std::exp((A_ - 156.)/8.0)); <span class="comment">// MeV^(-1)</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  d3n = 11.5; <span class="comment">// MeV</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  vso1n = 5.922 + 0.0030*A_; <span class="comment">// MeV</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  vso2n = 0.0040; <span class="comment">// MeV^(-1)</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  wso1n = -3.1; <span class="comment">// MeV</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  wso2n = 160.; <span class="comment">// MeV</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  Efn = -11.2814 + 0.02646*A_; <span class="comment">// MeV</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  Rvn = 1.3039*A_to_the_one_third - 0.4054; <span class="comment">// fm</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  avn = 0.6778 - 1.487e-4*A_; <span class="comment">// fm</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  Rdn = 1.3424*A_to_the_one_third</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    - 0.01585*std::pow(A_to_the_one_third, 2); <span class="comment">// fm</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  adn = 0.5446 - 1.656e-4*A_; <span class="comment">// fm</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  Rso_n = 1.1854*A_to_the_one_third - 0.647; <span class="comment">// fm</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  aso_n = 0.59; <span class="comment">// fm</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">// Protons</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  v1p = 59.30 + 21.0*(N - Z_)/A_ - 0.024*A_; <span class="comment">// MeV</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  v2p = 0.007067 + 4.23e-6*A_; <span class="comment">// MeV^(-1)</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  v3p = 1.729e-5 + 1.136e-8*A_; <span class="comment">// MeV^(-2)</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  v4p = v4n; <span class="comment">// MeV^(-3)</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  w1p = 14.667 + 0.009629*A_; <span class="comment">// MeV</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  w2p = w2n; <span class="comment">// MeV</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  d1p = 16.0 + 16.0*(N - Z_)/A_; <span class="comment">// MeV</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  d2p = d2n; <span class="comment">// MeV^(-1)</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  d3p = d3n; <span class="comment">// MeV</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  vso1p = vso1n; <span class="comment">// MeV</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  vso2p = vso2n; <span class="comment">// MeV^(-1)</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  wso1p = wso1n; <span class="comment">// MeV</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  wso2p = wso2n; <span class="comment">// MeV</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  Efp = -8.4075 + 0.01378*A_; <span class="comment">// MeV</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  Rvp = Rvn;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  avp = avn;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  Rdp = Rdn;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  adp = 0.5187 + 5.205e-4*A_; <span class="comment">// fm</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  Rso_p = Rso_n;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  aso_p = aso_n;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  Rc = 1.198*A_to_the_one_third + 0.697/A_to_the_one_third</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    + 12.994*std::pow(A_to_the_one_third, -4); <span class="comment">// fm</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  Vcbar_p = 1.73 * Z_ / Rc; <span class="comment">// MeV</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;}</div>
<div class="ttc" id="aclassmarley_1_1_mass_table_html_a2e43b8ba549e31fc8c6b811656f69b94"><div class="ttname"><a href="classmarley_1_1_mass_table.html#a2e43b8ba549e31fc8c6b811656f69b94">marley::MassTable::Instance</a></div><div class="ttdeci">static const MassTable &amp; Instance()</div><div class="ttdoc">Get a const reference to the singleton instance of the MassTable.</div><div class="ttdef"><b>Definition:</b> <a href="_mass_table_8cc_source.html#l00068">MassTable.cc:68</a></div></div>
<div class="ttc" id="aclassmarley_1_1_optical_model_html"><div class="ttname"><a href="classmarley_1_1_optical_model.html">marley::OpticalModel</a></div><div class="ttdoc">Abstract base class for nuclear optical model implementations.</div><div class="ttdef"><b>Definition:</b> <a href="_optical_model_8hh_source.html#l00023">OpticalModel.hh:23</a></div></div>
<div class="ttc" id="aclassmarley_1_1_optical_model_html_a5122fadbd2acdfb4d2cfa580b11b1f17"><div class="ttname"><a href="classmarley_1_1_optical_model.html#a5122fadbd2acdfb4d2cfa580b11b1f17">marley::OpticalModel::A</a></div><div class="ttdeci">int A() const</div><div class="ttdoc">Get the mass number.</div><div class="ttdef"><b>Definition:</b> <a href="_optical_model_8hh_source.html#l00097">OpticalModel.hh:97</a></div></div>
<div class="ttc" id="aclassmarley_1_1_optical_model_html_a87433fad652d0fdf34685d63297dc258"><div class="ttname"><a href="classmarley_1_1_optical_model.html#a87433fad652d0fdf34685d63297dc258">marley::OpticalModel::Z</a></div><div class="ttdeci">int Z() const</div><div class="ttdoc">Get the atomic number.</div><div class="ttdef"><b>Definition:</b> <a href="_optical_model_8hh_source.html#l00095">OpticalModel.hh:95</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_optical_model_8hh_source.html#l00097">marley::OpticalModel::A()</a>, <a class="el" href="_mass_table_8cc_source.html#l00068">marley::MassTable::Instance()</a>, and <a class="el" href="_optical_model_8hh_source.html#l00095">marley::OpticalModel::Z()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a0b84020af1019c684faec528afb74ed9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b84020af1019c684faec528afb74ed9">&#9670;&nbsp;</a></span>optical_model_potential()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::complex&lt; double &gt; marley::KoningDelarocheOpticalModel::optical_model_potential </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fragment_KE_lab</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fragment_pdg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>two_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>two_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>target_charge</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the optical model potential (including the Coulomb potential) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">r</td><td>Distance from nuclear center (fm) </td></tr>
    <tr><td class="paramname">fragment_KE_lab</td><td><a class="el" href="classmarley_1_1_fragment.html" title="Simple container for storing reference data about each of the nuclear fragments considered by MARLEY&#39;...">Fragment</a> kinetic energy (MeV) in the lab frame </td></tr>
    <tr><td class="paramname">fragment_pdg</td><td>PDG code for the nuclear fragment </td></tr>
    <tr><td class="paramname">two_j</td><td>Two times the total angular momentum of the fragment </td></tr>
    <tr><td class="paramname">l</td><td>Orbital angular momentum of the fragment </td></tr>
    <tr><td class="paramname">two_s</td><td>Two times the spin of the fragment </td></tr>
    <tr><td class="paramname">target_charge</td><td>Net charge of the target atom </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Complex-valued optical model potential (MeV) </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000012">Todo:</a></b></dt><dd>TODO: find a better way of doing this! </dd></dl>

<p>Implements <a class="el" href="classmarley_1_1_optical_model.html#a33eab687775062def3ee6d5c3557b25b">marley::OpticalModel</a>.</p>

<p class="definition">Definition at line <a class="el" href="_koning_delaroche_optical_model_8cc_source.html#l00025">25</a> of file <a class="el" href="_koning_delaroche_optical_model_8cc_source.html">KoningDelarocheOpticalModel.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  update_target_mass( target_charge );</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="comment">// The calculate_kinematic_variables() function will set the fragment_mass_</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="comment">// member variable, but we need that value in advance in order to provide the total</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="comment">// CM frame kinetic energy as input. To get around this, retrieve the fragment mass</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="comment">// directly from the mass table instead</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; mt = <a class="code" href="classmarley_1_1_mass_table.html#a2e43b8ba549e31fc8c6b811656f69b94">marley::MassTable::Instance</a>();</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">double</span> m_fragment = mt.get_particle_mass( fragment_pdg );</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">double</span> KE_tot_CM = std::max(0., marley_utils::real_sqrt(</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    std::pow(target_mass_ + m_fragment, 2)</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    + 2.*target_mass_*fragment_KE_lab) - m_fragment - target_mass_);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  calculate_kinematic_variables( KE_tot_CM, fragment_pdg );</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  calculate_om_parameters(fragment_pdg, two_j, l, two_s);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordflow">return</span> omp(r);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_mass_table_8cc_source.html#l00068">marley::MassTable::Instance()</a>.</p>

</div>
</div>
<a id="a7d049f21fa3e506a3e8ca61aff17c842"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d049f21fa3e506a3e8ca61aff17c842">&#9670;&nbsp;</a></span>total_cross_section()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double marley::KoningDelarocheOpticalModel::total_cross_section </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fragment_KE_lab</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fragment_pdg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>two_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>l_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>target_charge</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the energy-averaged total cross section (MeV<sup> -2</sup>) for a nuclear fragment projectile. </p>
<p>The total cross section given here by the optical model may be directly compared to experiment. Expressions exist for the optical model elastic and reaction (absorption) cross sections, but these are hard to directly compare to the data because the absorption cross section includes the compound elastic channel.</p>
<p>For more details, see appendix A (especially equation A.12) of S. Gardiner, "Nuclear Effects in Neutrino Detection," PhD thesis, University of California, Davis, 2018. Note that we assume in this function that the target nucleus has zero spin (spherical optical model). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fragment_KE_lab</td><td>Lab-frame kinetic energy of the incident projectile (MeV) </td></tr>
    <tr><td class="paramname">fragment_pdg</td><td>Projectile's PDG code </td></tr>
    <tr><td class="paramname">two_s</td><td>Two times the spin of the projectile </td></tr>
    <tr><td class="paramname">l_max</td><td>The maximum value of the orbital angular momentum quantum number \(\ell\) to include in the sum over S-matrix elements </td></tr>
    <tr><td class="paramname">target_charge</td><td>Net charge of the target atom (used to adjust the atomic mass by the appropriate number of electron masses if the target is ionized) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Energy-averaged total scattering cross section (MeV<sup> -2</sup>) </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000013">Todo:</a></b></dt><dd>TODO: find a better way of doing this! </dd></dl>

<p>Implements <a class="el" href="classmarley_1_1_optical_model.html#ab7fcf7e8f4d8a49def101cfcd1ccc59d">marley::OpticalModel</a>.</p>

<p class="definition">Definition at line <a class="el" href="_koning_delaroche_optical_model_8cc_source.html#l00256">256</a> of file <a class="el" href="_koning_delaroche_optical_model_8cc_source.html">KoningDelarocheOpticalModel.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;{</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  update_target_mass( target_charge );</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="comment">// The calculate_kinematic_variables() function will set the fragment_mass_</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="comment">// member variable, but we need that value in advance in order to provide the total</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="comment">// CM frame kinetic energy as input. To get around this, retrieve the fragment mass</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="comment">// directly from the mass table instead</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; mt = <a class="code" href="classmarley_1_1_mass_table.html#a2e43b8ba549e31fc8c6b811656f69b94">marley::MassTable::Instance</a>();</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordtype">double</span> m_fragment = mt.get_particle_mass( fragment_pdg );</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordtype">double</span> KE_tot_CM = std::max(0., marley_utils::real_sqrt(</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    std::pow(target_mass_ + m_fragment, 2)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    + 2.*target_mass_*fragment_KE_lab) - m_fragment - target_mass_);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  calculate_kinematic_variables( KE_tot_CM, fragment_pdg );</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordtype">double</span> sum = 0.;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> l = 0; l &lt;= l_max; ++l) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordtype">int</span> two_l = 2*l;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> two_j = std::abs(two_l - two_s);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      two_j &lt;= two_l + two_s; two_j += 2)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      std::complex&lt;double&gt; S = s_matrix_element(fragment_pdg, two_j, l, two_s);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      sum += (two_j + 1) * (1 - S.real());</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="comment">// Compute the cross section in natural units (MeV^(-2))</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordtype">double</span> xs = marley_utils::two_pi * sum / ((two_s + 1) * CM_frame_momentum_squared_);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keywordflow">return</span> xs;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_mass_table_8cc_source.html#l00068">marley::MassTable::Instance()</a>.</p>

</div>
</div>
<a id="a263710ffb683a0dc00af29eba8ef340c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a263710ffb683a0dc00af29eba8ef340c">&#9670;&nbsp;</a></span>transmission_coefficient()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double marley::KoningDelarocheOpticalModel::transmission_coefficient </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>total_KE_CM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fragment_pdg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>two_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>two_s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>target_charge</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the transmission coefficient for a nuclear fragment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">total_KE_CM</td><td>Total CM frame kinetic energy (MeV) </td></tr>
    <tr><td class="paramname">fragment_pdg</td><td>PDG code of the fragment </td></tr>
    <tr><td class="paramname">two_j</td><td>Two times the total angular momentum of the fragment </td></tr>
    <tr><td class="paramname">l</td><td>Orbital angular momentum of the fragment </td></tr>
    <tr><td class="paramname">two_s</td><td>Two times the spin of the fragment </td></tr>
    <tr><td class="paramname">target_charge</td><td>Net charge of the target atom </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classmarley_1_1_optical_model.html#a9f767e4a177f1bb0a2a8d436c5c07d63">marley::OpticalModel</a>.</p>

<p class="definition">Definition at line <a class="el" href="_koning_delaroche_optical_model_8cc_source.html#l00292">292</a> of file <a class="el" href="_koning_delaroche_optical_model_8cc_source.html">KoningDelarocheOpticalModel.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;{</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordflow">if</span> ( total_KE_CM &lt;= 0. ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  update_target_mass( target_charge );</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  calculate_kinematic_variables( total_KE_CM, fragment_pdg );</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  std::complex&lt;double&gt; S = s_matrix_element(fragment_pdg, two_j, l, two_s);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="comment">// Guard against ±inf or NaN values that can occur in edge cases when the</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="comment">// Coulomb wavefunctions get huge, e.g., for low-energy alpha emission.</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="comment">// Numerical precision problems can lead to wrong answers, such as S == (inf,</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="comment">// 0) instead of the correct (1, 0).</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="keywordtype">bool</span> S_is_finite = std::isfinite( S.real() ) &amp;&amp; std::isfinite( S.imag() );</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="comment">// If we have a ±inf or NaN in one of the components of S, then set the</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="comment">// transmission coefficient to zero</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordflow">if</span> ( !S_is_finite ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="comment">// To guard against numerical issues that can make the norm of the S-matrix</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="comment">// element creep above unity, explicitly enforce that it lies on the interval</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="comment">// [0, 1].</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="comment">// TODO: revisit this, perhaps add a warning message?</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordtype">double</span> norm_S = std::norm(S);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordflow">if</span> ( norm_S &lt; 0. || norm_S &gt; 1.0000001 ) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    MARLEY_LOG_DEBUG() &lt;&lt; <span class="stringliteral">&quot;Invalid S-matrix norm = &quot;</span> &lt;&lt; norm_S &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  norm_S = std::min(1., std::max(0., norm_S));</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">// We can now compute the transmission coefficient in the usual way</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keywordflow">return</span> 1.0 - norm_S;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/sjg/GENIE/marley/include/marley/<a class="el" href="_koning_delaroche_optical_model_8hh_source.html">KoningDelarocheOpticalModel.hh</a></li>
<li>/home/sjg/GENIE/marley/src/<a class="el" href="_koning_delaroche_optical_model_8cc_source.html">KoningDelarocheOpticalModel.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
