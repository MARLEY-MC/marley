<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MARLEY (Model of Argon Reaction Low Energy Yields): marley::NuclearReaction Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/SVG"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="marley_diagram.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MARLEY (Model of Argon Reaction Low Energy Yields)
   &#160;<span id="projectnumber">v1.2.0</span>
   </div>
   <div id="projectbrief">A Monte Carlo event generator for tens-of-MeV neutrino interactions</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>marley</b></li><li class="navelem"><a class="el" href="classmarley_1_1_nuclear_reaction.html">NuclearReaction</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a> &#124;
<a href="classmarley_1_1_nuclear_reaction-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">marley::NuclearReaction Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A neutrino-nucleus reaction.  
 <a href="classmarley_1_1_nuclear_reaction.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_nuclear_reaction_8hh_source.html">NuclearReaction.hh</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for marley::NuclearReaction:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classmarley_1_1_nuclear_reaction.png" usemap="#marley::NuclearReaction_map" alt=""/>
  <map id="marley::NuclearReaction_map" name="marley::NuclearReaction_map">
<area href="classmarley_1_1_reaction.html" title="Abstract base class that represents a two-two scattering reaction." alt="marley::Reaction" shape="rect" coords="0,0,150,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:ac5f7ef6b49c0f776b5fe042d13de497e"><td class="memItemLeft" align="right" valign="top"><a id="ac5f7ef6b49c0f776b5fe042d13de497e"></a>enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#ac5f7ef6b49c0f776b5fe042d13de497e">CoulombMode</a> { <br />
&#160;&#160;<b>NO_CORRECTION</b>
, <b>FERMI_FUNCTION</b>
, <b>EMA</b>
, <b>MEMA</b>
, <br />
&#160;&#160;<b>FERMI_AND_EMA</b>
, <b>FERMI_AND_MEMA</b>
<br />
 }</td></tr>
<tr class="memdesc:ac5f7ef6b49c0f776b5fe042d13de497e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumerated type used to set the method for handling Coulomb corrections for CC nuclear reactions. <br /></td></tr>
<tr class="separator:ac5f7ef6b49c0f776b5fe042d13de497e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_types_classmarley_1_1_reaction"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classmarley_1_1_reaction')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classmarley_1_1_reaction.html">marley::Reaction</a></td></tr>
<tr class="memitem:a6a9981b171ef4c1f5f6a652e6a6e3d94 inherit pub_types_classmarley_1_1_reaction"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">ProcessType</a> { <a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94aded8794ce1a3d4e374a5f43a50a88efe">NeutrinoCC</a> = 0
, <a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94a4cec48f7731945e5a319518aa470e5e3">AntiNeutrinoCC</a> = 1
, <a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94a93614be018f3848c2850745e8b71c4af">NC</a> = 2
, <a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94a646f6d0c38bb6e87b389701977beb7b8">NuElectronElastic</a> = 3
 }</td></tr>
<tr class="memdesc:a6a9981b171ef4c1f5f6a652e6a6e3d94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumerated type describing the kind of scattering process represented by a <a class="el" href="classmarley_1_1_reaction.html" title="Abstract base class that represents a two-two scattering reaction.">Reaction</a>.  <a href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">More...</a><br /></td></tr>
<tr class="separator:a6a9981b171ef4c1f5f6a652e6a6e3d94 inherit pub_types_classmarley_1_1_reaction"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a70d468e83ba5f02a0802c4dbcd070eae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#a70d468e83ba5f02a0802c4dbcd070eae">NuclearReaction</a> (<a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">ProcessType</a> pt, int <a class="el" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>, int <a class="el" href="classmarley_1_1_reaction.html#af17d5a00782f0401f101f1a8c99b499a">pdg_b</a>, int pdg_c, int pdg_d, int q_d, const std::shared_ptr&lt; std::vector&lt; <a class="el" href="classmarley_1_1_matrix_element.html">marley::MatrixElement</a> &gt; &gt; &amp;mat_els)</td></tr>
<tr class="separator:a70d468e83ba5f02a0802c4dbcd070eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab330fbfd0e09e564953d6741d7ebc3ed"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmarley_1_1_target_atom.html">marley::TargetAtom</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#ab330fbfd0e09e564953d6741d7ebc3ed">atomic_target</a> () const override final</td></tr>
<tr class="memdesc:ab330fbfd0e09e564953d6741d7ebc3ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the target atom involved in this reaction.  <a href="classmarley_1_1_nuclear_reaction.html#ab330fbfd0e09e564953d6741d7ebc3ed">More...</a><br /></td></tr>
<tr class="separator:ab330fbfd0e09e564953d6741d7ebc3ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03501d3d61096e890cb3d5ae07b7bce1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#a03501d3d61096e890cb3d5ae07b7bce1">coulomb_correction_factor</a> (double beta_rel_cd) const</td></tr>
<tr class="separator:a03501d3d61096e890cb3d5ae07b7bce1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4510f83ed0beff3a27ebe64d0e03097f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmarley_1_1_nuclear_reaction.html#ac5f7ef6b49c0f776b5fe042d13de497e">CoulombMode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#a4510f83ed0beff3a27ebe64d0e03097f">coulomb_mode</a> () const</td></tr>
<tr class="separator:a4510f83ed0beff3a27ebe64d0e03097f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ab5c74e0daf4bb7cb47428e2273002a"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classmarley_1_1_event.html">marley::Event</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#a8ab5c74e0daf4bb7cb47428e2273002a">create_event</a> (int particle_id_a, double KEa, <a class="el" href="classmarley_1_1_generator.html">marley::Generator</a> &amp;gen) const override</td></tr>
<tr class="memdesc:a8ab5c74e0daf4bb7cb47428e2273002a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Produces a two-two scattering <a class="el" href="classmarley_1_1_event.html" title="Container for ingoing and outgoing momentum 4-vectors from a reaction.">Event</a> that proceeds via this reaction.  <a href="classmarley_1_1_nuclear_reaction.html#a8ab5c74e0daf4bb7cb47428e2273002a">More...</a><br /></td></tr>
<tr class="separator:a8ab5c74e0daf4bb7cb47428e2273002a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2042c9a2c95df1037cb2326f14200207"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#a2042c9a2c95df1037cb2326f14200207">diff_xs</a> (const <a class="el" href="classmarley_1_1_matrix_element.html">marley::MatrixElement</a> &amp;mat_el, double KEa, double cos_theta_c_cm) const</td></tr>
<tr class="memdesc:a2042c9a2c95df1037cb2326f14200207"><td class="mdescLeft">&#160;</td><td class="mdescRight">Differential cross section \(d\sigma/d\cos\theta_{c}^{\mathrm{CM}}\) (MeV<sup> -2</sup>) evaluated in the center-of-momentum frame for a transition to a particular final nuclear level.  <a href="classmarley_1_1_nuclear_reaction.html#a2042c9a2c95df1037cb2326f14200207">More...</a><br /></td></tr>
<tr class="separator:a2042c9a2c95df1037cb2326f14200207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ae90ef14de8e0f71928d1ec696d9dee"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#a0ae90ef14de8e0f71928d1ec696d9dee">diff_xs</a> (int <a class="el" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>, double KEa, double cos_theta_c_cm) const override</td></tr>
<tr class="memdesc:a0ae90ef14de8e0f71928d1ec696d9dee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Differential cross section \(d\sigma/d\cos\theta_{c}^{\mathrm{CM}}\) (MeV<sup> -2</sup>) summed over all kinematically-allowed final nuclear levels.  <a href="classmarley_1_1_nuclear_reaction.html#a0ae90ef14de8e0f71928d1ec696d9dee">More...</a><br /></td></tr>
<tr class="separator:a0ae90ef14de8e0f71928d1ec696d9dee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa98133012b9442da7fc1779d92d68a9e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#aa98133012b9442da7fc1779d92d68a9e">ema_factor</a> (double beta_rel_cd, bool &amp;ok, bool modified_ema) const</td></tr>
<tr class="separator:aa98133012b9442da7fc1779d92d68a9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1316c7149a70dae8313bd132a2a831e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#ad1316c7149a70dae8313bd132a2a831e">fermi_function</a> (double beta_c) const</td></tr>
<tr class="memdesc:ad1316c7149a70dae8313bd132a2a831e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the <a href="https://en.wikipedia.org/wiki/Beta_decay#Fermi_function">Fermi function</a>  <a href="classmarley_1_1_nuclear_reaction.html#ad1316c7149a70dae8313bd132a2a831e">More...</a><br /></td></tr>
<tr class="separator:ad1316c7149a70dae8313bd132a2a831e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5cda1d336d71c47ca4bab559ea860a0"><td class="memItemLeft" align="right" valign="top"><a id="ae5cda1d336d71c47ca4bab559ea860a0"></a>
const std::vector&lt; <a class="el" href="classmarley_1_1_matrix_element.html">marley::MatrixElement</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#ae5cda1d336d71c47ca4bab559ea860a0">matrix_elements</a> () const</td></tr>
<tr class="memdesc:ae5cda1d336d71c47ca4bab559ea860a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allows access to the owned vector of <a class="el" href="classmarley_1_1_matrix_element.html" title="A reduced nuclear matrix element that represents a transition caused by a neutrino-nucleus reaction.">MatrixElement</a> objects. <br /></td></tr>
<tr class="separator:ae5cda1d336d71c47ca4bab559ea860a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52f4df6ace8f63efe262829424c52605"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#a52f4df6ace8f63efe262829424c52605">max_level_energy</a> (double KEa) const</td></tr>
<tr class="memdesc:a52f4df6ace8f63efe262829424c52605"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the maximum possible excitation energy (MeV) of the final-state residue that is kinematically allowed.  <a href="classmarley_1_1_nuclear_reaction.html#a52f4df6ace8f63efe262829424c52605">More...</a><br /></td></tr>
<tr class="separator:a52f4df6ace8f63efe262829424c52605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4324b3ce8d5a15fc71e1b0f727a9026"><td class="memItemLeft" align="right" valign="top"><a id="aa4324b3ce8d5a15fc71e1b0f727a9026"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#aa4324b3ce8d5a15fc71e1b0f727a9026">set_coulomb_mode</a> (<a class="el" href="classmarley_1_1_nuclear_reaction.html#ac5f7ef6b49c0f776b5fe042d13de497e">CoulombMode</a> mode)</td></tr>
<tr class="memdesc:aa4324b3ce8d5a15fc71e1b0f727a9026"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the method for handling Coulomb corrections for this reaction. <br /></td></tr>
<tr class="separator:aa4324b3ce8d5a15fc71e1b0f727a9026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7843d2e4a518fd04a5328e1f95cb2b13"><td class="memItemLeft" align="right" valign="top"><a id="a7843d2e4a518fd04a5328e1f95cb2b13"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#a7843d2e4a518fd04a5328e1f95cb2b13">set_decay_scheme</a> (<a class="el" href="classmarley_1_1_decay_scheme.html">marley::DecayScheme</a> *scheme)</td></tr>
<tr class="memdesc:a7843d2e4a518fd04a5328e1f95cb2b13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the <a class="el" href="classmarley_1_1_decay_scheme.html" title="Discrete level and Î³-ray data for a specific nuclide.">DecayScheme</a> object to use for sampling excited levels in the residue. <br /></td></tr>
<tr class="separator:a7843d2e4a518fd04a5328e1f95cb2b13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d9e9499c974b6fcdb9fedb0be60c0e0"><td class="memItemLeft" align="right" valign="top"><a id="a3d9e9499c974b6fcdb9fedb0be60c0e0"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#a3d9e9499c974b6fcdb9fedb0be60c0e0">threshold_kinetic_energy</a> () const override</td></tr>
<tr class="memdesc:a3d9e9499c974b6fcdb9fedb0be60c0e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the minimum lab-frame kinetic energy (MeV) of the projectile that allows this reaction to proceed via a transition to the residue's ground state. <br /></td></tr>
<tr class="separator:a3d9e9499c974b6fcdb9fedb0be60c0e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf4a1384bde1ca1588021f2a4c71601c"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#adf4a1384bde1ca1588021f2a4c71601c">total_xs</a> (const <a class="el" href="classmarley_1_1_matrix_element.html">marley::MatrixElement</a> &amp;me, double KEa, double &amp;beta_c_cm, bool check_max_E_level=true) const</td></tr>
<tr class="memdesc:adf4a1384bde1ca1588021f2a4c71601c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total cross section (MeV<sup> -2</sup>) for a given final nuclear level.  <a href="classmarley_1_1_nuclear_reaction.html#adf4a1384bde1ca1588021f2a4c71601c">More...</a><br /></td></tr>
<tr class="separator:adf4a1384bde1ca1588021f2a4c71601c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90b183f962b9e3517c2e1fcf984ace45"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#a90b183f962b9e3517c2e1fcf984ace45">total_xs</a> (int <a class="el" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>, double KEa) const override</td></tr>
<tr class="memdesc:a90b183f962b9e3517c2e1fcf984ace45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total reaction cross section (MeV<sup> -2</sup>), including all kinematically-allowed final nuclear levels.  <a href="classmarley_1_1_nuclear_reaction.html#a90b183f962b9e3517c2e1fcf984ace45">More...</a><br /></td></tr>
<tr class="separator:a90b183f962b9e3517c2e1fcf984ace45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a185b95eab0e2d1ec62c7fb65b73f69e6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#a185b95eab0e2d1ec62c7fb65b73f69e6">weak_nuclear_charge</a> () const</td></tr>
<tr class="separator:a185b95eab0e2d1ec62c7fb65b73f69e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classmarley_1_1_reaction"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classmarley_1_1_reaction')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classmarley_1_1_reaction.html">marley::Reaction</a></td></tr>
<tr class="memitem:aa1795795d1041070fe366ddda55863e1 inherit pub_methods_classmarley_1_1_reaction"><td class="memItemLeft" align="right" valign="top"><a id="aa1795795d1041070fe366ddda55863e1"></a>
const std::string &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#aa1795795d1041070fe366ddda55863e1">get_description</a> () const</td></tr>
<tr class="memdesc:aa1795795d1041070fe366ddda55863e1 inherit pub_methods_classmarley_1_1_reaction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a string that contains the formula for this reaction. <br /></td></tr>
<tr class="separator:aa1795795d1041070fe366ddda55863e1 inherit pub_methods_classmarley_1_1_reaction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1aec5433c9da5813edc46e0cf545c05 inherit pub_methods_classmarley_1_1_reaction"><td class="memItemLeft" align="right" valign="top"><a id="ad1aec5433c9da5813edc46e0cf545c05"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a> () const</td></tr>
<tr class="memdesc:ad1aec5433c9da5813edc46e0cf545c05 inherit pub_methods_classmarley_1_1_reaction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the projectile PDG code. <br /></td></tr>
<tr class="separator:ad1aec5433c9da5813edc46e0cf545c05 inherit pub_methods_classmarley_1_1_reaction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af17d5a00782f0401f101f1a8c99b499a inherit pub_methods_classmarley_1_1_reaction"><td class="memItemLeft" align="right" valign="top"><a id="af17d5a00782f0401f101f1a8c99b499a"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#af17d5a00782f0401f101f1a8c99b499a">pdg_b</a> () const</td></tr>
<tr class="memdesc:af17d5a00782f0401f101f1a8c99b499a inherit pub_methods_classmarley_1_1_reaction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the target PDG code. <br /></td></tr>
<tr class="separator:af17d5a00782f0401f101f1a8c99b499a inherit pub_methods_classmarley_1_1_reaction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa431e6bf7ad1acf758fc0d779727a88 inherit pub_methods_classmarley_1_1_reaction"><td class="memItemLeft" align="right" valign="top"><a id="aaa431e6bf7ad1acf758fc0d779727a88"></a>
<a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">ProcessType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#aaa431e6bf7ad1acf758fc0d779727a88">process_type</a> () const</td></tr>
<tr class="memdesc:aaa431e6bf7ad1acf758fc0d779727a88 inherit pub_methods_classmarley_1_1_reaction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the process type for this reaction. <br /></td></tr>
<tr class="separator:aaa431e6bf7ad1acf758fc0d779727a88 inherit pub_methods_classmarley_1_1_reaction"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a5f866bc7a51b77cefafe06290ee619b9"><td class="memItemLeft" align="right" valign="top"><a id="a5f866bc7a51b77cefafe06290ee619b9"></a>
static <a class="el" href="classmarley_1_1_nuclear_reaction.html#ac5f7ef6b49c0f776b5fe042d13de497e">CoulombMode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#a5f866bc7a51b77cefafe06290ee619b9">coulomb_mode_from_string</a> (const std::string &amp;str)</td></tr>
<tr class="memdesc:a5f866bc7a51b77cefafe06290ee619b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a string to a CoulombMode value. <br /></td></tr>
<tr class="separator:a5f866bc7a51b77cefafe06290ee619b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12cb1ee38e4f5676d36f4c35a9b9ab31"><td class="memItemLeft" align="right" valign="top"><a id="a12cb1ee38e4f5676d36f4c35a9b9ab31"></a>
static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#a12cb1ee38e4f5676d36f4c35a9b9ab31">string_from_coulomb_mode</a> (<a class="el" href="classmarley_1_1_nuclear_reaction.html#ac5f7ef6b49c0f776b5fe042d13de497e">CoulombMode</a> mode)</td></tr>
<tr class="memdesc:a12cb1ee38e4f5676d36f4c35a9b9ab31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a CoulombMode value to a string. <br /></td></tr>
<tr class="separator:a12cb1ee38e4f5676d36f4c35a9b9ab31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_methods_classmarley_1_1_reaction"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classmarley_1_1_reaction')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classmarley_1_1_reaction.html">marley::Reaction</a></td></tr>
<tr class="memitem:a3bb982f699e86e68288c6a460387a6f0 inherit pub_static_methods_classmarley_1_1_reaction"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a3bb982f699e86e68288c6a460387a6f0">get_ejectile_pdg</a> (int <a class="el" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>, <a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">ProcessType</a> proc_type)</td></tr>
<tr class="separator:a3bb982f699e86e68288c6a460387a6f0 inherit pub_static_methods_classmarley_1_1_reaction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e570c8943d34d22f11cd5f676b6f317 inherit pub_static_methods_classmarley_1_1_reaction"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; std::unique_ptr&lt; <a class="el" href="classmarley_1_1_reaction.html">Reaction</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a6e570c8943d34d22f11cd5f676b6f317">load_from_file</a> (const std::string &amp;filename, <a class="el" href="classmarley_1_1_structure_database.html">marley::StructureDatabase</a> &amp;db)</td></tr>
<tr class="separator:a6e570c8943d34d22f11cd5f676b6f317 inherit pub_static_methods_classmarley_1_1_reaction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b9cb9e0c0f3712e9cab0516940cec21 inherit pub_static_methods_classmarley_1_1_reaction"><td class="memItemLeft" align="right" valign="top"><a id="a5b9cb9e0c0f3712e9cab0516940cec21"></a>
static std::string&#160;</td><td class="memItemRight" valign="bottom"><b>proc_type_to_string</b> (const <a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">ProcessType</a> &amp;pt)</td></tr>
<tr class="separator:a5b9cb9e0c0f3712e9cab0516940cec21 inherit pub_static_methods_classmarley_1_1_reaction"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a4ef889614cd67fb298aea85ef631335e"><td class="memItemLeft" align="right" valign="top"><a id="a4ef889614cd67fb298aea85ef631335e"></a>
virtual <a class="el" href="classmarley_1_1_event.html">marley::Event</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#a4ef889614cd67fb298aea85ef631335e">make_event_object</a> (double KEa, double pc_cm, double cos_theta_c_cm, double phi_c_cm, double Ec_cm, double Ed_cm, double E_level, int twoJ, const <a class="el" href="classmarley_1_1_parity.html">marley::Parity</a> &amp;P) const override</td></tr>
<tr class="memdesc:a4ef889614cd67fb298aea85ef631335e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function used by <a class="el" href="classmarley_1_1_nuclear_reaction.html#a8ab5c74e0daf4bb7cb47428e2273002a" title="Produces a two-two scattering Event that proceeds via this reaction.">NuclearReaction::create_event()</a> <br /></td></tr>
<tr class="separator:a4ef889614cd67fb298aea85ef631335e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a086090d9744add7508d422cca99cfca7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#a086090d9744add7508d422cca99cfca7">sample_cos_theta_c_cm</a> (const <a class="el" href="classmarley_1_1_matrix_element.html">marley::MatrixElement</a> &amp;matrix_el, double beta_c_cm, <a class="el" href="classmarley_1_1_generator.html">marley::Generator</a> &amp;gen) const</td></tr>
<tr class="memdesc:a086090d9744add7508d422cca99cfca7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Samples a polar angle cosine for the ejectile using the relevant portion of the reaction nuclear matrix element.  <a href="classmarley_1_1_nuclear_reaction.html#a086090d9744add7508d422cca99cfca7">More...</a><br /></td></tr>
<tr class="separator:a086090d9744add7508d422cca99cfca7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a453221b84d7f4ececaa0fa0fba0f546f"><td class="memItemLeft" align="right" valign="top"><a id="a453221b84d7f4ececaa0fa0fba0f546f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#a453221b84d7f4ececaa0fa0fba0f546f">set_description</a> ()</td></tr>
<tr class="memdesc:a453221b84d7f4ececaa0fa0fba0f546f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates the description string based on the PDG code values for the initial and final particles. <br /></td></tr>
<tr class="separator:a453221b84d7f4ececaa0fa0fba0f546f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1472ba0b1d35156a380118c03bd9d4b0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#a1472ba0b1d35156a380118c03bd9d4b0">summed_xs_helper</a> (int <a class="el" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>, double KEa, double cos_theta_c_cm, std::vector&lt; double &gt; *level_xsecs, bool differential) const</td></tr>
<tr class="separator:a1472ba0b1d35156a380118c03bd9d4b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classmarley_1_1_reaction"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classmarley_1_1_reaction')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classmarley_1_1_reaction.html">marley::Reaction</a></td></tr>
<tr class="memitem:a50bce6655c58a4562ba371706f496995 inherit pro_methods_classmarley_1_1_reaction"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a50bce6655c58a4562ba371706f496995">two_two_scatter</a> (double KEa, double &amp;s, double &amp;Ec_cm, double &amp;pc_cm, double &amp;Ed_cm) const</td></tr>
<tr class="memdesc:a50bce6655c58a4562ba371706f496995 inherit pro_methods_classmarley_1_1_reaction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function that handles CM frame kinematics for the reaction.  <a href="classmarley_1_1_reaction.html#a50bce6655c58a4562ba371706f496995">More...</a><br /></td></tr>
<tr class="separator:a50bce6655c58a4562ba371706f496995 inherit pro_methods_classmarley_1_1_reaction"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ab7451769247d088c04c2960debbb9707"><td class="memItemLeft" align="right" valign="top"><a id="ab7451769247d088c04c2960debbb9707"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#ab7451769247d088c04c2960debbb9707">Af_</a></td></tr>
<tr class="memdesc:ab7451769247d088c04c2960debbb9707"><td class="mdescLeft">&#160;</td><td class="mdescRight">Residue mass number. <br /></td></tr>
<tr class="separator:ab7451769247d088c04c2960debbb9707"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a048d76a0028eba8e41bdbd2e2191c8ac"><td class="memItemLeft" align="right" valign="top"><a id="a048d76a0028eba8e41bdbd2e2191c8ac"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#a048d76a0028eba8e41bdbd2e2191c8ac">Ai_</a></td></tr>
<tr class="memdesc:a048d76a0028eba8e41bdbd2e2191c8ac"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classmarley_1_1_target.html" title="Description of a macroscopic target for scattering reactions.">Target</a> mass number. <br /></td></tr>
<tr class="separator:a048d76a0028eba8e41bdbd2e2191c8ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec8370ba5a86926bfcc596278b2dba9d"><td class="memItemLeft" align="right" valign="top"><a id="aec8370ba5a86926bfcc596278b2dba9d"></a>
<a class="el" href="classmarley_1_1_nuclear_reaction.html#ac5f7ef6b49c0f776b5fe042d13de497e">CoulombMode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#aec8370ba5a86926bfcc596278b2dba9d">coulomb_mode_</a> = CoulombMode::FERMI_AND_MEMA</td></tr>
<tr class="memdesc:aec8370ba5a86926bfcc596278b2dba9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The method to use when computing Coulomb corrections (if needed) for this reaction. <br /></td></tr>
<tr class="separator:aec8370ba5a86926bfcc596278b2dba9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac490194708769c6cbea8d3667205b5f4"><td class="memItemLeft" align="right" valign="top"><a id="ac490194708769c6cbea8d3667205b5f4"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#ac490194708769c6cbea8d3667205b5f4">KEa_threshold_</a></td></tr>
<tr class="memdesc:ac490194708769c6cbea8d3667205b5f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lab-frame kinetic energy of the projectile at threshold for this reaction (i.e., the residue is produced in its ground state, and all final-state particles are at rest in the CM frame) <br /></td></tr>
<tr class="separator:ac490194708769c6cbea8d3667205b5f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeada84bbffeacc79cd256b79348767e5"><td class="memItemLeft" align="right" valign="top"><a id="aeada84bbffeacc79cd256b79348767e5"></a>
std::shared_ptr&lt; std::vector&lt; <a class="el" href="classmarley_1_1_matrix_element.html">marley::MatrixElement</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#aeada84bbffeacc79cd256b79348767e5">matrix_elements_</a></td></tr>
<tr class="memdesc:aeada84bbffeacc79cd256b79348767e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Matrix elements representing all of the possible nuclear transitions that may be caused by this reaction. <br /></td></tr>
<tr class="separator:aeada84bbffeacc79cd256b79348767e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad93300e94630b62181178acc327d0347"><td class="memItemLeft" align="right" valign="top"><a id="ad93300e94630b62181178acc327d0347"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#ad93300e94630b62181178acc327d0347">md_gs_</a></td></tr>
<tr class="memdesc:ad93300e94630b62181178acc327d0347"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ground state mass (MeV) of the residue. <br /></td></tr>
<tr class="separator:ad93300e94630b62181178acc327d0347"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c0ffa926819381aa936f1db38d8f5d2"><td class="memItemLeft" align="right" valign="top"><a id="a8c0ffa926819381aa936f1db38d8f5d2"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#a8c0ffa926819381aa936f1db38d8f5d2">q_d_</a></td></tr>
<tr class="memdesc:a8c0ffa926819381aa936f1db38d8f5d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Net charge of the residue (in units of the proton charge) following this reaction. <br /></td></tr>
<tr class="separator:a8c0ffa926819381aa936f1db38d8f5d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7620e5bedebacd302946f74d7bbc93c"><td class="memItemLeft" align="right" valign="top"><a id="ad7620e5bedebacd302946f74d7bbc93c"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#ad7620e5bedebacd302946f74d7bbc93c">Zf_</a></td></tr>
<tr class="memdesc:ad7620e5bedebacd302946f74d7bbc93c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Residue atomic number. <br /></td></tr>
<tr class="separator:ad7620e5bedebacd302946f74d7bbc93c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0e49941e652268c0a4396eb92620a24"><td class="memItemLeft" align="right" valign="top"><a id="ab0e49941e652268c0a4396eb92620a24"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#ab0e49941e652268c0a4396eb92620a24">Zi_</a></td></tr>
<tr class="memdesc:ab0e49941e652268c0a4396eb92620a24"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classmarley_1_1_target.html" title="Description of a macroscopic target for scattering reactions.">Target</a> atomic number. <br /></td></tr>
<tr class="separator:ab0e49941e652268c0a4396eb92620a24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classmarley_1_1_reaction"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classmarley_1_1_reaction')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classmarley_1_1_reaction.html">marley::Reaction</a></td></tr>
<tr class="memitem:a97c71055252e92db26c160c6c1fd9c2c inherit pro_attribs_classmarley_1_1_reaction"><td class="memItemLeft" align="right" valign="top"><a id="a97c71055252e92db26c160c6c1fd9c2c"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a97c71055252e92db26c160c6c1fd9c2c">description_</a></td></tr>
<tr class="memdesc:a97c71055252e92db26c160c6c1fd9c2c inherit pro_attribs_classmarley_1_1_reaction"><td class="mdescLeft">&#160;</td><td class="mdescRight">String that contains a formula describing the reaction. <br /></td></tr>
<tr class="separator:a97c71055252e92db26c160c6c1fd9c2c inherit pro_attribs_classmarley_1_1_reaction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea3c67ae0b64f048b0e728900200f96c inherit pro_attribs_classmarley_1_1_reaction"><td class="memItemLeft" align="right" valign="top"><a id="aea3c67ae0b64f048b0e728900200f96c"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#aea3c67ae0b64f048b0e728900200f96c">ma_</a></td></tr>
<tr class="memdesc:aea3c67ae0b64f048b0e728900200f96c inherit pro_attribs_classmarley_1_1_reaction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Projectile mass (MeV) <br /></td></tr>
<tr class="separator:aea3c67ae0b64f048b0e728900200f96c inherit pro_attribs_classmarley_1_1_reaction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3c38e0a9e08525685a2ee8de212d17a inherit pro_attribs_classmarley_1_1_reaction"><td class="memItemLeft" align="right" valign="top"><a id="af3c38e0a9e08525685a2ee8de212d17a"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#af3c38e0a9e08525685a2ee8de212d17a">mb_</a></td></tr>
<tr class="memdesc:af3c38e0a9e08525685a2ee8de212d17a inherit pro_attribs_classmarley_1_1_reaction"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classmarley_1_1_target.html" title="Description of a macroscopic target for scattering reactions.">Target</a> mass (MeV) <br /></td></tr>
<tr class="separator:af3c38e0a9e08525685a2ee8de212d17a inherit pro_attribs_classmarley_1_1_reaction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a383a684d06e3ca1e791394b95a758fe4 inherit pro_attribs_classmarley_1_1_reaction"><td class="memItemLeft" align="right" valign="top"><a id="a383a684d06e3ca1e791394b95a758fe4"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a></td></tr>
<tr class="memdesc:a383a684d06e3ca1e791394b95a758fe4 inherit pro_attribs_classmarley_1_1_reaction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ejectile mass (MeV) <br /></td></tr>
<tr class="separator:a383a684d06e3ca1e791394b95a758fe4 inherit pro_attribs_classmarley_1_1_reaction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a253c917efbb94aefe65806d9343a81 inherit pro_attribs_classmarley_1_1_reaction"><td class="memItemLeft" align="right" valign="top"><a id="a2a253c917efbb94aefe65806d9343a81"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a2a253c917efbb94aefe65806d9343a81">md_</a></td></tr>
<tr class="memdesc:a2a253c917efbb94aefe65806d9343a81 inherit pro_attribs_classmarley_1_1_reaction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Residue mass (MeV) <br /></td></tr>
<tr class="separator:a2a253c917efbb94aefe65806d9343a81 inherit pro_attribs_classmarley_1_1_reaction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a217a810b93dd6da809a91080973d19f0 inherit pro_attribs_classmarley_1_1_reaction"><td class="memItemLeft" align="right" valign="top"><a id="a217a810b93dd6da809a91080973d19f0"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a217a810b93dd6da809a91080973d19f0">pdg_a_</a></td></tr>
<tr class="memdesc:a217a810b93dd6da809a91080973d19f0 inherit pro_attribs_classmarley_1_1_reaction"><td class="mdescLeft">&#160;</td><td class="mdescRight">PDG code for the projectile. <br /></td></tr>
<tr class="separator:a217a810b93dd6da809a91080973d19f0 inherit pro_attribs_classmarley_1_1_reaction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad51f858109e8e7735716448ad0911dd4 inherit pro_attribs_classmarley_1_1_reaction"><td class="memItemLeft" align="right" valign="top"><a id="ad51f858109e8e7735716448ad0911dd4"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#ad51f858109e8e7735716448ad0911dd4">pdg_b_</a></td></tr>
<tr class="memdesc:ad51f858109e8e7735716448ad0911dd4 inherit pro_attribs_classmarley_1_1_reaction"><td class="mdescLeft">&#160;</td><td class="mdescRight">PDG code for the target. <br /></td></tr>
<tr class="separator:ad51f858109e8e7735716448ad0911dd4 inherit pro_attribs_classmarley_1_1_reaction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4c4e6a8c68c0927059b85d27643a3ed inherit pro_attribs_classmarley_1_1_reaction"><td class="memItemLeft" align="right" valign="top"><a id="aa4c4e6a8c68c0927059b85d27643a3ed"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#aa4c4e6a8c68c0927059b85d27643a3ed">pdg_c_</a></td></tr>
<tr class="memdesc:aa4c4e6a8c68c0927059b85d27643a3ed inherit pro_attribs_classmarley_1_1_reaction"><td class="mdescLeft">&#160;</td><td class="mdescRight">PDG code for the ejectile. <br /></td></tr>
<tr class="separator:aa4c4e6a8c68c0927059b85d27643a3ed inherit pro_attribs_classmarley_1_1_reaction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab47c4d8a6efbb9082f4c67c2f359b19f inherit pro_attribs_classmarley_1_1_reaction"><td class="memItemLeft" align="right" valign="top"><a id="ab47c4d8a6efbb9082f4c67c2f359b19f"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#ab47c4d8a6efbb9082f4c67c2f359b19f">pdg_d_</a></td></tr>
<tr class="memdesc:ab47c4d8a6efbb9082f4c67c2f359b19f inherit pro_attribs_classmarley_1_1_reaction"><td class="mdescLeft">&#160;</td><td class="mdescRight">PDG code for the residue. <br /></td></tr>
<tr class="separator:ab47c4d8a6efbb9082f4c67c2f359b19f inherit pro_attribs_classmarley_1_1_reaction"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a8dc9e8b628960659b50fedc27c374a inherit pro_attribs_classmarley_1_1_reaction"><td class="memItemLeft" align="right" valign="top"><a id="a2a8dc9e8b628960659b50fedc27c374a"></a>
<a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">ProcessType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a2a8dc9e8b628960659b50fedc27c374a">process_type_</a></td></tr>
<tr class="memdesc:a2a8dc9e8b628960659b50fedc27c374a inherit pro_attribs_classmarley_1_1_reaction"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type of scattering process (CC, NC) represented by this reaction. <br /></td></tr>
<tr class="separator:a2a8dc9e8b628960659b50fedc27c374a inherit pro_attribs_classmarley_1_1_reaction"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr class="memitem:ae4aa5daec78d552aa2ebbbb74e25fe2b"><td class="memItemLeft" align="right" valign="top">static std::map&lt; <a class="el" href="classmarley_1_1_nuclear_reaction.html#ac5f7ef6b49c0f776b5fe042d13de497e">CoulombMode</a>, std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_nuclear_reaction.html#ae4aa5daec78d552aa2ebbbb74e25fe2b">coulomb_mode_string_map_</a></td></tr>
<tr class="separator:ae4aa5daec78d552aa2ebbbb74e25fe2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_static_methods_classmarley_1_1_reaction"><td colspan="2" onclick="javascript:toggleInherit('pro_static_methods_classmarley_1_1_reaction')"><img src="closed.png" alt="-"/>&#160;Static Protected Member Functions inherited from <a class="el" href="classmarley_1_1_reaction.html">marley::Reaction</a></td></tr>
<tr class="memitem:a87bdda83e5218efd9dbf9312e66ce8fe inherit pro_static_methods_classmarley_1_1_reaction"><td class="memItemLeft" align="right" valign="top">static const std::vector&lt; int &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarley_1_1_reaction.html#a87bdda83e5218efd9dbf9312e66ce8fe">get_projectiles</a> (<a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">ProcessType</a> proc_type)</td></tr>
<tr class="separator:a87bdda83e5218efd9dbf9312e66ce8fe inherit pro_static_methods_classmarley_1_1_reaction"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A neutrino-nucleus reaction. </p>

<p class="definition">Definition at line <a class="el" href="_nuclear_reaction_8hh_source.html#l00038">38</a> of file <a class="el" href="_nuclear_reaction_8hh_source.html">NuclearReaction.hh</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a70d468e83ba5f02a0802c4dbcd070eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70d468e83ba5f02a0802c4dbcd070eae">&#9670;&nbsp;</a></span>NuclearReaction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">marley::NuclearReaction::NuclearReaction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmarley_1_1_reaction.html#a6a9981b171ef4c1f5f6a652e6a6e3d94">ProcessType</a>&#160;</td>
          <td class="paramname"><em>pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pdg_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pdg_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pdg_c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pdg_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>q_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; std::vector&lt; <a class="el" href="classmarley_1_1_matrix_element.html">marley::MatrixElement</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>mat_els</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pt</td><td>Type of scattering process represented by this <a class="el" href="classmarley_1_1_reaction.html" title="Abstract base class that represents a two-two scattering reaction.">Reaction</a> </td></tr>
    <tr><td class="paramname">pdg_a</td><td>Projectile PDG code </td></tr>
    <tr><td class="paramname">pdg_b</td><td><a class="el" href="classmarley_1_1_target.html" title="Description of a macroscopic target for scattering reactions.">Target</a> PDG code </td></tr>
    <tr><td class="paramname">pdg_c</td><td>Ejectile PDG code </td></tr>
    <tr><td class="paramname">pdg_d</td><td>Residue PDG code </td></tr>
    <tr><td class="paramname">q_d</td><td>Charge of the residue after the prompt 2-&gt;2 scatter represented by this <a class="el" href="classmarley_1_1_nuclear_reaction.html" title="A neutrino-nucleus reaction.">NuclearReaction</a> object </td></tr>
    <tr><td class="paramname">mat_els</td><td>A vector of <a class="el" href="classmarley_1_1_matrix_element.html" title="A reduced nuclear matrix element that represents a transition caused by a neutrino-nucleus reaction.">MatrixElement</a> objects that should be used to compute cross sections for this <a class="el" href="classmarley_1_1_nuclear_reaction.html" title="A neutrino-nucleus reaction.">NuclearReaction</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_nuclear_reaction_8cc_source.html#l00065">65</a> of file <a class="el" href="_nuclear_reaction_8cc_source.html">NuclearReaction.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  : <a class="code" href="classmarley_1_1_nuclear_reaction.html#a8c0ffa926819381aa936f1db38d8f5d2">q_d_</a>( q_d ), <a class="code" href="classmarley_1_1_nuclear_reaction.html#aeada84bbffeacc79cd256b79348767e5">matrix_elements_</a>( mat_els )</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;{</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">// Initialize the process type (NC, neutrino/antineutrino CC)</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="classmarley_1_1_reaction.html#a2a8dc9e8b628960659b50fedc27c374a">process_type_</a> = pt;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">// Initialize the PDG codes for the 2-&gt;2 scatter particles</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="classmarley_1_1_reaction.html#a217a810b93dd6da809a91080973d19f0">pdg_a_</a> = <a class="code" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="classmarley_1_1_reaction.html#ad51f858109e8e7735716448ad0911dd4">pdg_b_</a> = <a class="code" href="classmarley_1_1_reaction.html#af17d5a00782f0401f101f1a8c99b499a">pdg_b</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="classmarley_1_1_reaction.html#aa4c4e6a8c68c0927059b85d27643a3ed">pdg_c_</a> = pdg_c;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <a class="code" href="classmarley_1_1_reaction.html#ab47c4d8a6efbb9082f4c67c2f359b19f">pdg_d_</a> = pdg_d;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">// Get initial and final values of the nuclear charge and mass number from</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">// the PDG codes</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <a class="code" href="classmarley_1_1_nuclear_reaction.html#ab0e49941e652268c0a4396eb92620a24">Zi_</a> = (<a class="code" href="classmarley_1_1_reaction.html#ad51f858109e8e7735716448ad0911dd4">pdg_b_</a> % 10000000) / 10000;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <a class="code" href="classmarley_1_1_nuclear_reaction.html#a048d76a0028eba8e41bdbd2e2191c8ac">Ai_</a> = (<a class="code" href="classmarley_1_1_reaction.html#ad51f858109e8e7735716448ad0911dd4">pdg_b_</a> % 10000) / 10;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="classmarley_1_1_nuclear_reaction.html#ad7620e5bedebacd302946f74d7bbc93c">Zf_</a> = (<a class="code" href="classmarley_1_1_reaction.html#ab47c4d8a6efbb9082f4c67c2f359b19f">pdg_d_</a> % 10000000) / 10000;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="code" href="classmarley_1_1_nuclear_reaction.html#ab7451769247d088c04c2960debbb9707">Af_</a> = (<a class="code" href="classmarley_1_1_reaction.html#ab47c4d8a6efbb9082f4c67c2f359b19f">pdg_d_</a> % 10000) / 10;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keyword">const</span> <a class="code" href="classmarley_1_1_mass_table.html">marley::MassTable</a>&amp; mt = <a class="code" href="classmarley_1_1_mass_table.html#a2e43b8ba549e31fc8c6b811656f69b94">marley::MassTable::Instance</a>();</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">// Get the particle masses from the mass table</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="classmarley_1_1_reaction.html#aea3c67ae0b64f048b0e728900200f96c">ma_</a> = mt.<a class="code" href="classmarley_1_1_mass_table.html#aa01d20dec4be5b289a6b17c16c851916">get_particle_mass</a>( <a class="code" href="classmarley_1_1_reaction.html#a217a810b93dd6da809a91080973d19f0">pdg_a_</a> );</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a> = mt.<a class="code" href="classmarley_1_1_mass_table.html#aa01d20dec4be5b289a6b17c16c851916">get_particle_mass</a>( <a class="code" href="classmarley_1_1_reaction.html#aa4c4e6a8c68c0927059b85d27643a3ed">pdg_c_</a> );</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">// If the target (particle b) or residue (particle d)</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="comment">// has a particle ID greater than 10^9, assume that it</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="comment">// is an atom rather than a bare nucleus</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="classmarley_1_1_reaction.html#ad51f858109e8e7735716448ad0911dd4">pdg_b_</a> &gt; 1000000000 ) <a class="code" href="classmarley_1_1_reaction.html#af3c38e0a9e08525685a2ee8de212d17a">mb_</a> = mt.<a class="code" href="classmarley_1_1_mass_table.html#a3ad072b1e576360f5898754077811267">get_atomic_mass</a>( <a class="code" href="classmarley_1_1_reaction.html#ad51f858109e8e7735716448ad0911dd4">pdg_b_</a> );</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordflow">else</span> <a class="code" href="classmarley_1_1_reaction.html#af3c38e0a9e08525685a2ee8de212d17a">mb_</a> = mt.<a class="code" href="classmarley_1_1_mass_table.html#aa01d20dec4be5b289a6b17c16c851916">get_particle_mass</a>( <a class="code" href="classmarley_1_1_reaction.html#ad51f858109e8e7735716448ad0911dd4">pdg_b_</a> );</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="classmarley_1_1_reaction.html#ab47c4d8a6efbb9082f4c67c2f359b19f">pdg_d_</a> &gt; 1000000000 ) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// If particle d is an atom and is ionized as a result of this reaction</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// (e.g., q_d_ != 0), then approximate its ground-state ionized mass by</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// subtracting the appropriate number of electron masses from its atomic</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">// (i.e., neutral) ground state mass.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="classmarley_1_1_nuclear_reaction.html#ad93300e94630b62181178acc327d0347">md_gs_</a> = mt.<a class="code" href="classmarley_1_1_mass_table.html#a3ad072b1e576360f5898754077811267">get_atomic_mass</a>(<a class="code" href="classmarley_1_1_reaction.html#ab47c4d8a6efbb9082f4c67c2f359b19f">pdg_d_</a>)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      - (<a class="code" href="classmarley_1_1_nuclear_reaction.html#a8c0ffa926819381aa936f1db38d8f5d2">q_d_</a> * mt.<a class="code" href="classmarley_1_1_mass_table.html#aa01d20dec4be5b289a6b17c16c851916">get_particle_mass</a>(marley_utils::ELECTRON));</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="classmarley_1_1_nuclear_reaction.html#ad93300e94630b62181178acc327d0347">md_gs_</a> = mt.<a class="code" href="classmarley_1_1_mass_table.html#aa01d20dec4be5b289a6b17c16c851916">get_particle_mass</a>(<a class="code" href="classmarley_1_1_reaction.html#ab47c4d8a6efbb9082f4c67c2f359b19f">pdg_d_</a>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="classmarley_1_1_nuclear_reaction.html#ac490194708769c6cbea8d3667205b5f4">KEa_threshold_</a> = (std::pow(<a class="code" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a> + <a class="code" href="classmarley_1_1_nuclear_reaction.html#ad93300e94630b62181178acc327d0347">md_gs_</a>, 2)</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    - std::pow(<a class="code" href="classmarley_1_1_reaction.html#aea3c67ae0b64f048b0e728900200f96c">ma_</a> + <a class="code" href="classmarley_1_1_reaction.html#af3c38e0a9e08525685a2ee8de212d17a">mb_</a>, 2))/(2.*<a class="code" href="classmarley_1_1_reaction.html#af3c38e0a9e08525685a2ee8de212d17a">mb_</a>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  this-&gt;<a class="code" href="classmarley_1_1_nuclear_reaction.html#a453221b84d7f4ececaa0fa0fba0f546f">set_description</a>();</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;}</div>
<div class="ttc" id="aclassmarley_1_1_mass_table_html"><div class="ttname"><a href="classmarley_1_1_mass_table.html">marley::MassTable</a></div><div class="ttdoc">Singleton lookup table for particle and atomic masses.</div><div class="ttdef"><b>Definition:</b> <a href="_mass_table_8hh_source.html#l00027">MassTable.hh:27</a></div></div>
<div class="ttc" id="aclassmarley_1_1_mass_table_html_a2e43b8ba549e31fc8c6b811656f69b94"><div class="ttname"><a href="classmarley_1_1_mass_table.html#a2e43b8ba549e31fc8c6b811656f69b94">marley::MassTable::Instance</a></div><div class="ttdeci">static const MassTable &amp; Instance()</div><div class="ttdoc">Get a const reference to the singleton instance of the MassTable.</div><div class="ttdef"><b>Definition:</b> <a href="_mass_table_8cc_source.html#l00068">MassTable.cc:68</a></div></div>
<div class="ttc" id="aclassmarley_1_1_mass_table_html_a3ad072b1e576360f5898754077811267"><div class="ttname"><a href="classmarley_1_1_mass_table.html#a3ad072b1e576360f5898754077811267">marley::MassTable::get_atomic_mass</a></div><div class="ttdeci">double get_atomic_mass(int pdg_code, bool theory_ok=true) const</div><div class="ttdoc">Get the mass of an atom.</div><div class="ttdef"><b>Definition:</b> <a href="_mass_table_8cc_source.html#l00094">MassTable.cc:94</a></div></div>
<div class="ttc" id="aclassmarley_1_1_mass_table_html_aa01d20dec4be5b289a6b17c16c851916"><div class="ttname"><a href="classmarley_1_1_mass_table.html#aa01d20dec4be5b289a6b17c16c851916">marley::MassTable::get_particle_mass</a></div><div class="ttdeci">double get_particle_mass(int pdg_code) const</div><div class="ttdoc">Get the mass of a particle.</div><div class="ttdef"><b>Definition:</b> <a href="_mass_table_8cc_source.html#l00083">MassTable.cc:83</a></div></div>
<div class="ttc" id="aclassmarley_1_1_nuclear_reaction_html_a048d76a0028eba8e41bdbd2e2191c8ac"><div class="ttname"><a href="classmarley_1_1_nuclear_reaction.html#a048d76a0028eba8e41bdbd2e2191c8ac">marley::NuclearReaction::Ai_</a></div><div class="ttdeci">int Ai_</div><div class="ttdoc">Target mass number.</div><div class="ttdef"><b>Definition:</b> <a href="_nuclear_reaction_8hh_source.html#l00224">NuclearReaction.hh:224</a></div></div>
<div class="ttc" id="aclassmarley_1_1_nuclear_reaction_html_a453221b84d7f4ececaa0fa0fba0f546f"><div class="ttname"><a href="classmarley_1_1_nuclear_reaction.html#a453221b84d7f4ececaa0fa0fba0f546f">marley::NuclearReaction::set_description</a></div><div class="ttdeci">void set_description()</div><div class="ttdoc">Creates the description string based on the PDG code values for the initial and final particles.</div><div class="ttdef"><b>Definition:</b> <a href="_nuclear_reaction_8cc_source.html#l00719">NuclearReaction.cc:719</a></div></div>
<div class="ttc" id="aclassmarley_1_1_nuclear_reaction_html_a8c0ffa926819381aa936f1db38d8f5d2"><div class="ttname"><a href="classmarley_1_1_nuclear_reaction.html#a8c0ffa926819381aa936f1db38d8f5d2">marley::NuclearReaction::q_d_</a></div><div class="ttdeci">int q_d_</div><div class="ttdoc">Net charge of the residue (in units of the proton charge) following this reaction.</div><div class="ttdef"><b>Definition:</b> <a href="_nuclear_reaction_8hh_source.html#l00230">NuclearReaction.hh:230</a></div></div>
<div class="ttc" id="aclassmarley_1_1_nuclear_reaction_html_ab0e49941e652268c0a4396eb92620a24"><div class="ttname"><a href="classmarley_1_1_nuclear_reaction.html#ab0e49941e652268c0a4396eb92620a24">marley::NuclearReaction::Zi_</a></div><div class="ttdeci">int Zi_</div><div class="ttdoc">Target atomic number.</div><div class="ttdef"><b>Definition:</b> <a href="_nuclear_reaction_8hh_source.html#l00223">NuclearReaction.hh:223</a></div></div>
<div class="ttc" id="aclassmarley_1_1_nuclear_reaction_html_ab7451769247d088c04c2960debbb9707"><div class="ttname"><a href="classmarley_1_1_nuclear_reaction.html#ab7451769247d088c04c2960debbb9707">marley::NuclearReaction::Af_</a></div><div class="ttdeci">int Af_</div><div class="ttdoc">Residue mass number.</div><div class="ttdef"><b>Definition:</b> <a href="_nuclear_reaction_8hh_source.html#l00226">NuclearReaction.hh:226</a></div></div>
<div class="ttc" id="aclassmarley_1_1_nuclear_reaction_html_ac490194708769c6cbea8d3667205b5f4"><div class="ttname"><a href="classmarley_1_1_nuclear_reaction.html#ac490194708769c6cbea8d3667205b5f4">marley::NuclearReaction::KEa_threshold_</a></div><div class="ttdeci">double KEa_threshold_</div><div class="ttdoc">Lab-frame kinetic energy of the projectile at threshold for this reaction (i.e., the residue is produ...</div><div class="ttdef"><b>Definition:</b> <a href="_nuclear_reaction_8hh_source.html#l00235">NuclearReaction.hh:235</a></div></div>
<div class="ttc" id="aclassmarley_1_1_nuclear_reaction_html_ad7620e5bedebacd302946f74d7bbc93c"><div class="ttname"><a href="classmarley_1_1_nuclear_reaction.html#ad7620e5bedebacd302946f74d7bbc93c">marley::NuclearReaction::Zf_</a></div><div class="ttdeci">int Zf_</div><div class="ttdoc">Residue atomic number.</div><div class="ttdef"><b>Definition:</b> <a href="_nuclear_reaction_8hh_source.html#l00225">NuclearReaction.hh:225</a></div></div>
<div class="ttc" id="aclassmarley_1_1_nuclear_reaction_html_ad93300e94630b62181178acc327d0347"><div class="ttname"><a href="classmarley_1_1_nuclear_reaction.html#ad93300e94630b62181178acc327d0347">marley::NuclearReaction::md_gs_</a></div><div class="ttdeci">double md_gs_</div><div class="ttdoc">Ground state mass (MeV) of the residue.</div><div class="ttdef"><b>Definition:</b> <a href="_nuclear_reaction_8hh_source.html#l00221">NuclearReaction.hh:221</a></div></div>
<div class="ttc" id="aclassmarley_1_1_nuclear_reaction_html_aeada84bbffeacc79cd256b79348767e5"><div class="ttname"><a href="classmarley_1_1_nuclear_reaction.html#aeada84bbffeacc79cd256b79348767e5">marley::NuclearReaction::matrix_elements_</a></div><div class="ttdeci">std::shared_ptr&lt; std::vector&lt; marley::MatrixElement &gt; &gt; matrix_elements_</div><div class="ttdoc">Matrix elements representing all of the possible nuclear transitions that may be caused by this react...</div><div class="ttdef"><b>Definition:</b> <a href="_nuclear_reaction_8hh_source.html#l00243">NuclearReaction.hh:243</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_a217a810b93dd6da809a91080973d19f0"><div class="ttname"><a href="classmarley_1_1_reaction.html#a217a810b93dd6da809a91080973d19f0">marley::Reaction::pdg_a_</a></div><div class="ttdeci">int pdg_a_</div><div class="ttdoc">PDG code for the projectile.</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00118">Reaction.hh:118</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_a2a8dc9e8b628960659b50fedc27c374a"><div class="ttname"><a href="classmarley_1_1_reaction.html#a2a8dc9e8b628960659b50fedc27c374a">marley::Reaction::process_type_</a></div><div class="ttdeci">ProcessType process_type_</div><div class="ttdoc">Type of scattering process (CC, NC) represented by this reaction.</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00137">Reaction.hh:137</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_a383a684d06e3ca1e791394b95a758fe4"><div class="ttname"><a href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">marley::Reaction::mc_</a></div><div class="ttdeci">double mc_</div><div class="ttdoc">Ejectile mass (MeV)</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00125">Reaction.hh:125</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_aa4c4e6a8c68c0927059b85d27643a3ed"><div class="ttname"><a href="classmarley_1_1_reaction.html#aa4c4e6a8c68c0927059b85d27643a3ed">marley::Reaction::pdg_c_</a></div><div class="ttdeci">int pdg_c_</div><div class="ttdoc">PDG code for the ejectile.</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00120">Reaction.hh:120</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_ab47c4d8a6efbb9082f4c67c2f359b19f"><div class="ttname"><a href="classmarley_1_1_reaction.html#ab47c4d8a6efbb9082f4c67c2f359b19f">marley::Reaction::pdg_d_</a></div><div class="ttdeci">int pdg_d_</div><div class="ttdoc">PDG code for the residue.</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00121">Reaction.hh:121</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_ad1aec5433c9da5813edc46e0cf545c05"><div class="ttname"><a href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">marley::Reaction::pdg_a</a></div><div class="ttdeci">int pdg_a() const</div><div class="ttdoc">Get the projectile PDG code.</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00090">Reaction.hh:90</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_ad51f858109e8e7735716448ad0911dd4"><div class="ttname"><a href="classmarley_1_1_reaction.html#ad51f858109e8e7735716448ad0911dd4">marley::Reaction::pdg_b_</a></div><div class="ttdeci">int pdg_b_</div><div class="ttdoc">PDG code for the target.</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00119">Reaction.hh:119</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_aea3c67ae0b64f048b0e728900200f96c"><div class="ttname"><a href="classmarley_1_1_reaction.html#aea3c67ae0b64f048b0e728900200f96c">marley::Reaction::ma_</a></div><div class="ttdeci">double ma_</div><div class="ttdoc">Projectile mass (MeV)</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00123">Reaction.hh:123</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_af17d5a00782f0401f101f1a8c99b499a"><div class="ttname"><a href="classmarley_1_1_reaction.html#af17d5a00782f0401f101f1a8c99b499a">marley::Reaction::pdg_b</a></div><div class="ttdeci">int pdg_b() const</div><div class="ttdoc">Get the target PDG code.</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00093">Reaction.hh:93</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_af3c38e0a9e08525685a2ee8de212d17a"><div class="ttname"><a href="classmarley_1_1_reaction.html#af3c38e0a9e08525685a2ee8de212d17a">marley::Reaction::mb_</a></div><div class="ttdeci">double mb_</div><div class="ttdoc">Target mass (MeV)</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00124">Reaction.hh:124</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_nuclear_reaction_8hh_source.html#l00226">Af_</a>, <a class="el" href="_nuclear_reaction_8hh_source.html#l00224">Ai_</a>, <a class="el" href="_mass_table_8cc_source.html#l00094">marley::MassTable::get_atomic_mass()</a>, <a class="el" href="_mass_table_8cc_source.html#l00083">marley::MassTable::get_particle_mass()</a>, <a class="el" href="_mass_table_8cc_source.html#l00068">marley::MassTable::Instance()</a>, <a class="el" href="_nuclear_reaction_8hh_source.html#l00235">KEa_threshold_</a>, <a class="el" href="_reaction_8hh_source.html#l00123">marley::Reaction::ma_</a>, <a class="el" href="_reaction_8hh_source.html#l00124">marley::Reaction::mb_</a>, <a class="el" href="_reaction_8hh_source.html#l00125">marley::Reaction::mc_</a>, <a class="el" href="_nuclear_reaction_8hh_source.html#l00221">md_gs_</a>, <a class="el" href="_reaction_8hh_source.html#l00090">marley::Reaction::pdg_a()</a>, <a class="el" href="_reaction_8hh_source.html#l00118">marley::Reaction::pdg_a_</a>, <a class="el" href="_reaction_8hh_source.html#l00093">marley::Reaction::pdg_b()</a>, <a class="el" href="_reaction_8hh_source.html#l00119">marley::Reaction::pdg_b_</a>, <a class="el" href="_reaction_8hh_source.html#l00120">marley::Reaction::pdg_c_</a>, <a class="el" href="_reaction_8hh_source.html#l00121">marley::Reaction::pdg_d_</a>, <a class="el" href="_reaction_8hh_source.html#l00137">marley::Reaction::process_type_</a>, <a class="el" href="_nuclear_reaction_8hh_source.html#l00230">q_d_</a>, <a class="el" href="_nuclear_reaction_8cc_source.html#l00719">set_description()</a>, <a class="el" href="_nuclear_reaction_8hh_source.html#l00225">Zf_</a>, and <a class="el" href="_nuclear_reaction_8hh_source.html#l00223">Zi_</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ab330fbfd0e09e564953d6741d7ebc3ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab330fbfd0e09e564953d6741d7ebc3ed">&#9670;&nbsp;</a></span>atomic_target()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classmarley_1_1_target_atom.html">marley::TargetAtom</a> marley::NuclearReaction::atomic_target </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">final</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the target atom involved in this reaction. </p>
<p>For nuclear reactions, this is identical to the pdg_b_ member variable. For electron reactions, it is distinct (since particle b is the initial struck electron). </p>

<p>Implements <a class="el" href="classmarley_1_1_reaction.html#a4d4a94d2fe17ba7d5cae2eaa75007dbe">marley::Reaction</a>.</p>

<p class="definition">Definition at line <a class="el" href="_nuclear_reaction_8hh_source.html#l00060">60</a> of file <a class="el" href="_nuclear_reaction_8hh_source.html">NuclearReaction.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        { <span class="keywordflow">return</span> <a class="code" href="classmarley_1_1_target_atom.html">marley::TargetAtom</a>( <a class="code" href="classmarley_1_1_reaction.html#ad51f858109e8e7735716448ad0911dd4">pdg_b_</a> ); }</div>
<div class="ttc" id="aclassmarley_1_1_target_atom_html"><div class="ttname"><a href="classmarley_1_1_target_atom.html">marley::TargetAtom</a></div><div class="ttdoc">An atomic target for a lepton scattering reaction.</div><div class="ttdef"><b>Definition:</b> <a href="_target_atom_8hh_source.html#l00026">TargetAtom.hh:26</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_reaction_8hh_source.html#l00119">marley::Reaction::pdg_b_</a>.</p>

</div>
</div>
<a id="a03501d3d61096e890cb3d5ae07b7bce1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03501d3d61096e890cb3d5ae07b7bce1">&#9670;&nbsp;</a></span>coulomb_correction_factor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double marley::NuclearReaction::coulomb_correction_factor </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta_rel_cd</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes an approximate correction factor to account for effects of the Coulomb potential when calculating cross sections </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">beta_rel_cd</td><td>The relative speed of the final particles c and d (dimensionless) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_nuclear_reaction_8cc_source.html#l00592">592</a> of file <a class="el" href="_nuclear_reaction_8cc_source.html">NuclearReaction.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;{</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="comment">// Don&#39;t do anything if Coulomb corrections are switched off</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="classmarley_1_1_nuclear_reaction.html#aec8370ba5a86926bfcc596278b2dba9d">coulomb_mode_</a> == CoulombMode::NO_CORRECTION ) <span class="keywordflow">return</span> 1.;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="comment">// Fermi function approach to the Coulomb correction</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keywordtype">double</span> fermi_func = <a class="code" href="classmarley_1_1_nuclear_reaction.html#ad1316c7149a70dae8313bd132a2a831e">fermi_function</a>( beta_rel_cd );</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="comment">// Unconditionally return the value of the Fermi function if the user</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="comment">// has configured things this way</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="classmarley_1_1_nuclear_reaction.html#aec8370ba5a86926bfcc596278b2dba9d">coulomb_mode_</a> == CoulombMode::FERMI_FUNCTION ) <span class="keywordflow">return</span> fermi_func;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="keywordtype">bool</span> use_mema = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="classmarley_1_1_nuclear_reaction.html#aec8370ba5a86926bfcc596278b2dba9d">coulomb_mode_</a> == CoulombMode::MEMA</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    || <a class="code" href="classmarley_1_1_nuclear_reaction.html#aec8370ba5a86926bfcc596278b2dba9d">coulomb_mode_</a> == CoulombMode::FERMI_AND_MEMA )</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    use_mema = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="comment">// Effective momentum approximation for the Coulomb correction</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keywordtype">bool</span> EMA_ok = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="keywordtype">double</span> factor_EMA = <a class="code" href="classmarley_1_1_nuclear_reaction.html#aa98133012b9442da7fc1779d92d68a9e">ema_factor</a>( beta_rel_cd, EMA_ok, use_mema );</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="classmarley_1_1_nuclear_reaction.html#aec8370ba5a86926bfcc596278b2dba9d">coulomb_mode_</a> == CoulombMode::EMA || <a class="code" href="classmarley_1_1_nuclear_reaction.html#aec8370ba5a86926bfcc596278b2dba9d">coulomb_mode_</a> == CoulombMode::MEMA ) {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">if</span> ( EMA_ok ) <span class="keywordflow">return</span> factor_EMA;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      std::string model_name( <span class="stringliteral">&quot;EMA&quot;</span> );</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="keywordflow">if</span> ( <a class="code" href="classmarley_1_1_nuclear_reaction.html#aec8370ba5a86926bfcc596278b2dba9d">coulomb_mode_</a> == CoulombMode::MEMA ) model_name = <span class="stringliteral">&quot;MEMA&quot;</span>;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="keywordflow">throw</span> <a class="code" href="classmarley_1_1_error.html">marley::Error</a>( <span class="stringliteral">&quot;Invalid &quot;</span> + model_name + <span class="stringliteral">&quot; factor encountered&quot;</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="stringliteral">&quot; in marley::NuclearReaction::coulomb_correction_factor()&quot;</span> );</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="classmarley_1_1_nuclear_reaction.html#aec8370ba5a86926bfcc596278b2dba9d">coulomb_mode_</a> != CoulombMode::FERMI_AND_EMA</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    &amp;&amp; <a class="code" href="classmarley_1_1_nuclear_reaction.html#aec8370ba5a86926bfcc596278b2dba9d">coulomb_mode_</a> != CoulombMode::FERMI_AND_MEMA )</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classmarley_1_1_error.html">marley::Error</a>( <span class="stringliteral">&quot;Unrecognized Coulomb correction mode encountered&quot;</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="stringliteral">&quot; in marley::NuclearReaction::coulomb_correction_factor()&quot;</span> );</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="comment">// If we&#39;ve gotten this far, then we&#39;re interpolating between the Fermi</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="comment">// function and the (M)EMA correction factor. If the (modified) effective</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="comment">// momentum approximation is invalid because subtracting off the Coulomb</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="comment">// potential brings the reaction below threshold, then just use the Fermi</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <span class="comment">// function</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <span class="keywordflow">if</span> ( !EMA_ok ) <span class="keywordflow">return</span> fermi_func;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="comment">// Otherwise, choose the approach that yields the smaller correction (i.e., the</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="comment">// correction factor that is closest to unity).</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="keywordtype">double</span> diff_Fermi = std::abs( fermi_func - 1. );</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="keywordtype">double</span> diff_EMA = std::abs( factor_EMA - 1. );</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="keywordflow">if</span> ( diff_Fermi &lt; diff_EMA ) <span class="keywordflow">return</span> fermi_func;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">return</span> factor_EMA;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;}</div>
<div class="ttc" id="aclassmarley_1_1_error_html"><div class="ttname"><a href="classmarley_1_1_error.html">marley::Error</a></div><div class="ttdoc">Base class for all exceptions thrown by MARLEY functions.</div><div class="ttdef"><b>Definition:</b> <a href="_error_8hh_source.html#l00032">Error.hh:32</a></div></div>
<div class="ttc" id="aclassmarley_1_1_nuclear_reaction_html_aa98133012b9442da7fc1779d92d68a9e"><div class="ttname"><a href="classmarley_1_1_nuclear_reaction.html#aa98133012b9442da7fc1779d92d68a9e">marley::NuclearReaction::ema_factor</a></div><div class="ttdeci">double ema_factor(double beta_rel_cd, bool &amp;ok, bool modified_ema) const</div><div class="ttdef"><b>Definition:</b> <a href="_nuclear_reaction_8cc_source.html#l00650">NuclearReaction.cc:650</a></div></div>
<div class="ttc" id="aclassmarley_1_1_nuclear_reaction_html_ad1316c7149a70dae8313bd132a2a831e"><div class="ttname"><a href="classmarley_1_1_nuclear_reaction.html#ad1316c7149a70dae8313bd132a2a831e">marley::NuclearReaction::fermi_function</a></div><div class="ttdeci">double fermi_function(double beta_c) const</div><div class="ttdoc">Compute the Fermi function</div><div class="ttdef"><b>Definition:</b> <a href="_nuclear_reaction_8cc_source.html#l00122">NuclearReaction.cc:122</a></div></div>
<div class="ttc" id="aclassmarley_1_1_nuclear_reaction_html_aec8370ba5a86926bfcc596278b2dba9d"><div class="ttname"><a href="classmarley_1_1_nuclear_reaction.html#aec8370ba5a86926bfcc596278b2dba9d">marley::NuclearReaction::coulomb_mode_</a></div><div class="ttdeci">CoulombMode coulomb_mode_</div><div class="ttdoc">The method to use when computing Coulomb corrections (if needed) for this reaction.</div><div class="ttdef"><b>Definition:</b> <a href="_nuclear_reaction_8hh_source.html#l00239">NuclearReaction.hh:239</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4510f83ed0beff3a27ebe64d0e03097f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4510f83ed0beff3a27ebe64d0e03097f">&#9670;&nbsp;</a></span>coulomb_mode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmarley_1_1_nuclear_reaction.html#ac5f7ef6b49c0f776b5fe042d13de497e">CoulombMode</a> marley::NuclearReaction::coulomb_mode </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return the method used by this reaction for handling Coulomb corrections </p>

<p class="definition">Definition at line <a class="el" href="_nuclear_reaction_8hh_source.html#l00163">163</a> of file <a class="el" href="_nuclear_reaction_8hh_source.html">NuclearReaction.hh</a>.</p>
<div class="fragment"><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        { <span class="keywordflow">return</span> <a class="code" href="classmarley_1_1_nuclear_reaction.html#aec8370ba5a86926bfcc596278b2dba9d">coulomb_mode_</a>; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_nuclear_reaction_8hh_source.html#l00239">coulomb_mode_</a>.</p>

</div>
</div>
<a id="a8ab5c74e0daf4bb7cb47428e2273002a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ab5c74e0daf4bb7cb47428e2273002a">&#9670;&nbsp;</a></span>create_event()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmarley_1_1_event.html">marley::Event</a> marley::NuclearReaction::create_event </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>particle_id_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>KEa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmarley_1_1_generator.html">marley::Generator</a> &amp;&#160;</td>
          <td class="paramname"><em>gen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Produces a two-two scattering <a class="el" href="classmarley_1_1_event.html" title="Container for ingoing and outgoing momentum 4-vectors from a reaction.">Event</a> that proceeds via this reaction. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000018">Todo:</a></b></dt><dd>Add more error checks to <a class="el" href="classmarley_1_1_nuclear_reaction.html#a8ab5c74e0daf4bb7cb47428e2273002a" title="Produces a two-two scattering Event that proceeds via this reaction.">NuclearReaction::create_event</a> as necessary </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000019">Todo:</a></b></dt><dd>Revisit the equipartition assumption made here in favor of something better motivated. </dd></dl>

<p>Implements <a class="el" href="classmarley_1_1_reaction.html#ad15a7744bba9ec5f6f86da7bf73e6c10">marley::Reaction</a>.</p>

<p class="definition">Definition at line <a class="el" href="_nuclear_reaction_8cc_source.html#l00175">175</a> of file <a class="el" href="_nuclear_reaction_8cc_source.html">NuclearReaction.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;{</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">// Check that the projectile supplied to this event is correct. If not, alert</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">// the user that this event does not use the requested projectile.</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a> != <a class="code" href="classmarley_1_1_reaction.html#a217a810b93dd6da809a91080973d19f0">pdg_a_</a> ) <span class="keywordflow">throw</span> <a class="code" href="classmarley_1_1_error.html">marley::Error</a>(std::string(<span class="stringliteral">&quot;Could&quot;</span>)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    + <span class="stringliteral">&quot; not create this event. The requested projectile particle ID, &quot;</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    + std::to_string(<a class="code" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>) + <span class="stringliteral">&quot;, does not match the projectile&quot;</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    + <span class="stringliteral">&quot; particle ID, &quot;</span> + std::to_string(<a class="code" href="classmarley_1_1_reaction.html#a217a810b93dd6da809a91080973d19f0">pdg_a_</a>) + <span class="stringliteral">&quot;, in the reaction dataset.&quot;</span>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="comment">// Sample a final residue energy level. First, check to make sure the given</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="comment">// projectile energy is above threshold for this reaction.</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">if</span> ( KEa &lt; <a class="code" href="classmarley_1_1_nuclear_reaction.html#ac490194708769c6cbea8d3667205b5f4">KEa_threshold_</a> ) <span class="keywordflow">throw</span> std::range_error(std::string(<span class="stringliteral">&quot;Could&quot;</span>)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    + <span class="stringliteral">&quot; not create this event. Projectile kinetic energy &quot;</span> + std::to_string(KEa)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    + <span class="stringliteral">&quot; MeV is below the threshold value &quot;</span> + std::to_string(<a class="code" href="classmarley_1_1_nuclear_reaction.html#ac490194708769c6cbea8d3667205b5f4">KEa_threshold_</a>)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    + <span class="stringliteral">&quot; MeV.&quot;</span>);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="comment">// Create an empty vector of sampling weights (partial total cross</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">// sections to each kinematically accessible final level)</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  std::vector&lt;double&gt; level_weights;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">// Create a discrete distribution object for level sampling.</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="comment">// Its default constructor creates a single weight of 1.</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="comment">// We will always explicitly give it weights to use when sampling</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">// levels, so we won&#39;t worry about its default behavior.</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keyword">static</span> std::discrete_distribution&lt;size_t&gt; ldist;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">// Compute the total cross section for a transition to each individual nuclear</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">// level, and save the results in the level_weights vector (which will be</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">// cleared by summed_xs_helper() before being loaded with the cross sections).</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="comment">// The summed_xs_helper() method can also be used for differential</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="comment">// (d\sigma/d\cos\theta_c^{CM}) cross sections, so supply a dummy cos_theta_c_cm</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="comment">// value and request total cross sections by setting the last argument to false.</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordtype">double</span> dummy = 0.;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordtype">double</span> sum_of_xsecs = <a class="code" href="classmarley_1_1_nuclear_reaction.html#a1472ba0b1d35156a380118c03bd9d4b0">summed_xs_helper</a>(<a class="code" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>, KEa, dummy,</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    &amp;level_weights, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">// Note that the elements in matrix_elements_ are given in order of</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">// increasing excitation energy (this is currently enforced by the reaction</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="comment">// data format and is checked during parsing). This ensures that we can</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="comment">// sample a matrix element index from level_weights (which is populated in</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="comment">// the same order by summed_xs_helper()) and have it refer to the correct</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">// object.</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">// Complain if none of the levels we have data for are kinematically allowed</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordflow">if</span> ( level_weights.empty() ) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classmarley_1_1_error.html">marley::Error</a>(<span class="stringliteral">&quot;Could not create this event. The DecayScheme object&quot;</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="stringliteral">&quot; associated with this reaction does not contain data for any&quot;</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="stringliteral">&quot; kinematically accessible levels for a projectile kinetic energy of &quot;</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      + std::to_string(KEa) + <span class="stringliteral">&quot; MeV (max E_level = &quot;</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      + std::to_string( <a class="code" href="classmarley_1_1_nuclear_reaction.html#a52f4df6ace8f63efe262829424c52605">max_level_energy</a>(KEa) ) + <span class="stringliteral">&quot; MeV).&quot;</span>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">// Complain if the total cross section (the sum of all partial level cross</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="comment">// sections) is zero or negative (the latter is just to cover all possibilities).</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordflow">if</span> ( sum_of_xsecs &lt;= 0. ) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classmarley_1_1_error.html">marley::Error</a>(<span class="stringliteral">&quot;Could not create this event. All kinematically&quot;</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="stringliteral">&quot; accessible levels for a projectile kinetic energy of &quot;</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      + std::to_string(KEa) + <span class="stringliteral">&quot; MeV (max E_level = &quot;</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      + std::to_string( <a class="code" href="classmarley_1_1_nuclear_reaction.html#a52f4df6ace8f63efe262829424c52605">max_level_energy</a>(KEa) )</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      + <span class="stringliteral">&quot; MeV) have vanishing matrix elements.&quot;</span>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">// Create a list of parameters used to supply the weights to our discrete</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="comment">// level sampling distribution</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  std::discrete_distribution&lt;size_t&gt;::param_type params( level_weights.begin(),</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    level_weights.end() );</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">// Sample a matrix_element using our discrete distribution and the</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">// current set of weights</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordtype">size_t</span> me_index = gen.<a class="code" href="classmarley_1_1_generator.html#aa6f49482bbeca2b3eda7d3697b1b24ae">sample_from_distribution</a>( ldist, params );</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; sampled_matrix_el = <a class="code" href="classmarley_1_1_nuclear_reaction.html#aeada84bbffeacc79cd256b79348767e5">matrix_elements_</a>-&gt;at( me_index );</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">// Get the energy of the selected level.</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordtype">double</span> E_level = sampled_matrix_el.level_energy();</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">// Update the residue mass based on its excitation energy for the current</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="comment">// event</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <a class="code" href="classmarley_1_1_reaction.html#a2a253c917efbb94aefe65806d9343a81">md_</a> = <a class="code" href="classmarley_1_1_nuclear_reaction.html#ad93300e94630b62181178acc327d0347">md_gs_</a> + E_level;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="comment">// Compute Mandelstam s, the ejectile&#39;s CM frame total energy, the magnitude</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="comment">// of the ejectile&#39;s CM frame 3-momentum, and the residue&#39;s CM frame total</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="comment">// energy.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordtype">double</span> s, Ec_cm, pc_cm, Ed_cm;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <a class="code" href="classmarley_1_1_reaction.html#a50bce6655c58a4562ba371706f496995">two_two_scatter</a>( KEa, s, Ec_cm, pc_cm, Ed_cm );</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="comment">// Determine the CM frame velocity of the ejectile</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keywordtype">double</span> beta_c_cm = pc_cm / Ec_cm;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="comment">// Sample a CM frame scattering cosine for the ejectile.</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordtype">double</span> cos_theta_c_cm = <a class="code" href="classmarley_1_1_nuclear_reaction.html#a086090d9744add7508d422cca99cfca7">sample_cos_theta_c_cm</a>( sampled_matrix_el,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    beta_c_cm, gen );</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="comment">// Sample a CM frame azimuthal scattering angle (phi) uniformly on [0, 2*pi).</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="comment">// We can do this because the matrix elements are azimuthally invariant</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordtype">double</span> phi_c_cm = gen.<a class="code" href="classmarley_1_1_generator.html#a0f589845050dad9b4640ab25750db4ca">uniform_random_double</a>( 0.,</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    marley_utils::two_pi, <span class="keyword">false</span> );</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">// Load the initial residue twoJ and parity values into twoJ and P. These</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">// variables are included in the event record and used by NucleusDecayer</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="comment">// to start the Hauser-Feshbach decay cascade.</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keywordtype">int</span> twoJ = BOGUS_TWO_J_VALUE;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <a class="code" href="classmarley_1_1_parity.html">marley::Parity</a> P; <span class="comment">// defaults to positive parity</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">// Get access to the nuclear structure database owned by the Generator</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keyword">auto</span>&amp; sdb = gen.<a class="code" href="classmarley_1_1_generator.html#a23a6a31e0d132f1627ea4683904f0860">get_structure_db</a>();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="comment">// Retrieve the ground-state spin-parity of the initial nucleus</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordtype">int</span> twoJ_gs;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <a class="code" href="classmarley_1_1_parity.html">marley::Parity</a> P_gs;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  sdb.get_gs_spin_parity( <a class="code" href="classmarley_1_1_reaction.html#ad51f858109e8e7735716448ad0911dd4">pdg_b_</a>, twoJ_gs, P_gs );</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="comment">// For transitions to discrete nuclear levels, all we need to do is retrieve</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="comment">// these values directly from the Level object</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keyword">const</span> <a class="code" href="classmarley_1_1_level.html">marley::Level</a>* final_lev = sampled_matrix_el.level();</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keywordflow">if</span> ( final_lev ) {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    twoJ = final_lev-&gt;<a class="code" href="classmarley_1_1_level.html#ad364d18ab3329db9e31f9b57ef42f05d">twoJ</a>();</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    P = final_lev-&gt;<a class="code" href="classmarley_1_1_level.html#aad47add697e6ee7ad136b05e487068bc">parity</a>();</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="comment">// For transitions to the continuum, we rely on the spin-parity selection</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="comment">// rules to determine suitable values of twoJ and P. In cases where more than</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="comment">// one value is allowed, assume equipartition, and sample a spin-parity based</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="comment">// on the relative nuclear level densities at the excitation energy of</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="comment">// interest.</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"></span>  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">// For a Fermi transition, the final spin-parity is always the same as the</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">// initial one</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">if</span> ( sampled_matrix_el.type() == ME_Type::FERMI ) {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      twoJ = twoJ_gs;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      P = P_gs;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( sampled_matrix_el.type() == ME_Type::GAMOW_TELLER ) {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="comment">// For a Gamow-Teller transition, the final parity is the same as the</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="comment">// initial parity</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      P = P_gs;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="comment">// For a spin-zero initial state, take a shortcut: the final spin will</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="comment">// always be one.</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="keywordflow">if</span> ( twoJ_gs == 0 ) twoJ = 2;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="comment">// For an initial state with a non-zero spin, make a vector storing</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="comment">// all of the spin values allowed by the GT selection rules.</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">// Sample an allowed value assuming equipartition of spin. Use the</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="comment">// relative final nuclear level densities as sampling weights.</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        std::vector&lt;int&gt; allowed_twoJs;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        std::vector&lt;double&gt; ld_weights;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keyword">auto</span>&amp; ldm = sdb.get_level_density_model( <a class="code" href="classmarley_1_1_reaction.html#ab47c4d8a6efbb9082f4c67c2f359b19f">pdg_d_</a> );</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> myTwoJ = std::abs(twoJ_gs - 2); myTwoJ &lt;= twoJ_gs + 2;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;          myTwoJ += 2 )</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;          allowed_twoJs.push_back( myTwoJ );</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;          ld_weights.push_back( ldm.level_density(E_level, myTwoJ, P) );</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        std::discrete_distribution&lt;size_t&gt; my_twoJ_dist( ld_weights.begin(),</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;          ld_weights.end() );</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordtype">size_t</span> my_index = gen.<a class="code" href="classmarley_1_1_generator.html#aa6f49482bbeca2b3eda7d3697b1b24ae">sample_from_distribution</a>( my_twoJ_dist );</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        twoJ = allowed_twoJs.at( my_index );</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">throw</span> <a class="code" href="classmarley_1_1_error.html">marley::Error</a>( <span class="stringliteral">&quot;Unrecognized matrix element type encountered&quot;</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="stringliteral">&quot; in marley::NuclearReaction::create_event()&quot;</span> );</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  MARLEY_LOG_DEBUG() &lt;&lt; <span class="stringliteral">&quot;Sampled a &quot;</span> &lt;&lt; sampled_matrix_el.type_str()</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; transition from the &quot;</span> &lt;&lt; <a class="code" href="classmarley_1_1_target_atom.html">marley::TargetAtom</a>( <a class="code" href="classmarley_1_1_reaction.html#ad51f858109e8e7735716448ad0911dd4">pdg_b_</a> )</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; ground state (with spin-parity &quot;</span> &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>( twoJ_gs ) / 2.</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    &lt;&lt; P_gs &lt;&lt; <span class="stringliteral">&quot;) to the &quot;</span> &lt;&lt; <a class="code" href="classmarley_1_1_target_atom.html">marley::TargetAtom</a>( <a class="code" href="classmarley_1_1_reaction.html#ab47c4d8a6efbb9082f4c67c2f359b19f">pdg_d_</a> )</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    &lt;&lt; <span class="stringliteral">&quot; level with Ex = &quot;</span> &lt;&lt; E_level &lt;&lt; <span class="stringliteral">&quot; MeV and spin-parity &quot;</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>( twoJ ) / 2. &lt;&lt; P;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="comment">// Create the preliminary event object (after 2--&gt;2 scattering, but before</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="comment">// de-excitation of the residual nucleus)</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <a class="code" href="classmarley_1_1_event.html">marley::Event</a> <span class="keyword">event</span> = <a class="code" href="classmarley_1_1_nuclear_reaction.html#a4ef889614cd67fb298aea85ef631335e">make_event_object</a>( KEa, pc_cm, cos_theta_c_cm, phi_c_cm,</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    Ec_cm, Ed_cm, E_level, twoJ, P );</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="comment">// Return the preliminary event object (to be processed later by the</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">// NucleusDecayer class)</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">return</span> event;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;}</div>
<div class="ttc" id="aclassmarley_1_1_event_html"><div class="ttname"><a href="classmarley_1_1_event.html">marley::Event</a></div><div class="ttdoc">Container for ingoing and outgoing momentum 4-vectors from a reaction.</div><div class="ttdef"><b>Definition:</b> <a href="_event_8hh_source.html#l00066">Event.hh:66</a></div></div>
<div class="ttc" id="aclassmarley_1_1_generator_html_a0f589845050dad9b4640ab25750db4ca"><div class="ttname"><a href="classmarley_1_1_generator.html#a0f589845050dad9b4640ab25750db4ca">marley::Generator::uniform_random_double</a></div><div class="ttdeci">double uniform_random_double(double min, double max, bool inclusive)</div><div class="ttdoc">Sample a random number uniformly on either [min, max) or [min, max].</div><div class="ttdef"><b>Definition:</b> <a href="_generator_8cc_source.html#l00173">Generator.cc:173</a></div></div>
<div class="ttc" id="aclassmarley_1_1_generator_html_a23a6a31e0d132f1627ea4683904f0860"><div class="ttname"><a href="classmarley_1_1_generator.html#a23a6a31e0d132f1627ea4683904f0860">marley::Generator::get_structure_db</a></div><div class="ttdeci">marley::StructureDatabase &amp; get_structure_db()</div><div class="ttdoc">Get a reference to the StructureDatabase owned by this Generator.</div><div class="ttdef"><b>Definition:</b> <a href="_generator_8cc_source.html#l00436">Generator.cc:436</a></div></div>
<div class="ttc" id="aclassmarley_1_1_generator_html_aa6f49482bbeca2b3eda7d3697b1b24ae"><div class="ttname"><a href="classmarley_1_1_generator.html#aa6f49482bbeca2b3eda7d3697b1b24ae">marley::Generator::sample_from_distribution</a></div><div class="ttdeci">auto sample_from_distribution(RandomNumberDistribution &amp;rnd) -&gt; decltype(std::declval&lt; RandomNumberDistribution &amp; &gt;().operator()(std::declval&lt; std::mt19937_64 &amp; &gt;()))</div><div class="ttdoc">Sample from an arbitrary probability distribution (defined here as any object that implements an oper...</div><div class="ttdef"><b>Definition:</b> <a href="_generator_8hh_source.html#l00172">Generator.hh:172</a></div></div>
<div class="ttc" id="aclassmarley_1_1_level_html"><div class="ttname"><a href="classmarley_1_1_level.html">marley::Level</a></div><div class="ttdoc">A discrete nuclear energy level.</div><div class="ttdef"><b>Definition:</b> <a href="_level_8hh_source.html#l00029">Level.hh:29</a></div></div>
<div class="ttc" id="aclassmarley_1_1_level_html_aad47add697e6ee7ad136b05e487068bc"><div class="ttname"><a href="classmarley_1_1_level.html#aad47add697e6ee7ad136b05e487068bc">marley::Level::parity</a></div><div class="ttdeci">marley::Parity parity() const</div><div class="ttdoc">Get the level parity.</div><div class="ttdef"><b>Definition:</b> <a href="_level_8hh_source.html#l00126">Level.hh:126</a></div></div>
<div class="ttc" id="aclassmarley_1_1_level_html_ad364d18ab3329db9e31f9b57ef42f05d"><div class="ttname"><a href="classmarley_1_1_level.html#ad364d18ab3329db9e31f9b57ef42f05d">marley::Level::twoJ</a></div><div class="ttdeci">int twoJ() const</div><div class="ttdoc">Get two times the level spin.</div><div class="ttdef"><b>Definition:</b> <a href="_level_8hh_source.html#l00123">Level.hh:123</a></div></div>
<div class="ttc" id="aclassmarley_1_1_nuclear_reaction_html_a086090d9744add7508d422cca99cfca7"><div class="ttname"><a href="classmarley_1_1_nuclear_reaction.html#a086090d9744add7508d422cca99cfca7">marley::NuclearReaction::sample_cos_theta_c_cm</a></div><div class="ttdeci">double sample_cos_theta_c_cm(const marley::MatrixElement &amp;matrix_el, double beta_c_cm, marley::Generator &amp;gen) const</div><div class="ttdoc">Samples a polar angle cosine for the ejectile using the relevant portion of the reaction nuclear matr...</div><div class="ttdef"><b>Definition:</b> <a href="_nuclear_reaction_8cc_source.html#l00548">NuclearReaction.cc:548</a></div></div>
<div class="ttc" id="aclassmarley_1_1_nuclear_reaction_html_a1472ba0b1d35156a380118c03bd9d4b0"><div class="ttname"><a href="classmarley_1_1_nuclear_reaction.html#a1472ba0b1d35156a380118c03bd9d4b0">marley::NuclearReaction::summed_xs_helper</a></div><div class="ttdeci">double summed_xs_helper(int pdg_a, double KEa, double cos_theta_c_cm, std::vector&lt; double &gt; *level_xsecs, bool differential) const</div><div class="ttdef"><b>Definition:</b> <a href="_nuclear_reaction_8cc_source.html#l00399">NuclearReaction.cc:399</a></div></div>
<div class="ttc" id="aclassmarley_1_1_nuclear_reaction_html_a4ef889614cd67fb298aea85ef631335e"><div class="ttname"><a href="classmarley_1_1_nuclear_reaction.html#a4ef889614cd67fb298aea85ef631335e">marley::NuclearReaction::make_event_object</a></div><div class="ttdeci">virtual marley::Event make_event_object(double KEa, double pc_cm, double cos_theta_c_cm, double phi_c_cm, double Ec_cm, double Ed_cm, double E_level, int twoJ, const marley::Parity &amp;P) const override</div><div class="ttdoc">Helper function used by NuclearReaction::create_event()</div><div class="ttdef"><b>Definition:</b> <a href="_nuclear_reaction_8cc_source.html#l00576">NuclearReaction.cc:576</a></div></div>
<div class="ttc" id="aclassmarley_1_1_nuclear_reaction_html_a52f4df6ace8f63efe262829424c52605"><div class="ttname"><a href="classmarley_1_1_nuclear_reaction.html#a52f4df6ace8f63efe262829424c52605">marley::NuclearReaction::max_level_energy</a></div><div class="ttdeci">double max_level_energy(double KEa) const</div><div class="ttdoc">Get the maximum possible excitation energy (MeV) of the final-state residue that is kinematically all...</div><div class="ttdef"><b>Definition:</b> <a href="_nuclear_reaction_8cc_source.html#l00157">NuclearReaction.cc:157</a></div></div>
<div class="ttc" id="aclassmarley_1_1_parity_html"><div class="ttname"><a href="classmarley_1_1_parity.html">marley::Parity</a></div><div class="ttdoc">Type-safe representation of a parity value (either +1 or -1)</div><div class="ttdef"><b>Definition:</b> <a href="_parity_8hh_source.html#l00025">Parity.hh:25</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_a2a253c917efbb94aefe65806d9343a81"><div class="ttname"><a href="classmarley_1_1_reaction.html#a2a253c917efbb94aefe65806d9343a81">marley::Reaction::md_</a></div><div class="ttdeci">double md_</div><div class="ttdoc">Residue mass (MeV)</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00130">Reaction.hh:130</a></div></div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_a50bce6655c58a4562ba371706f496995"><div class="ttname"><a href="classmarley_1_1_reaction.html#a50bce6655c58a4562ba371706f496995">marley::Reaction::two_two_scatter</a></div><div class="ttdeci">void two_two_scatter(double KEa, double &amp;s, double &amp;Ec_cm, double &amp;pc_cm, double &amp;Ed_cm) const</div><div class="ttdoc">Helper function that handles CM frame kinematics for the reaction.</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8cc_source.html#l00197">Reaction.cc:197</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_generator_8cc_source.html#l00436">marley::Generator::get_structure_db()</a>, <a class="el" href="_level_8hh_source.html#l00126">marley::Level::parity()</a>, <a class="el" href="_generator_8hh_source.html#l00172">marley::Generator::sample_from_distribution()</a>, <a class="el" href="_level_8hh_source.html#l00123">marley::Level::twoJ()</a>, and <a class="el" href="_generator_8cc_source.html#l00173">marley::Generator::uniform_random_double()</a>.</p>

</div>
</div>
<a id="a2042c9a2c95df1037cb2326f14200207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2042c9a2c95df1037cb2326f14200207">&#9670;&nbsp;</a></span>diff_xs() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double marley::NuclearReaction::diff_xs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmarley_1_1_matrix_element.html">marley::MatrixElement</a> &amp;&#160;</td>
          <td class="paramname"><em>mat_el</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>KEa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cos_theta_c_cm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Differential cross section \(d\sigma/d\cos\theta_{c}^{\mathrm{CM}}\) (MeV<sup> -2</sup>) evaluated in the center-of-momentum frame for a transition to a particular final nuclear level. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mat_el</td><td><a class="el" href="classmarley_1_1_matrix_element.html" title="A reduced nuclear matrix element that represents a transition caused by a neutrino-nucleus reaction.">MatrixElement</a> object describing the transition to the final nuclear level </td></tr>
    <tr><td class="paramname">KEa</td><td>Lab-frame projectile kinetic energy (MeV) </td></tr>
    <tr><td class="paramname">cos_theta_c_cm</td><td>Ejectile scattering cosine as measured in the CM frame </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_nuclear_reaction_8cc_source.html#l00387">387</a> of file <a class="el" href="_nuclear_reaction_8cc_source.html">NuclearReaction.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;{</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="comment">// Check that the scattering cosine is within the physically meaningful range</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordflow">if</span> ( std::abs(cos_theta_c_cm) &gt; 1. ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keywordtype">double</span> beta_c_cm;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordtype">double</span> xsec = <a class="code" href="classmarley_1_1_nuclear_reaction.html#a90b183f962b9e3517c2e1fcf984ace45">total_xs</a>(mat_el, KEa, beta_c_cm, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  xsec *= mat_el.<a class="code" href="classmarley_1_1_matrix_element.html#af432be9492a8e8fc683c4eae688d8d3c">cos_theta_pdf</a>(cos_theta_c_cm, beta_c_cm);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keywordflow">return</span> xsec;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;}</div>
<div class="ttc" id="aclassmarley_1_1_matrix_element_html_af432be9492a8e8fc683c4eae688d8d3c"><div class="ttname"><a href="classmarley_1_1_matrix_element.html#af432be9492a8e8fc683c4eae688d8d3c">marley::MatrixElement::cos_theta_pdf</a></div><div class="ttdeci">double cos_theta_pdf(double cos_theta_c_cm, double beta_c_cm) const</div><div class="ttdoc">Compute the PDF for the CM frame scattering cosine.</div><div class="ttdef"><b>Definition:</b> <a href="_matrix_element_8hh_source.html#l00141">MatrixElement.hh:141</a></div></div>
<div class="ttc" id="aclassmarley_1_1_nuclear_reaction_html_a90b183f962b9e3517c2e1fcf984ace45"><div class="ttname"><a href="classmarley_1_1_nuclear_reaction.html#a90b183f962b9e3517c2e1fcf984ace45">marley::NuclearReaction::total_xs</a></div><div class="ttdeci">virtual double total_xs(int pdg_a, double KEa) const override</div><div class="ttdoc">Total reaction cross section (MeV -2), including all kinematically-allowed final nuclear levels.</div><div class="ttdef"><b>Definition:</b> <a href="_nuclear_reaction_8cc_source.html#l00370">NuclearReaction.cc:370</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_matrix_element_8hh_source.html#l00141">marley::MatrixElement::cos_theta_pdf()</a>.</p>

</div>
</div>
<a id="a0ae90ef14de8e0f71928d1ec696d9dee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ae90ef14de8e0f71928d1ec696d9dee">&#9670;&nbsp;</a></span>diff_xs() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double marley::NuclearReaction::diff_xs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pdg_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>KEa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cos_theta_c_cm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Differential cross section \(d\sigma/d\cos\theta_{c}^{\mathrm{CM}}\) (MeV<sup> -2</sup>) summed over all kinematically-allowed final nuclear levels. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdg_a</td><td>PDG code for the projectile </td></tr>
    <tr><td class="paramname">KEa</td><td>Lab-frame kinetic energy (MeV) of the projectile </td></tr>
    <tr><td class="paramname">cos_theta_c_cm</td><td>CM frame scattering cosine of the ejectile </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function returns 0. if pdg_a != pdg_a_. </dd></dl>

<p>Implements <a class="el" href="classmarley_1_1_reaction.html#a29f4b0dd86ea823a77158a5d51ca91a9">marley::Reaction</a>.</p>

<p class="definition">Definition at line <a class="el" href="_nuclear_reaction_8cc_source.html#l00378">378</a> of file <a class="el" href="_nuclear_reaction_8cc_source.html">NuclearReaction.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;{</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classmarley_1_1_nuclear_reaction.html#a1472ba0b1d35156a380118c03bd9d4b0">summed_xs_helper</a>(<a class="code" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>, KEa, cos_theta_c_cm, <span class="keyword">nullptr</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa98133012b9442da7fc1779d92d68a9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa98133012b9442da7fc1779d92d68a9e">&#9670;&nbsp;</a></span>ema_factor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double marley::NuclearReaction::ema_factor </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta_rel_cd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>ok</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>modified_ema</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes a Coulomb correction factor according to the effective momentum approximation. See J. Engel, Phys. Rev. C 57, 2004 (1998) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">beta_rel_cd</td><td>The relative speed of the final particles c and d (dimensionless) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ok</td><td>Flag that is set to false if subtracting the Coulomb potential pulls the event below threshold </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">modified_ema</td><td>If true, the modified EMA correction factor will be returned instead of that specified by the original EMA </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_nuclear_reaction_8cc_source.html#l00650">650</a> of file <a class="el" href="_nuclear_reaction_8cc_source.html">NuclearReaction.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;{</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="comment">// If particle c has a positive PDG code, then it is a negatively-charged</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="comment">// lepton</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keywordtype">bool</span> minus_c = (<a class="code" href="classmarley_1_1_reaction.html#aa4c4e6a8c68c0927059b85d27643a3ed">pdg_c_</a> &gt; 0);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="comment">// Approximate nuclear radius (MeV^(-1))</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <span class="keywordtype">double</span> R_nuc = nuclear_radius_natural_units( <a class="code" href="classmarley_1_1_nuclear_reaction.html#ab7451769247d088c04c2960debbb9707">Af_</a> );</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="comment">// Approximate Coulomb potential</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keywordtype">double</span> Vc = ( -3. * <a class="code" href="classmarley_1_1_nuclear_reaction.html#ad7620e5bedebacd302946f74d7bbc93c">Zf_</a> * marley_utils::alpha ) / ( 2. * R_nuc );</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="comment">// Adjust if needed for a final-state charged antilepton</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="keywordflow">if</span> ( !minus_c ) Vc *= -1;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="comment">// Like the Fermi function, this approximation uses a static nuclear Coulomb</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="comment">// potential (a sphere at the origin). Typically nuclear recoil is neglected,</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="comment">// allowing one to compute the effective lepton momentum in the lab frame. In</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="comment">// MARLEY&#39;s case, we do this by calculating it in the rest frame of the final</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="comment">// nucleus (&quot;FNR&quot; frame). We already have the relative speed of the final</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="comment">// nucleus and outgoing lepton, so this is easy.</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="keywordtype">double</span> gamma_rel_cd = std::pow( 1. - std::pow(beta_rel_cd, 2), -0.5 );</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="comment">// Check for numerical errors from the square root</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="keywordflow">if</span> ( !std::isfinite(gamma_rel_cd) ) {</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    MARLEY_LOG_WARNING() &lt;&lt; <span class="stringliteral">&quot;Invalid beta_rel = &quot;</span> &lt;&lt; beta_rel_cd</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; encountered in marley::NuclearReaction::ema_factor()&quot;</span>;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  }</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="comment">// Total energy of the outgoing lepton in the FNR frame</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="keywordtype">double</span> E_c_FNR = gamma_rel_cd * <a class="code" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a>;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="comment">// Lepton momentum in FNR frame</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="keywordtype">double</span> p_c_FNR = beta_rel_cd * E_c_FNR;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="comment">// Effective FNR frame total energy</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <span class="keywordtype">double</span> E_c_FNR_eff = E_c_FNR - Vc;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="comment">// If subtracting off the Coulomb potential drops the effective energy</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="comment">// below the lepton mass, then the expression for the effective momentum</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="comment">// will give an imaginary value. Signal this by setting the &quot;ok&quot; flag to</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="comment">// false.</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  ok = ( E_c_FNR_eff &gt;= <a class="code" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a> );</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="comment">// Effective momentum in FNR frame</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keywordtype">double</span> p_c_FNR_eff = marley_utils::real_sqrt(</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    std::pow(E_c_FNR_eff, 2) - <a class="code" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a>*<a class="code" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a> );</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="comment">// Coulomb correction factor for the original EMA</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="keywordtype">double</span> F_EMA = std::pow( p_c_FNR_eff / p_c_FNR, 2 );</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="comment">// Coulomb correction factor for the modified EMA</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="keywordtype">double</span> F_MEMA = ( p_c_FNR_eff * E_c_FNR_eff ) / ( p_c_FNR * E_c_FNR );</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <span class="keywordflow">if</span> ( modified_ema ) <span class="keywordflow">return</span> F_MEMA;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">return</span> F_EMA;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad1316c7149a70dae8313bd132a2a831e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1316c7149a70dae8313bd132a2a831e">&#9670;&nbsp;</a></span>fermi_function()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double marley::NuclearReaction::fermi_function </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta_c</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the <a href="https://en.wikipedia.org/wiki/Beta_decay#Fermi_function">Fermi function</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">beta_c</td><td><a href="http://scienceworld.wolfram.com/physics/RelativisticBeta.html">Dimensionless speed</a> of the ejectile </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_nuclear_reaction_8cc_source.html#l00122">122</a> of file <a class="el" href="_nuclear_reaction_8cc_source.html">NuclearReaction.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                                                {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="comment">// If the PDG code for particle c is positive, then it is a</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">// negatively-charged lepton.</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordtype">bool</span> c_minus = (<a class="code" href="classmarley_1_1_reaction.html#aa4c4e6a8c68c0927059b85d27643a3ed">pdg_c_</a> &gt; 0);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">// Lorentz factor gamma for particle c</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordtype">double</span> gamma_c = std::pow(1. - beta_c*beta_c, -marley_utils::ONE_HALF);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordtype">double</span> s = std::sqrt(1. - std::pow(marley_utils::alpha * <a class="code" href="classmarley_1_1_nuclear_reaction.html#ad7620e5bedebacd302946f74d7bbc93c">Zf_</a>, 2));</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="comment">// Estimate the nuclear radius (in MeV^(-1))</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordtype">double</span> rho = nuclear_radius_natural_units( <a class="code" href="classmarley_1_1_nuclear_reaction.html#ab7451769247d088c04c2960debbb9707">Af_</a> );</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="comment">// Sommerfeld parameter</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordtype">double</span> eta = marley_utils::alpha * <a class="code" href="classmarley_1_1_nuclear_reaction.html#ad7620e5bedebacd302946f74d7bbc93c">Zf_</a> / beta_c;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="comment">// Adjust the value of eta if the light product from this reaction is</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">// an antilepton</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordflow">if</span> ( !c_minus ) eta *= -1;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">// Complex variable for the gamma function</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  std::complex&lt;double&gt; a(s, eta);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordtype">double</span> b = std::tgamma(1 + 2*s);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">return</span> 2 * (1 + s) * std::pow(2*beta_c*gamma_c*rho*<a class="code" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a>, 2*s-2)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    * std::exp(marley_utils::pi*eta) * std::norm(marley_utils::gamma(a))</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    / std::pow(b, 2);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a52f4df6ace8f63efe262829424c52605"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52f4df6ace8f63efe262829424c52605">&#9670;&nbsp;</a></span>max_level_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double marley::NuclearReaction::max_level_energy </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>KEa</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the maximum possible excitation energy (MeV) of the final-state residue that is kinematically allowed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">KEa</td><td>Projectile lab-frame kinetic energy (MeV) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_nuclear_reaction_8cc_source.html#l00157">157</a> of file <a class="el" href="_nuclear_reaction_8cc_source.html">NuclearReaction.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                                               {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="comment">// Calculate the total CM frame energy using known quantities</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="comment">// from the lab frame</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordtype">double</span> E_CM = std::sqrt(std::pow(<a class="code" href="classmarley_1_1_reaction.html#aea3c67ae0b64f048b0e728900200f96c">ma_</a> + <a class="code" href="classmarley_1_1_reaction.html#af3c38e0a9e08525685a2ee8de212d17a">mb_</a>, 2) + 2*<a class="code" href="classmarley_1_1_reaction.html#af3c38e0a9e08525685a2ee8de212d17a">mb_</a>*KEa);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="comment">// The maximum level energy is achieved when the final state</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="comment">// particles are produced at rest in the CM frame. Subtracting</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">// the ground-state rest masses of particles c and d from the</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="comment">// total CM energy leaves us with the energy available to create</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="comment">// an excited level in the residue (particle d).</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">return</span> E_CM - <a class="code" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a> - <a class="code" href="classmarley_1_1_nuclear_reaction.html#ad93300e94630b62181178acc327d0347">md_gs_</a>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a086090d9744add7508d422cca99cfca7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a086090d9744add7508d422cca99cfca7">&#9670;&nbsp;</a></span>sample_cos_theta_c_cm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double marley::NuclearReaction::sample_cos_theta_c_cm </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmarley_1_1_matrix_element.html">marley::MatrixElement</a> &amp;&#160;</td>
          <td class="paramname"><em>matrix_el</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta_c_cm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmarley_1_1_generator.html">marley::Generator</a> &amp;&#160;</td>
          <td class="paramname"><em>gen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Samples a polar angle cosine for the ejectile using the relevant portion of the reaction nuclear matrix element. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m_type</td><td>Integer representing the type of transition (0 = Fermi, 1 = Gamow-Teller) </td></tr>
    <tr><td class="paramname">beta_c_cm</td><td><a href="http://scienceworld.wolfram.com/physics/RelativisticBeta.html">Dimensionless speed</a> of the ejectile in the CM frame </td></tr>
    <tr><td class="paramname">gen</td><td>Reference to the <a class="el" href="classmarley_1_1_generator.html" title="The MARLEY Event generator.">Generator</a> to use for random sampling </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_nuclear_reaction_8cc_source.html#l00548">548</a> of file <a class="el" href="_nuclear_reaction_8cc_source.html">NuclearReaction.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;{</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="comment">// To avoid wasting time searching for the maximum of these distributions</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="comment">// for rejection sampling, set the maximum to the known value before</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">// proceeding.</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="keywordtype">double</span> max;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keywordflow">if</span> ( matrix_el.<a class="code" href="classmarley_1_1_matrix_element.html#a1466e8d33b9fdc716ecf68945c328ddb">type</a>() == ME_Type::FERMI ) {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">// B(F)</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    max = matrix_el.<a class="code" href="classmarley_1_1_matrix_element.html#af432be9492a8e8fc683c4eae688d8d3c">cos_theta_pdf</a>(1., beta_c_cm);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  }</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (matrix_el.<a class="code" href="classmarley_1_1_matrix_element.html#a1466e8d33b9fdc716ecf68945c328ddb">type</a>() == ME_Type::GAMOW_TELLER) {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">// B(GT)</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    max = matrix_el.<a class="code" href="classmarley_1_1_matrix_element.html#af432be9492a8e8fc683c4eae688d8d3c">cos_theta_pdf</a>(-1., beta_c_cm);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">throw</span> <a class="code" href="classmarley_1_1_error.html">marley::Error</a>(<span class="stringliteral">&quot;Unrecognized matrix element type &quot;</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    + std::to_string(matrix_el.<a class="code" href="classmarley_1_1_matrix_element.html#a1466e8d33b9fdc716ecf68945c328ddb">type</a>()) + <span class="stringliteral">&quot; encountered while sampling a&quot;</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="stringliteral">&quot; CM frame scattering angle&quot;</span>);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="comment">// Sample a CM frame scattering cosine using the appropriate distribution for</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="comment">// this matrix element.</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordflow">return</span> gen.<a class="code" href="classmarley_1_1_generator.html#a7feec256d2e102f9a0eb4e6674d07b34">rejection_sample</a>(</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    [&amp;matrix_el, &amp;beta_c_cm](<span class="keywordtype">double</span> cos_theta_c_cm)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    -&gt; <span class="keywordtype">double</span> { <span class="keywordflow">return</span> matrix_el.<a class="code" href="classmarley_1_1_matrix_element.html#af432be9492a8e8fc683c4eae688d8d3c">cos_theta_pdf</a>(cos_theta_c_cm, beta_c_cm); },</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    -1., 1., max);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;}</div>
<div class="ttc" id="aclassmarley_1_1_generator_html_a7feec256d2e102f9a0eb4e6674d07b34"><div class="ttname"><a href="classmarley_1_1_generator.html#a7feec256d2e102f9a0eb4e6674d07b34">marley::Generator::rejection_sample</a></div><div class="ttdeci">double rejection_sample(const std::function&lt; double(double)&gt; &amp;f, double xmin, double xmax, double &amp;fmax, double safety_factor=1.01, double max_search_tolerance=DEFAULT_REJECTION_SAMPLING_TOLERANCE_)</div><div class="ttdoc">Sample from a given 1D probability density function f(x) on the interval [xmin, xmax] using a simple ...</div><div class="ttdef"><b>Definition:</b> <a href="_generator_8cc_source.html#l00219">Generator.cc:219</a></div></div>
<div class="ttc" id="aclassmarley_1_1_matrix_element_html_a1466e8d33b9fdc716ecf68945c328ddb"><div class="ttname"><a href="classmarley_1_1_matrix_element.html#a1466e8d33b9fdc716ecf68945c328ddb">marley::MatrixElement::type</a></div><div class="ttdeci">TransitionType type() const</div><div class="ttdoc">Get the kind of nuclear transition (e.g., Fermi, Gamow-Teller) represented by the matrix element.</div><div class="ttdef"><b>Definition:</b> <a href="_matrix_element_8hh_source.html#l00110">MatrixElement.hh:110</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_matrix_element_8hh_source.html#l00141">marley::MatrixElement::cos_theta_pdf()</a>, <a class="el" href="_generator_8cc_source.html#l00219">marley::Generator::rejection_sample()</a>, and <a class="el" href="_matrix_element_8hh_source.html#l00110">marley::MatrixElement::type()</a>.</p>

</div>
</div>
<a id="a1472ba0b1d35156a380118c03bd9d4b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1472ba0b1d35156a380118c03bd9d4b0">&#9670;&nbsp;</a></span>summed_xs_helper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double marley::NuclearReaction::summed_xs_helper </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pdg_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>KEa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cos_theta_c_cm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>level_xsecs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>differential</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Helper function for total_xs and summed_diff_xs() </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdg_a</td><td>PDG code for the projectile </td></tr>
    <tr><td class="paramname">KEa</td><td>Lab-frame projectile kinetic energy (MeV) </td></tr>
    <tr><td class="paramname">cos_theta_c_cm</td><td>CM frame scattering cosine for the ejectile </td></tr>
    <tr><td class="paramname">level_xsecs</td><td>If this pointer is not nullptr, then the std::vector&lt;double&gt; that it points to will be cleared and loaded with the partial cross sections to each individual nuclear level included in the sum. This feature is helpful when computing weights for sampling a nuclear transition in <a class="el" href="classmarley_1_1_nuclear_reaction.html#a8ab5c74e0daf4bb7cb47428e2273002a" title="Produces a two-two scattering Event that proceeds via this reaction.">create_event()</a>. </td></tr>
    <tr><td class="paramname">differential</td><td>Whether the total cross section (false) or the differential cross section (true, \(d\sigma/d\cos\theta_{c}^{\mathrm{CM}}\)) should be summed over all kinematically accessible nuclear levels by this function </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The requested cross section (MeV<sup> -2</sup>) </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000020">Todo:</a></b></dt><dd>Consider whether you should use an exception if pdg_a != pdg_a_ </dd></dl>

<p class="definition">Definition at line <a class="el" href="_nuclear_reaction_8cc_source.html#l00399">399</a> of file <a class="el" href="_nuclear_reaction_8cc_source.html">NuclearReaction.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;{</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="comment">// Check that the projectile supplied to this event is correct. If not,</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="comment">// return a total cross section of zero since this reaction is not available</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">// for the given projectile.</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment"></span>  <span class="keywordflow">if</span> (<a class="code" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a> != <a class="code" href="classmarley_1_1_reaction.html#a217a810b93dd6da809a91080973d19f0">pdg_a_</a>) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="comment">// If we&#39;re evaluating a differential cross section, check that the</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="comment">// scattering cosine is within the physically meaningful range. If it&#39;s</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="comment">// not, then just return 0.</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keywordflow">if</span> ( differential &amp;&amp; std::abs(cos_theta_c_cm) &gt; 1. ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="comment">// If the projectile kinetic energy is zero (or negative), then</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="comment">// just return zero.</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordflow">if</span> ( KEa &lt;= 0. ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="comment">// If we&#39;ve been passed a vector to load with the partial cross sections</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="comment">// to each nuclear level, then clear it before storing them</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordflow">if</span> ( level_xsecs ) level_xsecs-&gt;clear();</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keywordtype">double</span> max_E_level = <a class="code" href="classmarley_1_1_nuclear_reaction.html#a52f4df6ace8f63efe262829424c52605">max_level_energy</a>( KEa );</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keywordtype">double</span> xsec = 0.;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span>&amp; mat_el : *<a class="code" href="classmarley_1_1_nuclear_reaction.html#aeada84bbffeacc79cd256b79348767e5">matrix_elements_</a> ) {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">// Get the excitation energy for the current level</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordtype">double</span> level_energy = mat_el.level_energy();</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">// Exit the loop early if you reach a level with an energy that&#39;s too high</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">if</span> ( level_energy &gt; max_E_level ) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">// Check whether the matrix element (B(F) + B(GT)) is nonvanishing for the</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">// current level. If it is, just set the weight equal to zero rather than</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">// computing the total xs.</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">if</span> ( mat_el.strength() != 0. ) {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="comment">// Set the check_max_E_level flag to false when calculating the total</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="comment">// cross section for this level (we&#39;ve already verified that the</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="comment">// current level is kinematically accessible in the check against</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <span class="comment">// max_E_level above)</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keywordtype">double</span> beta_c_cm = 0.;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="keywordtype">double</span> partial_xsec = <a class="code" href="classmarley_1_1_nuclear_reaction.html#a90b183f962b9e3517c2e1fcf984ace45">total_xs</a>(mat_el, KEa, beta_c_cm, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="comment">// If a differential cross section (d\sigma / d\cos\theta_{CM})</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="comment">// is desired, then multiply by the appropriate angular factor</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <span class="keywordflow">if</span> ( differential ) {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        partial_xsec *= mat_el.cos_theta_pdf(cos_theta_c_cm, beta_c_cm);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <span class="keywordflow">if</span> ( std::isnan(partial_xsec) ) {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        MARLEY_LOG_WARNING() &lt;&lt; <span class="stringliteral">&quot;Partial cross section for reaction &quot;</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;          &lt;&lt; <a class="code" href="classmarley_1_1_reaction.html#a97c71055252e92db26c160c6c1fd9c2c">description_</a> &lt;&lt; <span class="stringliteral">&quot; gave NaN result.&quot;</span>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        MARLEY_LOG_DEBUG() &lt;&lt; <span class="stringliteral">&quot;Parameters were level energy = &quot;</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;          &lt;&lt; mat_el.level_energy() &lt;&lt; <span class="stringliteral">&quot; MeV, projectile kinetic energy = &quot;</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;          &lt;&lt; KEa &lt;&lt; <span class="stringliteral">&quot; MeV, and reduced matrix element = &quot;</span> &lt;&lt; mat_el.strength();</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        MARLEY_LOG_DEBUG() &lt;&lt; <span class="stringliteral">&quot;The partial cross section to this level&quot;</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;          &lt;&lt; <span class="stringliteral">&quot; will be set to zero.&quot;</span>;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        partial_xsec = 0.;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      xsec += partial_xsec;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <span class="comment">// Store the partial cross section to the current individual nuclear</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="comment">// level if needed (i.e., if level_xsecs is not nullptr)</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="keywordflow">if</span> ( level_xsecs ) level_xsecs-&gt;push_back( partial_xsec );</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="keywordflow">return</span> xsec;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;}</div>
<div class="ttc" id="aclassmarley_1_1_reaction_html_a97c71055252e92db26c160c6c1fd9c2c"><div class="ttname"><a href="classmarley_1_1_reaction.html#a97c71055252e92db26c160c6c1fd9c2c">marley::Reaction::description_</a></div><div class="ttdeci">std::string description_</div><div class="ttdoc">String that contains a formula describing the reaction.</div><div class="ttdef"><b>Definition:</b> <a href="_reaction_8hh_source.html#l00133">Reaction.hh:133</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adf4a1384bde1ca1588021f2a4c71601c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf4a1384bde1ca1588021f2a4c71601c">&#9670;&nbsp;</a></span>total_xs() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double marley::NuclearReaction::total_xs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmarley_1_1_matrix_element.html">marley::MatrixElement</a> &amp;&#160;</td>
          <td class="paramname"><em>me</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>KEa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>beta_c_cm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>check_max_E_level</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total cross section (MeV<sup> -2</sup>) for a given final nuclear level. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">me</td><td><a class="el" href="classmarley_1_1_matrix_element.html" title="A reduced nuclear matrix element that represents a transition caused by a neutrino-nucleus reaction.">MatrixElement</a> object describing the transition to the final nuclear level </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">KEa</td><td>Lab-frame projectile kinetic energy (MeV) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">beta_c_cm</td><td>After this function is called, this variable will contain the (dimensionless) speed of the ejectile as measured in the center of momentum frame </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">check_max_E_level</td><td>Whether to check the reaction threshold via a call to <a class="el" href="classmarley_1_1_nuclear_reaction.html#a52f4df6ace8f63efe262829424c52605" title="Get the maximum possible excitation energy (MeV) of the final-state residue that is kinematically all...">max_level_energy()</a>. If this argument is set to false, then the check will be skipped. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_nuclear_reaction_8cc_source.html#l00474">474</a> of file <a class="el" href="_nuclear_reaction_8cc_source.html">NuclearReaction.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;{</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="comment">// Don&#39;t bother to compute anything if the matrix element vanishes for this</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="comment">// level</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordflow">if</span> ( me.<a class="code" href="classmarley_1_1_matrix_element.html#a5214a168fba0b68a793c452bc84fc147">strength</a>() == 0. ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="comment">// Also don&#39;t proceed further if the reaction is below threshold (equivalently,</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="comment">// if the requested level excitation energy E_level exceeds that maximum</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="comment">// kinematically-allowed value). To avoid redundant checks of the threshold,</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="comment">// skip this check if check_max_E_level is set to false.</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordflow">if</span> ( check_max_E_level ) {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordtype">double</span> max_E_level = <a class="code" href="classmarley_1_1_nuclear_reaction.html#a52f4df6ace8f63efe262829424c52605">max_level_energy</a>( KEa );</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">if</span> ( me.<a class="code" href="classmarley_1_1_matrix_element.html#a57d9ce7f7943e88b5c6f7e0c78967215">level_energy</a>() &gt; max_E_level ) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  }</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="comment">// The final nuclear mass (before nuclear de-excitations) is the sum of the</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="comment">// ground state residue mass plus the excitation energy of the accessed level</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordtype">double</span> md2 = std::pow(<a class="code" href="classmarley_1_1_nuclear_reaction.html#ad93300e94630b62181178acc327d0347">md_gs_</a> + me.<a class="code" href="classmarley_1_1_matrix_element.html#a57d9ce7f7943e88b5c6f7e0c78967215">level_energy</a>(), 2);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="comment">// Compute Mandelstam s (the square of the total CM frame energy)</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordtype">double</span> s = std::pow(<a class="code" href="classmarley_1_1_reaction.html#aea3c67ae0b64f048b0e728900200f96c">ma_</a> + <a class="code" href="classmarley_1_1_reaction.html#af3c38e0a9e08525685a2ee8de212d17a">mb_</a>, 2) + 2.*<a class="code" href="classmarley_1_1_reaction.html#af3c38e0a9e08525685a2ee8de212d17a">mb_</a>*KEa;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keywordtype">double</span> sqrt_s = std::sqrt(s);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="comment">// Compute CM frame total energies for two of the particles. Also</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="comment">// compute the magnitude of the ejectile CM frame momentum.</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keywordtype">double</span> Eb_cm = (s + <a class="code" href="classmarley_1_1_reaction.html#af3c38e0a9e08525685a2ee8de212d17a">mb_</a>*<a class="code" href="classmarley_1_1_reaction.html#af3c38e0a9e08525685a2ee8de212d17a">mb_</a> - <a class="code" href="classmarley_1_1_reaction.html#aea3c67ae0b64f048b0e728900200f96c">ma_</a>*<a class="code" href="classmarley_1_1_reaction.html#aea3c67ae0b64f048b0e728900200f96c">ma_</a>) / (2. * sqrt_s);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keywordtype">double</span> Ec_cm = (s + <a class="code" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a>*<a class="code" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a> - md2) / (2. * sqrt_s);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keywordtype">double</span> pc_cm = marley_utils::real_sqrt(std::pow(Ec_cm, 2) - <a class="code" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a>*<a class="code" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a>);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="comment">// Compute the (dimensionless) speed of the ejectile in the CM frame</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  beta_c_cm = pc_cm / Ec_cm;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="comment">// CM frame total energy of the nuclear residue</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="keywordtype">double</span> Ed_cm = sqrt_s - Ec_cm;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="comment">// Dot product of the four-momenta of particles c and d</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordtype">double</span> pc_dot_pd = Ed_cm*Ec_cm + std::pow(pc_cm, 2);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="comment">// Relative speed of particles c and d, computed with a manifestly</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="comment">// Lorentz-invariant expression</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordtype">double</span> beta_rel_cd = marley_utils::real_sqrt(</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    std::pow(pc_dot_pd, 2) - <a class="code" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a>*<a class="code" href="classmarley_1_1_reaction.html#a383a684d06e3ca1e791394b95a758fe4">mc_</a>*md2) / pc_dot_pd;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="comment">// Common factors for the allowed approximation total cross sections</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="comment">// for both CC and NC reactions</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="keywordtype">double</span> total_xsec = (marley_utils::GF2 / marley_utils::pi)</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    * ( Eb_cm * Ed_cm / s ) * Ec_cm * pc_cm * me.<a class="code" href="classmarley_1_1_matrix_element.html#a5214a168fba0b68a793c452bc84fc147">strength</a>();</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="comment">// Apply extra factors based on the current process type</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="classmarley_1_1_reaction.html#a2a8dc9e8b628960659b50fedc27c374a">process_type_</a> == ProcessType::NeutrinoCC</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    || <a class="code" href="classmarley_1_1_reaction.html#a2a8dc9e8b628960659b50fedc27c374a">process_type_</a> == ProcessType::AntiNeutrinoCC )</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="comment">// Calculate a Coulomb correction factor using either a Fermi function</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">// or the effective momentum approximation</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordtype">double</span> factor_C = <a class="code" href="classmarley_1_1_nuclear_reaction.html#a03501d3d61096e890cb3d5ae07b7bce1">coulomb_correction_factor</a>( beta_rel_cd );</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    total_xsec *= marley_utils::Vud2 * factor_C;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  }</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="classmarley_1_1_reaction.html#a2a8dc9e8b628960659b50fedc27c374a">process_type_</a> == ProcessType::NC )</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">// For NC, extra factors are only needed for Fermi transitions (which</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">// correspond to CEvNS since they can only access the nuclear ground state)</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">if</span> ( me.<a class="code" href="classmarley_1_1_matrix_element.html#a1466e8d33b9fdc716ecf68945c328ddb">type</a>() == ME_Type::FERMI ) {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <span class="keywordtype">double</span> Q_w = <a class="code" href="classmarley_1_1_nuclear_reaction.html#a185b95eab0e2d1ec62c7fb65b73f69e6">weak_nuclear_charge</a>();</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      total_xsec *= 0.25*std::pow(Q_w, 2);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">throw</span> <a class="code" href="classmarley_1_1_error.html">marley::Error</a>(<span class="stringliteral">&quot;Unrecognized process type encountered in&quot;</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="stringliteral">&quot; marley::NuclearReaction::total_xs()&quot;</span>);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordflow">return</span> total_xsec;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;}</div>
<div class="ttc" id="aclassmarley_1_1_matrix_element_html_a5214a168fba0b68a793c452bc84fc147"><div class="ttname"><a href="classmarley_1_1_matrix_element.html#a5214a168fba0b68a793c452bc84fc147">marley::MatrixElement::strength</a></div><div class="ttdeci">double strength() const</div><div class="ttdoc">Get the numerical value (dimensionless) of the matrix element.</div><div class="ttdef"><b>Definition:</b> <a href="_matrix_element_8hh_source.html#l00106">MatrixElement.hh:106</a></div></div>
<div class="ttc" id="aclassmarley_1_1_matrix_element_html_a57d9ce7f7943e88b5c6f7e0c78967215"><div class="ttname"><a href="classmarley_1_1_matrix_element.html#a57d9ce7f7943e88b5c6f7e0c78967215">marley::MatrixElement::level_energy</a></div><div class="ttdeci">double level_energy() const</div><div class="ttdoc">Get the excitation energy (MeV) of the final-state nuclear level accessed by the matrix element.</div><div class="ttdef"><b>Definition:</b> <a href="_matrix_element_8hh_source.html#l00080">MatrixElement.hh:80</a></div></div>
<div class="ttc" id="aclassmarley_1_1_nuclear_reaction_html_a03501d3d61096e890cb3d5ae07b7bce1"><div class="ttname"><a href="classmarley_1_1_nuclear_reaction.html#a03501d3d61096e890cb3d5ae07b7bce1">marley::NuclearReaction::coulomb_correction_factor</a></div><div class="ttdeci">double coulomb_correction_factor(double beta_rel_cd) const</div><div class="ttdef"><b>Definition:</b> <a href="_nuclear_reaction_8cc_source.html#l00592">NuclearReaction.cc:592</a></div></div>
<div class="ttc" id="aclassmarley_1_1_nuclear_reaction_html_a185b95eab0e2d1ec62c7fb65b73f69e6"><div class="ttname"><a href="classmarley_1_1_nuclear_reaction.html#a185b95eab0e2d1ec62c7fb65b73f69e6">marley::NuclearReaction::weak_nuclear_charge</a></div><div class="ttdeci">double weak_nuclear_charge() const</div><div class="ttdef"><b>Definition:</b> <a href="_nuclear_reaction_8cc_source.html#l00711">NuclearReaction.cc:711</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_matrix_element_8hh_source.html#l00080">marley::MatrixElement::level_energy()</a>, <a class="el" href="_matrix_element_8hh_source.html#l00106">marley::MatrixElement::strength()</a>, and <a class="el" href="_matrix_element_8hh_source.html#l00110">marley::MatrixElement::type()</a>.</p>

</div>
</div>
<a id="a90b183f962b9e3517c2e1fcf984ace45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90b183f962b9e3517c2e1fcf984ace45">&#9670;&nbsp;</a></span>total_xs() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double marley::NuclearReaction::total_xs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pdg_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>KEa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total reaction cross section (MeV<sup> -2</sup>), including all kinematically-allowed final nuclear levels. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pdg_a</td><td>PDG code for the projectile </td></tr>
    <tr><td class="paramname">KEa</td><td>Lab-frame kinetic energy (MeV) of the projectile </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classmarley_1_1_reaction.html" title="Abstract base class that represents a two-two scattering reaction.">Reaction</a> total cross section (MeV<sup> -2</sup>) </dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function returns 0. if pdg_a != pdg_a_. </dd></dl>

<p>Implements <a class="el" href="classmarley_1_1_reaction.html#a0cfd54925a6043deff06da8603c22207">marley::Reaction</a>.</p>

<p class="definition">Definition at line <a class="el" href="_nuclear_reaction_8cc_source.html#l00370">370</a> of file <a class="el" href="_nuclear_reaction_8cc_source.html">NuclearReaction.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                                                                  {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keywordtype">double</span> dummy_cos_theta = 0.;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classmarley_1_1_nuclear_reaction.html#a1472ba0b1d35156a380118c03bd9d4b0">summed_xs_helper</a>(<a class="code" href="classmarley_1_1_reaction.html#ad1aec5433c9da5813edc46e0cf545c05">pdg_a</a>, KEa, dummy_cos_theta, <span class="keyword">nullptr</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a185b95eab0e2d1ec62c7fb65b73f69e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a185b95eab0e2d1ec62c7fb65b73f69e6">&#9670;&nbsp;</a></span>weak_nuclear_charge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double marley::NuclearReaction::weak_nuclear_charge </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the weak nuclear charge \( Q_W = N - (1 - 4\sin^2\theta_W)Z \) for the target nucleus</p>
<p>In the expression above, \( N \) ( \(Z\)) is the neutron (proton) number of the target nucleus and \( \theta_W \) is the weak mixing angle. </p>

<p class="definition">Definition at line <a class="el" href="_nuclear_reaction_8cc_source.html#l00711">711</a> of file <a class="el" href="_nuclear_reaction_8cc_source.html">NuclearReaction.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;{</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="keywordtype">int</span> Ni = <a class="code" href="classmarley_1_1_nuclear_reaction.html#a048d76a0028eba8e41bdbd2e2191c8ac">Ai_</a> - <a class="code" href="classmarley_1_1_nuclear_reaction.html#ab0e49941e652268c0a4396eb92620a24">Zi_</a>;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="keywordtype">double</span> Qw = Ni - (1. - 4.*marley_utils::sin2thetaw)*<a class="code" href="classmarley_1_1_nuclear_reaction.html#ab0e49941e652268c0a4396eb92620a24">Zi_</a>;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordflow">return</span> Qw;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ae4aa5daec78d552aa2ebbbb74e25fe2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4aa5daec78d552aa2ebbbb74e25fe2b">&#9670;&nbsp;</a></span>coulomb_mode_string_map_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; <a class="el" href="classmarley_1_1_nuclear_reaction.html#ac5f7ef6b49c0f776b5fe042d13de497e">CMode</a>, std::string &gt; marley::NuclearReaction::coulomb_mode_string_map_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">{</div>
<div class="line">  { CMode::NO_CORRECTION, <span class="stringliteral">&quot;none&quot;</span> },</div>
<div class="line">  { CMode::FERMI_FUNCTION, <span class="stringliteral">&quot;Fermi&quot;</span> },</div>
<div class="line">  { CMode::EMA, <span class="stringliteral">&quot;EMA&quot;</span> },</div>
<div class="line">  { CMode::MEMA, <span class="stringliteral">&quot;MEMA&quot;</span> },</div>
<div class="line">  { CMode::FERMI_AND_EMA, <span class="stringliteral">&quot;Fermi-EMA&quot;</span> },</div>
<div class="line">  { CMode::FERMI_AND_MEMA, <span class="stringliteral">&quot;Fermi-MEMA&quot;</span> },</div>
<div class="line">}</div>
</div><!-- fragment --><p>Helper map used by the methods to convert a CoulombMode value to and from a std::string </p>

<p class="definition">Definition at line <a class="el" href="_nuclear_reaction_8hh_source.html#l00180">180</a> of file <a class="el" href="_nuclear_reaction_8hh_source.html">NuclearReaction.hh</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/Users/gardiner/fooey/include/marley/<a class="el" href="_nuclear_reaction_8hh_source.html">NuclearReaction.hh</a></li>
<li>/Users/gardiner/fooey/src/<a class="el" href="_nuclear_reaction_8cc_source.html">NuclearReaction.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
